{
    "neg0001": "select Utente,\n       round(isnull([1] ,0),2) as Gennaio, round(isnull([2] ,0),2) as Febbraio, round(isnull([3] ,0),2) as Marzo    , round(isnull([4] ,0),2) as Aprile , round(isnull([5] ,0),2) as Maggio  , round(isnull([6] ,0),2) as Giugno,\n\t   round(isnull([7] ,0),2) as Luglio , round(isnull([8] ,0),2) as Agosto  , round(isnull([9] ,0),2) as Settembre, round(isnull([10],0),2) as Ottobre, round(isnull([11],0),2) as Novembre, round(isnull([12],0),2) as Dicembre,\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.Anno = <anno> and t.Reparto = '<sede>' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc') and a.TipoRiga != 'Omaggio'\ngroup by t.Banco, a.Mese\n) as ground\nPIVOT (\nsum(Importo)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Layer1\norder by 1,2",
    "neg1001": "select Utente,\n       round(isnull([1] ,0),2) as Gennaio, round(isnull([2] ,0),2) as Febbraio, round(isnull([3] ,0),2) as Marzo    , round(isnull([4] ,0),2) as Aprile , round(isnull([5] ,0),2) as Maggio  , round(isnull([6] ,0),2) as Giugno,\n\t   round(isnull([7] ,0),2) as Luglio , round(isnull([8] ,0),2) as Agosto  , round(isnull([9] ,0),2) as Settembre, round(isnull([10],0),2) as Ottobre, round(isnull([11],0),2) as Novembre, round(isnull([12],0),2) as Dicembre,\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.Anno = <anno> and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Mese\nunion\nselect distinct '1spr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.TipoOrdine != 'Prenota e ritira' and a.Anno = <anno> and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Mese\nunion\nselect distinct '1spr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Anno = <anno> and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Mese\n) as ground\nPIVOT (\nsum(Importo)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Layer1\nunion select '2----------',0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "neg0002": "select Utente,\n       round(isnull([1] ,0),2) as Set01, round(isnull([2] ,0),2) as Set02, round(isnull([3] ,0),2) as Set03, round(isnull([4] ,0),2) as Set04, round(isnull([5] ,0),2) as Set05, round(isnull([6] ,0),2) as Set06, round(isnull([7] ,0),2) as Set07, round(isnull([8] ,0),2) as Set08, round(isnull([9] ,0),2) as Set09, round(isnull([10],0),2) as Set10,\n\t   round(isnull([11],0),2) as Set11, round(isnull([12],0),2) as Set12, round(isnull([13],0),2) as Set13, round(isnull([14],0),2) as Set14, round(isnull([15],0),2) as Set15, round(isnull([16],0),2) as Set16, round(isnull([17],0),2) as Set17, round(isnull([18],0),2) as Set18, round(isnull([19],0),2) as Set19, round(isnull([20],0),2) as Set20,\n\t   round(isnull([21],0),2) as Set21, round(isnull([22],0),2) as Set22, round(isnull([23],0),2) as Set23, round(isnull([24],0),2) as Set24, round(isnull([25],0),2) as Set25, round(isnull([26],0),2) as Set26, round(isnull([27],0),2) as Set27, round(isnull([28],0),2) as Set28, round(isnull([29],0),2) as Set29, round(isnull([30],0),2) as Set30,\n\t   round(isnull([31],0),2) as Set31, round(isnull([32],0),2) as Set32, round(isnull([33],0),2) as Set33, round(isnull([34],0),2) as Set34, round(isnull([35],0),2) as Set35, round(isnull([36],0),2) as Set36, round(isnull([37],0),2) as Set37, round(isnull([38],0),2) as Set38, round(isnull([39],0),2) as Set39, round(isnull([40],0),2) as Set40,\n\t   round(isnull([41],0),2) as Set41, round(isnull([42],0),2) as Set42, round(isnull([43],0),2) as Set43, round(isnull([44],0),2) as Set44, round(isnull([45],0),2) as Set45, round(isnull([46],0),2) as Set46, round(isnull([47],0),2) as Set47, round(isnull([48],0),2) as Set48, round(isnull([49],0),2) as Set49, round(isnull([50],0),2) as Set50,\n\t   round(isnull([51],0),2) as Set51, round(isnull([52],0),2) as Set52, round(isnull([53],0),2) as Set53,\n\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) +\n\t   isnull([31],0) + isnull([32],0) + isnull([33],0) + isnull([34],0) + isnull([35],0) + isnull([36],0) + isnull([37],0) + isnull([38],0) + isnull([39],0) + isnull([40],0) +\n\t   isnull([41],0) + isnull([42],0) + isnull([43],0) + isnull([44],0) + isnull([45],0) + isnull([46],0) + isnull([47],0) + isnull([48],0) + isnull([49],0) + isnull([50],0) +\n\t   isnull([51],0) + isnull([52],0) + isnull([53],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.Anno = <anno> and a.Mese in (<mesi>)  and t.Reparto = '<sede>' and t.Banco not in ('', 'y Amministrazione')\ngroup by t.Banco, a.Settimana\n /*\nunion\nselect distinct '2spr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.TipoOrdine != 'Prenota e ritira' and a.Anno = <anno> and a.Mese in (<mesi>)  and t.Reparto = '<sede>' and t.Banco not in ('', 'y Amministrazione')\ngroup by t.Banco, a.Settimana\nunion\nselect distinct '1pr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Anno = <anno> and a.Mese in (<mesi>)  and t.Reparto = '<sede>' and t.Banco not in ('', 'y Amministrazione')\ngroup by t.Banco, a.Settimana\n*/\n) as ground\nPIVOT (\nsum(Importo)\nfor Settimana in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31],[32],[33],[34],[35],[36],[37],[38],[39],[40],[41],[42],[43],[44],[45],[46],[47],[48],[49],[50],[51],[52],[53])\n) as Layer1\n--union select '1---(solo P&R)'      ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\n--union select '2---(senza P&R)'     ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\n--union select '3---(Tutto compreso)',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "neg1002": "select Utente,\n       round(isnull([1] ,0),2) as Set01, round(isnull([2] ,0),2) as Set02, round(isnull([3] ,0),2) as Set03, round(isnull([4] ,0),2) as Set04, round(isnull([5] ,0),2) as Set05, round(isnull([6] ,0),2) as Set06, round(isnull([7] ,0),2) as Set07, round(isnull([8] ,0),2) as Set08, round(isnull([9] ,0),2) as Set09, round(isnull([10],0),2) as Set10,\n\t   round(isnull([11],0),2) as Set11, round(isnull([12],0),2) as Set12, round(isnull([13],0),2) as Set13, round(isnull([14],0),2) as Set14, round(isnull([15],0),2) as Set15, round(isnull([16],0),2) as Set16, round(isnull([17],0),2) as Set17, round(isnull([18],0),2) as Set18, round(isnull([19],0),2) as Set19, round(isnull([20],0),2) as Set20,\n\t   round(isnull([21],0),2) as Set21, round(isnull([22],0),2) as Set22, round(isnull([23],0),2) as Set23, round(isnull([24],0),2) as Set24, round(isnull([25],0),2) as Set25, round(isnull([26],0),2) as Set26, round(isnull([27],0),2) as Set27, round(isnull([28],0),2) as Set28, round(isnull([29],0),2) as Set29, round(isnull([30],0),2) as Set30,\n\t   round(isnull([31],0),2) as Set31, round(isnull([32],0),2) as Set32, round(isnull([33],0),2) as Set33, round(isnull([34],0),2) as Set34, round(isnull([35],0),2) as Set35, round(isnull([36],0),2) as Set36, round(isnull([37],0),2) as Set37, round(isnull([38],0),2) as Set38, round(isnull([39],0),2) as Set39, round(isnull([40],0),2) as Set40,\n\t   round(isnull([41],0),2) as Set41, round(isnull([42],0),2) as Set42, round(isnull([43],0),2) as Set43, round(isnull([44],0),2) as Set44, round(isnull([45],0),2) as Set45, round(isnull([46],0),2) as Set46, round(isnull([47],0),2) as Set47, round(isnull([48],0),2) as Set48, round(isnull([49],0),2) as Set49, round(isnull([50],0),2) as Set50,\n\t   round(isnull([51],0),2) as Set51, round(isnull([52],0),2) as Set52, round(isnull([53],0),2) as Set53,\n\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) +\n\t   isnull([31],0) + isnull([32],0) + isnull([33],0) + isnull([34],0) + isnull([35],0) + isnull([36],0) + isnull([37],0) + isnull([38],0) + isnull([39],0) + isnull([40],0) +\n\t   isnull([41],0) + isnull([42],0) + isnull([43],0) + isnull([44],0) + isnull([45],0) + isnull([46],0) + isnull([47],0) + isnull([48],0) + isnull([49],0) + isnull([50],0) +\n\t   isnull([51],0) + isnull([52],0) + isnull([53],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.Anno = <anno> and a.Mese in (<mesi>) and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Settimana\nunion\nselect distinct '1spr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.TipoOrdine != 'Prenota e ritira' and a.Anno = <anno> and a.Mese in (<mesi>) and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Settimana\nunion\nselect distinct '1spr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Anno = <anno> and a.Mese in (<mesi>) and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Settimana\n) as ground\nPIVOT (\nsum(Importo)\nfor Settimana in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31],[32],[33],[34],[35],[36],[37],[38],[39],[40],[41],[42],[43],[44],[45],[46],[47],[48],[49],[50],[51],[52],[53])\n) as Layer1\nunion select '2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "neg0003": "select Utente,\n       round(isnull([1] ,0),2) as GG01, round(isnull([2] ,0),2) as GG02, round(isnull([3] ,0),2) as GG03, round(isnull([4] ,0),2) as GG04, round(isnull([5] ,0),2) as GG05, round(isnull([6] ,0),2) as GG06, round(isnull([7] ,0),2) as GG07, round(isnull([8] ,0),2) as GG08, round(isnull([9] ,0),2) as GG09, round(isnull([10],0),2) as GG10,\n\t   round(isnull([11],0),2) as GG11, round(isnull([12],0),2) as GG12, round(isnull([13],0),2) as GG13, round(isnull([14],0),2) as GG14, round(isnull([15],0),2) as GG15, round(isnull([16],0),2) as GG16, round(isnull([17],0),2) as GG17, round(isnull([18],0),2) as GG18, round(isnull([19],0),2) as GG19, round(isnull([20],0),2) as GG20,\n\t   round(isnull([21],0),2) as GG21, round(isnull([22],0),2) as GG22, round(isnull([23],0),2) as GG23, round(isnull([24],0),2) as GG24, round(isnull([25],0),2) as GG25, round(isnull([26],0),2) as GG26, round(isnull([27],0),2) as GG27, round(isnull([28],0),2) as GG28, round(isnull([29],0),2) as GG29, round(isnull([30],0),2) as GG30,isnull([31],0) as GG31,\n       round(isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) + isnull([31],0),2) as TotaleMese\nfrom (\nselect distinct t.Banco as Utente, a.Giorno as Giorno, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.Mese = <mese> and a.Anno = <anno>  and t.Reparto = '<sede>'  and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc') and a.TipoRiga != 'Omaggio'\ngroup by t.Banco, a.Giorno\nunion\nselect banco, 1, 0 from stats..tecnici where banco != '' and reparto = '<sede>'\n) as ground\nPIVOT (\nsum(Importo)\nfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as Layer1\norder by 1,2",
    "neg1003": "select Utente,\n       round(isnull([1] ,0),2) as GG01, round(isnull([2] ,0),2) as GG02, round(isnull([3] ,0),2) as GG03, round(isnull([4] ,0),2) as GG04, round(isnull([5] ,0),2) as GG05, round(isnull([6] ,0),2) as GG06, round(isnull([7] ,0),2) as GG07, round(isnull([8] ,0),2) as GG08, round(isnull([9] ,0),2) as GG09, round(isnull([10],0),2) as GG10,\n\t   round(isnull([11],0),2) as GG11, round(isnull([12],0),2) as GG12, round(isnull([13],0),2) as GG13, round(isnull([14],0),2) as GG14, round(isnull([15],0),2) as GG15, round(isnull([16],0),2) as GG16, round(isnull([17],0),2) as GG17, round(isnull([18],0),2) as GG18, round(isnull([19],0),2) as GG19, round(isnull([20],0),2) as GG20,\n\t   round(isnull([21],0),2) as GG21, round(isnull([22],0),2) as GG22, round(isnull([23],0),2) as GG23, round(isnull([24],0),2) as GG24, round(isnull([25],0),2) as GG25, round(isnull([26],0),2) as GG26, round(isnull([27],0),2) as GG27, round(isnull([28],0),2) as GG28, round(isnull([29],0),2) as GG29, round(isnull([30],0),2) as GG30,isnull([31],0) as GG31,\n       round(isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) + isnull([31],0),2) as TotaleMese\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Giorno as Giorno, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.Mese = <mese> and a.Anno = <anno> and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Giorno\nunion\nselect distinct '1spr - ' + t.Banco as Utente, a.Giorno, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.TipoOrdine != 'Prenota e ritira' and a.Mese = <mese> and a.Anno = <anno> and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Giorno\nunion\nselect distinct '1spr - ' + t.Banco as Utente, a.Giorno, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Mese = <mese> and a.Anno = <anno> and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc')\ngroup by t.Banco, a.Giorno\n) as ground\nPIVOT (\nsum(Importo)\nfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as Layer1\nunion select '2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "neg0004": "select Cdc as Settore,Utente ,\n       isnull([1],0) as GG01,isnull([2],0) as GG02,isnull([3],0) as GG03,isnull([4],0) as GG04,isnull([5],0) as GG05,isnull([6],0) as GG06,isnull([7],0) as GG07,isnull([8],0) as GG08,isnull([9],0) as GG09,isnull([10],0) as GG10,\n\t   isnull([11],0) as GG11,isnull([12],0) as GG12,isnull([13],0) as GG13,isnull([14],0) as GG14,isnull([15],0) as GG15,isnull([16],0) as GG16,isnull([17],0) as GG17,isnull([18],0) as GG18,isnull([19],0) as GG19,isnull([20],0) as GG20,\n\t   isnull([21],0) as GG21,isnull([22],0) as GG22,isnull([23],0) as GG23,isnull([24],0) as GG24,isnull([25],0) as GG25,isnull([26],0) as GG26,isnull([27],0) as GG27,isnull([28],0) as GG28,isnull([29],0) as GG29,isnull([30],0) as GG30,isnull([31],0) as GG31\nfrom (\n\n\tselect d.Cdc, '3cpr - ' + d.UtenteNegozio as Utente, d.Giorno, SUM(d.TotRiga) as Importo\n\tfrom stats..consegnato2 d\n\twhere d.Anno = <anno>\n\t  and d.Mese = <mese>\n\t  and d.CdC = 'Punto Vendita'\n\t  and d.TipoDoc in ('srb', 'rcb','rcd','rca')\n\t  and d.Magazzino in ('<magsede>','ACEMA')\n\tgroup by d.Cdc, '3cpr - ' + d.UtenteNegozio, d.Giorno\n\tunion\n\tselect 'Punto Vendita','2----------',0,0\n\tunion\n\tselect d.Cdc, '1spr - ' + d.UtenteNegozio as Utente, d.Giorno, SUM(d.TotRiga) as Importo\n\tfrom stats..consegnato2 d\n\twhere d.Anno = <anno>\n\t  and d.Mese = <mese>\n\t  and d.CdC = 'Punto Vendita'\n\t  and d.TipoDoc in ('srb', 'rcb','rcd','rca')\n\t  and d.Magazzino in ('<magsede>','ACEMA')\n\t  and d.TipoOrdine != 'Prenota e ritira'\n\tgroup by d.Cdc, '1spr - ' + d.UtenteNegozio, d.Giorno\n\tunion\n\tselect Classe, '1spr - ' + Banco, 1, 0 from Stats..Tecnici t where Reparto = '<sede>' and Classe = 'Punto vendita' and Banco != '1 Claudio Bassanello'\n\tunion\n\tselect Classe, '3cpr - ' + Banco, 1, 0 from Stats..Tecnici t where Reparto = '<sede>' and Classe = 'Punto vendita' and Banco != '1 Claudio Bassanello'\n) as layer1\nPIVOT (\nsum(Importo)\nfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as layer2\norder by 1,2",
    "neg1004": "select Cdc as Settore,Utente ,\n       isnull([1],0) as GG01,isnull([2],0) as GG02,isnull([3],0) as GG03,isnull([4],0) as GG04,isnull([5],0) as GG05,isnull([6],0) as GG06,isnull([7],0) as GG07,isnull([8],0) as GG08,isnull([9],0) as GG09,isnull([10],0) as GG10,\n\t   isnull([11],0) as GG11,isnull([12],0) as GG12,isnull([13],0) as GG13,isnull([14],0) as GG14,isnull([15],0) as GG15,isnull([16],0) as GG16,isnull([17],0) as GG17,isnull([18],0) as GG18,isnull([19],0) as GG19,isnull([20],0) as GG20,\n\t   isnull([21],0) as GG21,isnull([22],0) as GG22,isnull([23],0) as GG23,isnull([24],0) as GG24,isnull([25],0) as GG25,isnull([26],0) as GG26,isnull([27],0) as GG27,isnull([28],0) as GG28,isnull([29],0) as GG29,isnull([30],0) as GG30,isnull([31],0) as GG31\nfrom (\n\n\tselect d.Cdc, '3cpr - ' + d.UtenteNegozio as Utente, d.Giorno, SUM(d.TotRiga) as Importo\n\tfrom stats..consegnato2 d\n\twhere d.Anno = <anno>\n\t  and d.Mese = <mese>\n\t  and d.CdC = 'Punto Vendita'\n\t  and d.TipoDoc in ('srb', 'rcb','rcd','rca')\n\t  and d.Magazzino in ('MAGVA')\n\tgroup by d.Cdc, '3cpr - ' + d.UtenteNegozio, d.Giorno\n\tunion\n\tselect 'Punto Vendita','2----------',0,0\n\tunion\n\tselect d.Cdc, '1spr - ' + d.UtenteNegozio as Utente, d.Giorno, SUM(d.TotRiga) as Importo\n\tfrom stats..consegnato2 d\n\twhere d.Anno = <anno>\n\t  and d.Mese = <mese>\n\t  and d.CdC = 'Punto Vendita'\n\t  and d.TipoDoc in ('srb', 'rcb','rcd','rca')\n\t  and d.Magazzino in ('MAGVA')\n\t  and d.TipoOrdine != 'Prenota e ritira'\n\tgroup by d.Cdc, '1spr - ' + d.UtenteNegozio, d.Giorno\n\tunion\n\tselect Classe, '1spr - ' + Banco, 1, 0 from Stats..Tecnici t where Reparto = '<sede>' and Classe = 'Punto vendita' and Banco != '1 Claudio Bassanello'\n\tunion\n\tselect Classe, '3cpr - ' + Banco, 1, 0 from Stats..Tecnici t where Reparto = '<sede>' and Classe = 'Punto vendita' and Banco != '1 Claudio Bassanello'\n) as layer1\nPIVOT (\nsum(Importo)\nfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as layer2\norder by 1,2",
    "neg0005": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Legno,2) as LegnoPvc, round(Alluminio,2) as AlluminioFerro, round(Prodotto,2) as ProdottoFinito, round(Utensileria,2) as Utensileria, round(Complementi,2) as Complementi,\n  case when totale = 0 then 0 else round(Legno/totale * 100,2)       end as PercLegno,\n  case when totale = 0 then 0 else round(Alluminio/totale * 100,2)   end as PercAlluminio,\n  case when totale = 0 then 0 else round(Prodotto/totale * 100,2)    end as PercProdotto,\n  case when totale = 0 then 0 else round(Utensileria/totale * 100,2) end as PercUtensileria,\n  case when totale = 0 then 0 else round(Complementi/totale * 100,2) end as PercComplementi\nfrom\n(\n\tselect Utente,\n\t\t   isnull([LEGNO/PVC],0) as Legno,isnull([ALLUMINIO - FERRO],0) as Alluminio,isnull([PROD. FINITO],0) as Prodotto,isnull([UTENSILERIA],0) as Utensileria,isnull([COMPLEMENTI],0) as Complementi,\n\t\t   isnull([ALTRO],0) + isnull([Nessun Settore],0) + isnull([YCO],0) + isnull([LEGNO/PVC],0) + isnull([ALLUMINIO - FERRO],0) + isnull([PROD. FINITO],0) + isnull([UTENSILERIA],0) + isnull([COMPLEMENTI],0) as Totale\n\tfrom\n\t(\n\t\tselect d.UtenteNegozio as Utente, d.CategoriaFornitore, (select isnull(sum(c.TotRiga),0) from stats..consegnato2 c where c.UtenteNegozio = d.UtenteNegozio and c.CategoriaFornitore = d.CategoriaFornitore and c.DataDoc >= @dadata and c.DataDoc <= @adata and c.CdC = 'Punto Vendita' and c.TipoOrdine != 'Prenota e ritira' and c.SedeUtente = '<sede>') as Importo\n\t\tfrom Stats..consegnato2 d\n\t\twhere d.CdC = 'Punto Vendita' and d.TipoOrdine != 'Prenota e ritira' and d.SedeUtente = '<sede>' and d.UtenteNegozio not in ('2 Luca Deppieri','')\n\t\tgroup by UtenteNegozio, CategoriaFornitore\n\t\tunion select banco, 'UTENSILERIA', 0 from stats..tecnici where banco != '' and reparto = '<sede>'\n\t) as layer1\n\tPIVOT\n\t(\n\t\tsum(Importo)\n\t\tfor CategoriaFornitore in ([UTENSILERIA],[LEGNO/PVC],[PROD. FINITO],[COMPLEMENTI],[ALTRO],[Nessun Settore],[ALLUMINIO - FERRO],[YCO])\n\t) as layer2\n) as layer3\norder by 1",
    "neg1005": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Legno,2) as LegnoPvc, round(Alluminio,2) as AlluminioFerro, round(Prodotto,2) as ProdottoFinito, round(Utensileria,2) as Utensileria, round(Complementi,2) as Complementi,\n  case when totale = 0 then 0 else round(Legno/totale * 100,2)       end as PercLegno,\n  case when totale = 0 then 0 else round(Alluminio/totale * 100,2)   end as PercAlluminio,\n  case when totale = 0 then 0 else round(Prodotto/totale * 100,2)    end as PercProdotto,\n  case when totale = 0 then 0 else round(Utensileria/totale * 100,2) end as PercUtensileria,\n  case when totale = 0 then 0 else round(Complementi/totale * 100,2) end as PercComplementi\nfrom\n(\n\tselect Utente,\n\t\t   isnull([LEGNO/PVC],0) as Legno,isnull([ALLUMINIO - FERRO],0) as Alluminio,isnull([PROD. FINITO],0) as Prodotto,isnull([UTENSILERIA],0) as Utensileria,isnull([COMPLEMENTI],0) as Complementi,\n\t\t   isnull([ALTRO],0) + isnull([Nessun Settore],0) + isnull([YCO],0) + isnull([LEGNO/PVC],0) + isnull([ALLUMINIO - FERRO],0) + isnull([PROD. FINITO],0) + isnull([UTENSILERIA],0) + isnull([COMPLEMENTI],0) as Totale\n\tfrom\n\t(\n\t\tselect d.UtenteNegozio as Utente, d.CategoriaFornitore, (select isnull(sum(c.TotRiga),0) from stats..consegnato c where c.UtenteNegozio = d.UtenteNegozio and c.CategoriaFornitore = d.CategoriaFornitore and c.DataDoc >= @dadata and c.DataDoc <= @adata and c.CdC = 'Punto Vendita' and c.TipoOrdine != 'Prenota e ritira' and c.SedeUtente = 'va') as Importo\n\t\tfrom Stats..consegnato2 d\n\t\twhere d.CdC = 'Punto Vendita' and d.TipoOrdine != 'Prenota e ritira' and d.SedeUtente = 'va' and d.UtenteNegozio not in ('2 Luca Deppieri','')\n\t\tgroup by UtenteNegozio, CategoriaFornitore\n\n\t) as layer1\n\tPIVOT\n\t(\n\t\tsum(Importo)\n\t\tfor CategoriaFornitore in ([UTENSILERIA],[LEGNO/PVC],[PROD. FINITO],[COMPLEMENTI],[ALTRO],[Nessun Settore],[ALLUMINIO - FERRO],[YCO])\n\t) as layer2\n) as layer3\norder by 1",
    "neg0006": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect a.CodiceCliente, a.RagioneSociale, cast(sum(a.TotRiga) as decimal(19,2)) as ImponibileTotPeriodo,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Alluminio Ferro') as decimal(19,2)) as AlluminioFerro,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Legno PVC'      ) as decimal(19,2)) as LegnoPVC,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Prodotto Finito') as decimal(19,2)) as ProdottoFinito,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Waterproof'     ) as decimal(19,2)) as Yco,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Punto Vendita'  ) as decimal(19,2)) as PuntoVendita,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Utensileria'    ) as decimal(19,2)) as Utensileria,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Web'            ) as decimal(19,2)) as Web\nfrom stats..consegnato2 a\nwhere a.datadoc between @dadata and @adata and a.CodiceAgente = '<agente>' and a.articolo not in ('zzzacc')\ngroup by a.CodiceCliente, a.RagioneSociale",
    "neg0007": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Email,2) as Email, round(Telefonico,2) as Telefonico, round(InSede,2) as InSede, round(UfficiCommerciali,2) as UfficiComm, round(Agente,2) as Agente, round(Telefonico+UfficiCommerciali+InSede+Email+Agente,2) as Totale,\n       round(Email/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Mail%',\n\t   round(Telefonico/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Telefonico%',\n\t   round(InSede/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'InSede%',\n\t   round(UfficiCommerciali/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Uffici%',\n\t   round(Agente/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Agente%'\nfrom\n(\nselect Utente,\n\tisnull([TELEFONICO],0) as Telefonico, isnull([UFFICI COMMERCIALI],0) as UfficiCommerciali, isnull([IN SEDE],0) as InSede, isnull([EMAIL],0) as Email, isnull([AGENTE],0) as Agente\nfrom (\nselect u.Banco as Utente, f.Descrizione as TipoFonte, cast(sum(r.TOTNETTORIGAEURO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join temp..tecnici u on x.ND_UTENTECREAZ = u.Codice\n  inner join colfert..NDTabTipiFonte f on x.TipoFonte = f.Codice\nwhere r.TIPORIGA = 'n' and (t.tipodoc in ('DCB','SCB','FCA','FCV') ) and u.classe in ('Cassa', 'Punto Vendita') and u.Reparto = '<sede>' and t.DATADOC between @dadata and @adata\ngroup by t.TIPODOC, f.Descrizione, x.ND_UTENTECREAZ, u.Banco\n) as pippa\nPIVOT (\nsum(Importo)\nfor TipoFonte in ([TELEFONICO],[UFFICI COMMERCIALI],[IN SEDE],[EMAIL],[AGENTE])\n) as Pippo\n) as ground\norder by 1",
    "neg1007": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Email,2), round(Telefonico,2), round(InSede,2), round(UfficiCommerciali,2), round(Agente,2), round(Telefonico+UfficiCommerciali+InSede+Email+Agente,2) as Totale,\n       round(Email/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Mail%',\n\t   round(Telefonico/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Telefonico%',\n\t   round(InSede/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'InSede%',\n\t   round(UfficiCommerciali/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Uffici%',\n\t   round(Agente/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Agente%'\nfrom\n(\nselect Utente,\n\tisnull([TELEFONICO],0) as Telefonico, isnull([UFFICI COMMERCIALI],0) as UfficiCommerciali, isnull([IN SEDE],0) as InSede, isnull([EMAIL],0) as Email, isnull([AGENTE],0) as Agente\nfrom (\nselect u.Banco as Utente, f.Descrizione as TipoFonte, cast(sum(r.TOTNETTORIGAEURO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join temp..tecnici u on x.ND_UTENTECREAZ = u.Codice\n  inner join colfert..NDTabTipiFonte f on x.TipoFonte = f.Codice\nwhere r.TIPORIGA = 'n' and (t.tipodoc in ('DCB','SCB','FCA','FCV') ) and u.classe in ('Cassa', 'Punto Vendita') and u.Reparto = 'VA' and t.DATADOC between @dadata and @adata\ngroup by t.TIPODOC, f.Descrizione, x.ND_UTENTECREAZ, u.Banco\n) as pippa\nPIVOT (\nsum(Importo)\nfor TipoFonte in ([TELEFONICO],[UFFICI COMMERCIALI],[IN SEDE],[EMAIL],[AGENTE])\n) as Pippo\n) as ground\norder by 1",
    "neg0008": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Email,2), round(Telefonico,2), round(InSede,2), round(UfficiCommerciali,2), round(Agente,2), round(Telefonico+UfficiCommerciali+InSede+Email+Agente,2) as Totale,\n       round(Email/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Mail%',\n\t   round(Telefonico/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Telefonico%',\n\t   round(InSede/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'InSede%',\n\t   round(UfficiCommerciali/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Uffici%',\n\t   round(Agente/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Agente%'\nfrom\n(\nselect Utente,\n\tisnull([TELEFONICO],0) as Telefonico, isnull([UFFICI COMMERCIALI],0) as UfficiCommerciali, isnull([IN SEDE],0) as InSede, isnull([EMAIL],0) as Email, isnull([AGENTE],0) as Agente\nfrom (\nselect u.Banco as Utente, f.Descrizione as TipoFonte, cast(sum(r.TOTNETTORIGAEURO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join temp..tecnici u on x.ND_UTENTECREAZ = u.Codice\n  inner join colfert..NDTabTipiFonte f on x.TipoFonte = f.Codice\nwhere r.TIPORIGA = 'n' and (t.tipodoc in ('OCB','OCV','OCW') ) and u.classe in ('Cassa', 'Punto Vendita') and u.Reparto = '<sede>' and t.DATADOC between @dadata and @adata\ngroup by t.TIPODOC, f.Descrizione, x.ND_UTENTECREAZ, u.Banco\n) as pippa\nPIVOT (\nsum(Importo)\nfor TipoFonte in ([TELEFONICO],[UFFICI COMMERCIALI],[IN SEDE],[EMAIL],[AGENTE])\n) as Pippo\n) as ground\norder by 1",
    "neg1008": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Email,2), round(Telefonico,2), round(InSede,2), round(UfficiCommerciali,2), round(Agente,2), round(Telefonico+UfficiCommerciali+InSede+Email+Agente,2) as Totale,\n       round(Email/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Mail%',\n\t   round(Telefonico/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Telefonico%',\n\t   round(InSede/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'InSede%',\n\t   round(UfficiCommerciali/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Uffici%',\n\t   round(Agente/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Agente%'\nfrom\n(\nselect Utente,\n\tisnull([TELEFONICO],0) as Telefonico, isnull([UFFICI COMMERCIALI],0) as UfficiCommerciali, isnull([IN SEDE],0) as InSede, isnull([EMAIL],0) as Email, isnull([AGENTE],0) as Agente\nfrom (\nselect u.Banco as Utente, f.Descrizione as TipoFonte, cast(sum(r.TOTNETTORIGAEURO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join temp..tecnici u on x.ND_UTENTECREAZ = u.Codice\n  inner join colfert..NDTabTipiFonte f on x.TipoFonte = f.Codice\nwhere r.TIPORIGA = 'n' and (t.tipodoc in ('OCB','OCV','OCW') ) and u.classe in ('Cassa', 'Punto Vendita') and u.Reparto = 'VA' and t.DATADOC between @dadata and @adata\ngroup by t.TIPODOC, f.Descrizione, x.ND_UTENTECREAZ, u.Banco\n) as pippa\nPIVOT (\nsum(Importo)\nfor TipoFonte in ([TELEFONICO],[UFFICI COMMERCIALI],[IN SEDE],[EMAIL],[AGENTE])\n) as Pippo\n) as ground\norder by 1",
    "neg0009": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.NomeUtente, d.UtenteNegozio, count(distinct d.progressivo) as ContoTotalePreventivi,\n  (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') as ContoPreventiviPuri,\n  (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 like 'o%') as ContoPreventiviRealizzati,\n  case when (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') != 0\n  then\n    round(cast((select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 like 'o%') as float) /\n    cast((select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') as float) * 100, 1)\n  else 0\n  end\n  as PercentualeRealizzazione\nfrom stats..preventivato d\nwhere d.datadoc >= @dadata and d.datadoc <= @adata\n  and d.Cdc = 'Punto Vendita' and d.SedeUtente = '<sede>' and d.UtenteNegozio not in ('2 Luca Deppieri','')\ngroup by d.NomeUtente, d.UtenteNegozio\norder by 2,1",
    "neg1009": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.NomeUtente, d.UtenteNegozio, count(distinct d.progressivo) as ContoTotalePreventivi,\n  (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') as ContoPreventiviPuri,\n  (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 like 'o%') as ContoPreventiviRealizzati,\n  case when (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') != 0\n  then\n    round(cast((select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 like 'o%') as float) /\n    cast((select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') as float) * 100, 1)\n  else 0\n  end\n  as PercentualeRealizzazione\nfrom stats..preventivato d\nwhere d.datadoc >= @dadata and d.datadoc <= @adata\n  and d.Cdc = 'Punto Vendita' and d.SedeUtente = 'VA'\ngroup by d.NomeUtente, d.UtenteNegozio\norder by 2,1",
    "neg0010": "with g as (\nSELECT  mg.CodArt as Articolo, isnull(ar.desart,'') as Descrizione, isnull(ar.Pers_ABC_RS,'') as ClasseArt, SUM(mg.GIACENZA * mg.QTA1UM) as GiacenzaUb,CODDEPOSITO as Magazzino,CodUbicazione as Ubicazione, cast(max(mg.DataMov) as date) as UltimoMovimento\nFROM colfert..STORICOMAG mg left outer join sismag..Articoli ar on mg.codart = ar.CODART\nwhere mg.giacenza <> 0 and mg.CODUBICAZIONE like 'g%' and mg.CODDEPOSITO = '<magsede>'\ngroup by mg.codart, mg.CODDEPOSITO, mg.codubicazione, ar.desart, ar.Pers_ABC_RS\nhaving SUM(mg.GIACENZA * mg.QTA1UM) <> 0\n)\nselect CodiceArticolo, a.DescrizioneArticolo, a.CodiceFornitore, a.NomeFornitore, a.CategoriaFornitore, a.NomeBuyer, a.TipoGestioneTV, a.QtaPerConfezione, g.GiacenzaUb, g.Magazzino, g.Ubicazione, g.UltimoMovimento\nfrom stats..arts a inner join g on a.CodiceArticolo = g.Articolo\norder by 10,11",
    "neg0011": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.CodiceArticolo, d.Descrizione, d.NomeFornitore, d.CategoriaFornitore, d.TipoGestione<sede>, sum(d.Quantita) as Quantità, cast(sum(d.TotRiga) as decimal(15,2)) as Importo, count(distinct codicecliente) as ContoClienti, l.Nd_PrcRicarico as Ricarico\nfrom stats..ordinato d\n     inner join colfert..LISTINIARTICOLI l on d.codicearticolo = l.CODART and l.NRLISTINO = 11\nwhere d.tipodoc = 'ocb' and d.datadoc >= @dadata and d.datadoc <= @adata and d.DExtra3 = 'Punto Vendita' and d.magazzino = '<magsede>'\ngroup by d.CodiceArticolo, d.Descrizione, d.NomeFornitore, d.TipoGestione<sede>, d.CategoriaFornitore, l.Nd_PrcRicarico\norder by 1",
    "neg0012": "select DExtra5 as Utente, sum(Quantita) as Quantità, cast(sum(totriga) as decimal(15,2)) as Venduto\nfrom stats..consegnato2\nwhere datadoc between '<fromdate>' and '<todate>'\nand CodiceArticolo between '<daart>' and '<adart>'\nand DExtra4 = '<sede>'\ngroup by DExtra5",
    "neg1012": "select DExtra5 as Utente, sum(Quantita) as Quantità, cast(sum(totriga) as decimal(15,2)) as Venduto\nfrom stats..consegnato2\nwhere datadoc between '<fromdate>' and '<todate>'\nand CodiceArticolo between '<daart>' and '<adart>'\nand DExtra4 = 'VA'\ngroup by DExtra5",
    "neg0013": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect o.DataDoc, o.TipoDoc, o.NumeroDoc, o.CodiceCliente, o.RagioneSociale, o.CodiceAgente, cast(sum(o.TotRiga) as decimal(12,2)) as ImportoOrdine, o.NomeUtente, o.DExtra1 as NomeUtente2\nfrom stats..ordinato o\n     inner join stats..ordinato p on o.progressivo = p.progressivo and p.datadoc between @dadata and @adata and p.CategoriaFornitore = 'PROD. FINITO'\nwhere o.datadoc between @dadata and @adata\nand (\n      ( o.tipodoc in ('ocv','ocw','ocd') and o.CodiceAgente in ('A     4','A    50','A    67','A   155') )\n\t  or\n\t  (o.tipodoc = 'OCB')\n\t)\ngroup by o.DataDoc, o.TipoDoc, o.NumeroDoc, o.CodiceCliente, o.RagioneSociale, o.CodiceAgente, o.NomeUtente, o.DExtra1\norder by 1",
    "neg0014": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect a.CodiceCliente, a.RagioneSociale, cast(sum(a.TotRiga) as decimal(19,2)) as ImponibileTotPeriodo,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Alluminio Ferro') as decimal(19,2)) as AlluminioFerro,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Legno PVC'      ) as decimal(19,2)) as LegnoPVC,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Prodotto Finito') as decimal(19,2)) as ProdottoFinito,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Waterproof'     ) as decimal(19,2)) as Yco,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Punto Vendita'  ) as decimal(19,2)) as PuntoVendita,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Utensileria'    ) as decimal(19,2)) as Utensileria,\n\tcast((select isnull(cast(sum(b.TotRiga) as float),0) from stats..consegnato2 b where b.datadoc between @dadata and @adata and b.codicecliente = a.CodiceCliente and b.cdc = 'Web'            ) as decimal(19,2)) as Web\nfrom stats..consegnato2 a\nwhere a.datadoc between @dadata and @adata and a.CodiceAgente = '<agente>' and a.articolo not like ('zzz%') and a.articolo not like ('001%')\ngroup by a.CodiceCliente, a.RagioneSociale",
    "neg0015": "select Utente,\n       round(isnull([1] ,0),2) as Gennaio, round(isnull([2] ,0),2) as Febbraio, round(isnull([3] ,0),2) as Marzo    , round(isnull([4] ,0),2) as Aprile , round(isnull([5] ,0),2) as Maggio  , round(isnull([6] ,0),2) as Giugno,\n\t   round(isnull([7] ,0),2) as Luglio , round(isnull([8] ,0),2) as Agosto  , round(isnull([9] ,0),2) as Settembre, round(isnull([10],0),2) as Ottobre, round(isnull([11],0),2) as Novembre, round(isnull([12],0),2) as Dicembre,\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.Anno = <anno> and t.Reparto = '<sede>' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc') and a.TipoRiga != 'Omaggio'\ngroup by t.Banco, a.Mese\n) as ground\nPIVOT (\nsum(Importo)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Layer1\norder by 1,2",
    "neg1015": "select Utente,\n       round(isnull([1] ,0),2) as Gennaio, round(isnull([2] ,0),2) as Febbraio, round(isnull([3] ,0),2) as Marzo    , round(isnull([4] ,0),2) as Aprile , round(isnull([5] ,0),2) as Maggio  , round(isnull([6] ,0),2) as Giugno,\n\t   round(isnull([7] ,0),2) as Luglio , round(isnull([8] ,0),2) as Agosto  , round(isnull([9] ,0),2) as Settembre, round(isnull([10],0),2) as Ottobre, round(isnull([11],0),2) as Novembre, round(isnull([12],0),2) as Dicembre,\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere a.Anno = <anno> and t.Reparto = 'VA' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc') and a.TipoRiga != 'Omaggio'\ngroup by t.Banco, a.Mese\n) as ground\nPIVOT (\nsum(Importo)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Layer1\norder by 1,2",
    "neg0016": "select Utente,\n       round(isnull([1] ,0),2) as GG01, round(isnull([2] ,0),2) as GG02, round(isnull([3] ,0),2) as GG03, round(isnull([4] ,0),2) as GG04, round(isnull([5] ,0),2) as GG05, round(isnull([6] ,0),2) as GG06, round(isnull([7] ,0),2) as GG07, round(isnull([8] ,0),2) as GG08, round(isnull([9] ,0),2) as GG09, round(isnull([10],0),2) as GG10,\n\t   round(isnull([11],0),2) as GG11, round(isnull([12],0),2) as GG12, round(isnull([13],0),2) as GG13, round(isnull([14],0),2) as GG14, round(isnull([15],0),2) as GG15, round(isnull([16],0),2) as GG16, round(isnull([17],0),2) as GG17, round(isnull([18],0),2) as GG18, round(isnull([19],0),2) as GG19, round(isnull([20],0),2) as GG20,\n\t   round(isnull([21],0),2) as GG21, round(isnull([22],0),2) as GG22, round(isnull([23],0),2) as GG23, round(isnull([24],0),2) as GG24, round(isnull([25],0),2) as GG25, round(isnull([26],0),2) as GG26, round(isnull([27],0),2) as GG27, round(isnull([28],0),2) as GG28, round(isnull([29],0),2) as GG29, round(isnull([30],0),2) as GG30,isnull([31],0) as GG31,\n       round(isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) + isnull([31],0),2) as TotaleMese\nfrom (\nselect distinct t.Banco as Utente, a.Giorno as Giorno, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.Mese = <mese> and a.Anno = <anno>  and t.Reparto = '<sede>'  and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc') and a.TipoRiga != 'Omaggio'\ngroup by t.Banco, a.Giorno\nunion\nselect banco, 1, 0 from stats..tecnici where banco != '' and reparto = '<sede>'\n) as ground\nPIVOT (\nsum(Importo)\nfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as Layer1\norder by 1,2",
    "neg0017": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect CodiceFornitore, NomeFornitore, CategoriaFornitore, TipoDoc, UtenteNegozio, round(sum(totriga),2) as Ordinato\nfrom stats..ordinato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice --and t.reparto = '<sede>'\nwhere datadoc between @dadata and @adata and tipodoc = 'ocb' and codicefornitore like '%<cardcode>%' and CodiceArticolo != 'ZZZACC' and TipoRiga = 'Normale'\ngroup by CodiceFornitore, NomeFornitore, TipoDoc, UtenteNegozio, CategoriaFornitore\norder by 1,4",
    "neg1017": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect CodiceFornitore, NomeFornitore, CategoriaFornitore, TipoDoc, UtenteNegozio, round(sum(totriga),2) as Ordinato\nfrom stats..ordinato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere datadoc between @dadata and @adata and tipodoc = 'ocb'\ngroup by CodiceFornitore, NomeFornitore, TipoDoc, UtenteNegozio, CategoriaFornitore\norder by 1,4",
    "xneg0018": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect CategoriaFornitore, TipoDoc, UtenteNegozio, round(sum(totriga),2) as Ordinato\nfrom stats..ordinato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere datadoc between @dadata and @adata and tipodoc = 'ocb' and codicefornitore like '%<cardcode>%'\ngroup by CategoriaFornitore, TipoDoc, UtenteNegozio\norder by 1,4",
    "xneg1018": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect CategoriaFornitore, TipoDoc, UtenteNegozio, round(sum(totriga),2) as Ordinato\nfrom stats..ordinato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere datadoc between @dadata and @adata and tipodoc = 'ocb'\ngroup by CategoriaFornitore, TipoDoc, UtenteNegozio\norder by 1,4",
    "neg0018": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect Datadoc, TipoDoc, NumeroDoc, CodiceCliente, RagioneSociale, NomeAgente, ImponibileDoc, NomeUtente, NomeUtente2,\n       isnull([ALLUMINIO - FERRO],0) as Alluminio,\n       isnull([LEGNO/PVC],0) as Legno,\n       isnull([PROD. FINITO],0) as Prodotto,\n       isnull([UTENSILERIA],0) as Utensileria,\n       isnull([YCO],0) as Yco,\n       isnull([Nessun Settore],0) as NonClassificato\nfrom (\nselect Datadoc, TipoDoc, NumeroDoc, CodiceCliente, RagioneSociale, NomeAgente, ImponibileDoc, NomeUtente, Dextra1 As NomeUtente2, CategoriaFornitore, sum(totRiga) as Imponibile\nfrom stats..ordinato\nwhere tipodoc = 'ocw' and datadoc between @dadata and @adata\ngroup by Datadoc, TipoDoc, NumeroDoc, CodiceCliente, RagioneSociale, NomeAgente, ImponibileDoc, NomeUtente, Dextra1, CategoriaFornitore\n) as Layer1\nPivot (Sum(Imponibile) for CategoriaFornitore in ([ALLUMINIO - FERRO],[LEGNO/PVC],[Nessun Settore],[PROD. FINITO],[UTENSILERIA],[YCO]) ) as Layer2\nwhere isnull([UTENSILERIA],0) > isnull([ALLUMINIO - FERRO],0) and isnull([UTENSILERIA],0) > isnull([LEGNO/PVC],0) and isnull([UTENSILERIA],0) > isnull([PROD. FINITO],0)\norder by DataDoc",
    "neg0019": "select Utente,\n       round(isnull([1] ,0),2) as Gennaio, round(isnull([2] ,0),2) as Febbraio, round(isnull([3] ,0),2) as Marzo    , round(isnull([4] ,0),2) as Aprile , round(isnull([5] ,0),2) as Maggio  , round(isnull([6] ,0),2) as Giugno,\n\t   round(isnull([7] ,0),2) as Luglio , round(isnull([8] ,0),2) as Agosto  , round(isnull([9] ,0),2) as Settembre, round(isnull([10],0),2) as Ottobre, round(isnull([11],0),2) as Novembre, round(isnull([12],0),2) as Dicembre,\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.Anno = 2025 and t.Reparto = '<sede>' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc') and a.TipoRiga != 'Omaggio' and a.CodiceAgente in ('A     4','A   155')\ngroup by t.Banco, a.Mese\n) as ground\nPIVOT (\nsum(Importo)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Layer1\norder by 1,2",
    "neg0020": "select Utente,\n       round(isnull([1] ,0),2) as Gennaio, round(isnull([2] ,0),2) as Febbraio, round(isnull([3] ,0),2) as Marzo    , round(isnull([4] ,0),2) as Aprile , round(isnull([5] ,0),2) as Maggio  , round(isnull([6] ,0),2) as Giugno,\n\t   round(isnull([7] ,0),2) as Luglio , round(isnull([8] ,0),2) as Agosto  , round(isnull([9] ,0),2) as Settembre, round(isnull([10],0),2) as Ottobre, round(isnull([11],0),2) as Novembre, round(isnull([12],0),2) as Dicembre,\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct '3cpr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato2 a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = '<sede>'\nwhere a.Anno = 2025 and t.Reparto = '<sede>' and t.Banco not in ('', 'y Amministrazione') and a.articolo not in ('zzzacc') and a.TipoRiga != 'Omaggio' and a.CodiceAgente = '<agente>'\ngroup by t.Banco, a.Mese\n) as ground\nPIVOT (\nsum(Importo)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Layer1\norder by 1,2",
    "pun0004.extract": "select distinct\n(select sum(nettoriga) from temp..statcons where year(InizioTrasporto) = <anno> and month(InizioTrasporto) = <mese> ) as TotaleMese,\n(select sum(nettoriga) from temp..statcons where year(InizioTrasporto) = <anno> and month(InizioTrasporto) = <mese> and CodiceCliente = 'C  2484' ) as TotaleCli2484,\n(select sum(nettoriga) from temp..statcons where year(InizioTrasporto) = <anno> and month(InizioTrasporto) = <mese> and datepart(dw,InizioTrasporto) = 7) as TotaleSabati,\n(select sum(nettoriga) from temp..statcons where year(InizioTrasporto) = <anno> and month(InizioTrasporto) = <mese> and CodiceCliente = 'C  2484' and datepart(dw,InizioTrasporto) = 7) as TotaleSab2484\nfrom ced..temp",
    "pun0005": "select Settore, Utente,\n       round(isnull([1] ,0),2) as Gennaio, round(isnull([2] ,0),2) as Febbraio, round(isnull([3] ,0),2) as Marzo    , round(isnull([4] ,0),2) as Aprile , round(isnull([5] ,0),2) as Maggio  , round(isnull([6] ,0),2) as Giugno,\n\t   round(isnull([7] ,0),2) as Luglio , round(isnull([8] ,0),2) as Agosto  , round(isnull([9] ,0),2) as Settembre, round(isnull([10],0),2) as Ottobre, round(isnull([11],0),2) as Novembre, round(isnull([12],0),2) as Dicembre,\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.Anno = <anno> and t.Reparto = 'TV' and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Mese\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.TipoOrdine != 'Prenota e ritira' and a.Anno = <anno> and t.Reparto = 'TV' and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Mese\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Anno = <anno>  and t.Reparto = 'TV' and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Mese\n) as ground\nPIVOT (\nsum(Importo)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Layer1\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0006": "select Settore, Utente,\n       round(isnull([1] ,0),2) as Set01, round(isnull([2] ,0),2) as Set02, round(isnull([3] ,0),2) as Set03, round(isnull([4] ,0),2) as Set04, round(isnull([5] ,0),2) as Set05, round(isnull([6] ,0),2) as Set06, round(isnull([7] ,0),2) as Set07, round(isnull([8] ,0),2) as Set08, round(isnull([9] ,0),2) as Set09, round(isnull([10],0),2) as Set10,\n\t   round(isnull([11],0),2) as Set11, round(isnull([12],0),2) as Set12, round(isnull([13],0),2) as Set13, round(isnull([14],0),2) as Set14, round(isnull([15],0),2) as Set15, round(isnull([16],0),2) as Set16, round(isnull([17],0),2) as Set17, round(isnull([18],0),2) as Set18, round(isnull([19],0),2) as Set19, round(isnull([20],0),2) as Set20,\n\t   round(isnull([21],0),2) as Set21, round(isnull([22],0),2) as Set22, round(isnull([23],0),2) as Set23, round(isnull([24],0),2) as Set24, round(isnull([25],0),2) as Set25, round(isnull([26],0),2) as Set26, round(isnull([27],0),2) as Set27, round(isnull([28],0),2) as Set28, round(isnull([29],0),2) as Set29, round(isnull([30],0),2) as Set30,\n\t   round(isnull([31],0),2) as Set21, round(isnull([32],0),2) as Set22, round(isnull([33],0),2) as Set23, round(isnull([34],0),2) as Set24, round(isnull([35],0),2) as Set25, round(isnull([36],0),2) as Set26, round(isnull([37],0),2) as Set27, round(isnull([38],0),2) as Set28, round(isnull([39],0),2) as Set29, round(isnull([30],0),2) as Set40,\n\t   round(isnull([41],0),2) as Set21, round(isnull([42],0),2) as Set22, round(isnull([43],0),2) as Set23, round(isnull([44],0),2) as Set24, round(isnull([45],0),2) as Set25, round(isnull([46],0),2) as Set26, round(isnull([47],0),2) as Set27, round(isnull([48],0),2) as Set28, round(isnull([49],0),2) as Set29, round(isnull([30],0),2) as Set50,\n\t   round(isnull([51],0),2) as Set21, round(isnull([52],0),2) as Set22, round(isnull([53],0),2) as Set23,\n\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) +\n\t   isnull([31],0) + isnull([32],0) + isnull([33],0) + isnull([34],0) + isnull([35],0) + isnull([36],0) + isnull([37],0) + isnull([38],0) + isnull([39],0) + isnull([40],0) +\n\t   isnull([41],0) + isnull([42],0) + isnull([43],0) + isnull([44],0) + isnull([45],0) + isnull([46],0) + isnull([47],0) + isnull([48],0) + isnull([49],0) + isnull([50],0) +\n\t   isnull([51],0) + isnull([52],0) + isnull([53],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.Anno = <anno> and a.Mese in (<mesi>)  and t.Reparto = 'TV' and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Settimana\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.TipoOrdine != 'Prenota e ritira' and a.Anno = <anno> and a.Mese in (<mesi>)  and t.Reparto = 'TV' and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Settimana\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Anno = <anno> and a.Mese in (<mesi>)  and t.Reparto = 'TV' and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Settimana\n) as ground\nPIVOT (\nsum(Importo)\nfor Settimana in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31],[32],[33],[34],[35],[36],[37],[38],[39],[40],[41],[42],[43],[44],[45],[46],[47],[48],[49],[50],[51],[52],[53])\n) as Layer1\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0007": "select Settore, Utente,\n       round(isnull([1] ,0),2) as GG01, round(isnull([2] ,0),2) as GG02, round(isnull([3] ,0),2) as GG03, round(isnull([4] ,0),2) as GG04, round(isnull([5] ,0),2) as GG05, round(isnull([6] ,0),2) as GG06, round(isnull([7] ,0),2) as GG07, round(isnull([8] ,0),2) as GG08, round(isnull([9] ,0),2) as GG09, round(isnull([10],0),2) as GG10,\n\t   round(isnull([11],0),2) as GG11, round(isnull([12],0),2) as GG12, round(isnull([13],0),2) as GG13, round(isnull([14],0),2) as GG14, round(isnull([15],0),2) as GG15, round(isnull([16],0),2) as GG16, round(isnull([17],0),2) as GG17, round(isnull([18],0),2) as GG18, round(isnull([19],0),2) as GG19, round(isnull([20],0),2) as GG20,\n\t   round(isnull([21],0),2) as GG21, round(isnull([22],0),2) as GG22, round(isnull([23],0),2) as GG23, round(isnull([24],0),2) as GG24, round(isnull([25],0),2) as GG25, round(isnull([26],0),2) as GG26, round(isnull([27],0),2) as GG27, round(isnull([28],0),2) as GG28, round(isnull([29],0),2) as GG29, round(isnull([30],0),2) as GG30,isnull([31],0) as GG31,\n       round(isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) + isnull([31],0),2) as TotaleMese\nfrom (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente, a.Giorno as Giorno, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.Mese = <mese> and a.Anno = <anno>  and t.Reparto = 'TV'  and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Giorno\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Giorno, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.TipoOrdine != 'Prenota e ritira' and a.Mese = <mese> and a.Anno = <anno>  and t.Reparto = 'TV' and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Giorno\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Giorno, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC in ('Punto Vendita','Web') and a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Mese = <mese> and a.Anno = <anno>  and t.Reparto = 'TV' and t.Banco not in ('', 'y Amministrazione')\ngroup by a.CdC, t.Banco, a.Giorno\n) as ground\nPIVOT (\nsum(Importo)\nfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as Layer1\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0008": "with sourcea as (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto =  1 and b.AnnoTrasporto = <anno> - 0),0)) as g01,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  2 and b.AnnoTrasporto = <anno> - 0),0)) as g02,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  3 and b.AnnoTrasporto = <anno> - 0),0)) as g03,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  4 and b.AnnoTrasporto = <anno> - 0),0)) as g04,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  5 and b.AnnoTrasporto = <anno> - 0),0)) as g05,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  6 and b.AnnoTrasporto = <anno> - 0),0)) as g06,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  7 and b.AnnoTrasporto = <anno> - 0),0)) as g07,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  8 and b.AnnoTrasporto = <anno> - 0),0)) as g08,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  9 and b.AnnoTrasporto = <anno> - 0),0)) as g09,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 10 and b.AnnoTrasporto = <anno> - 0),0)) as g10,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 11 and b.AnnoTrasporto = <anno> - 0),0)) as g11,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 12 and b.AnnoTrasporto = <anno> - 0),0)) as g12,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 13 and b.AnnoTrasporto = <anno> - 0),0)) as g13,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 14 and b.AnnoTrasporto = <anno> - 0),0)) as g14,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 15 and b.AnnoTrasporto = <anno> - 0),0)) as g15,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 16 and b.AnnoTrasporto = <anno> - 0),0)) as g16,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 17 and b.AnnoTrasporto = <anno> - 0),0)) as g17,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 18 and b.AnnoTrasporto = <anno> - 0),0)) as g18,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 19 and b.AnnoTrasporto = <anno> - 0),0)) as g19,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 20 and b.AnnoTrasporto = <anno> - 0),0)) as g20,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 21 and b.AnnoTrasporto = <anno> - 0),0)) as g21,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 22 and b.AnnoTrasporto = <anno> - 0),0)) as g22,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 23 and b.AnnoTrasporto = <anno> - 0),0)) as g23,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 24 and b.AnnoTrasporto = <anno> - 0),0)) as g24,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 25 and b.AnnoTrasporto = <anno> - 0),0)) as g25,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 26 and b.AnnoTrasporto = <anno> - 0),0)) as g26,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 27 and b.AnnoTrasporto = <anno> - 0),0)) as g27,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 28 and b.AnnoTrasporto = <anno> - 0),0)) as g28,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 29 and b.AnnoTrasporto = <anno> - 0),0)) as g29,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 30 and b.AnnoTrasporto = <anno> - 0),0)) as g30,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 31 and b.AnnoTrasporto = <anno> - 0),0)) as g31,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese>                            and b.AnnoTrasporto = <anno> - 0),0)) as m1\nfrom temp..StatCons a inner join temp..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC = 'Punto Vendita'\n) , sourceb as (\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto =  1 and b.AnnoTrasporto = <anno> - 0),0)) as g01,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  2 and b.AnnoTrasporto = <anno> - 0),0)) as g02,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  3 and b.AnnoTrasporto = <anno> - 0),0)) as g03,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  4 and b.AnnoTrasporto = <anno> - 0),0)) as g04,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  5 and b.AnnoTrasporto = <anno> - 0),0)) as g05,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  6 and b.AnnoTrasporto = <anno> - 0),0)) as g06,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  7 and b.AnnoTrasporto = <anno> - 0),0)) as g07,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  8 and b.AnnoTrasporto = <anno> - 0),0)) as g08,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  9 and b.AnnoTrasporto = <anno> - 0),0)) as g09,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 10 and b.AnnoTrasporto = <anno> - 0),0)) as g10,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 11 and b.AnnoTrasporto = <anno> - 0),0)) as g11,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 12 and b.AnnoTrasporto = <anno> - 0),0)) as g12,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 13 and b.AnnoTrasporto = <anno> - 0),0)) as g13,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 14 and b.AnnoTrasporto = <anno> - 0),0)) as g14,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 15 and b.AnnoTrasporto = <anno> - 0),0)) as g15,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 16 and b.AnnoTrasporto = <anno> - 0),0)) as g16,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 17 and b.AnnoTrasporto = <anno> - 0),0)) as g17,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 18 and b.AnnoTrasporto = <anno> - 0),0)) as g18,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 19 and b.AnnoTrasporto = <anno> - 0),0)) as g19,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 20 and b.AnnoTrasporto = <anno> - 0),0)) as g20,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 21 and b.AnnoTrasporto = <anno> - 0),0)) as g21,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 22 and b.AnnoTrasporto = <anno> - 0),0)) as g22,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 23 and b.AnnoTrasporto = <anno> - 0),0)) as g23,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 24 and b.AnnoTrasporto = <anno> - 0),0)) as g24,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 25 and b.AnnoTrasporto = <anno> - 0),0)) as g25,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 26 and b.AnnoTrasporto = <anno> - 0),0)) as g26,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 27 and b.AnnoTrasporto = <anno> - 0),0)) as g27,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 28 and b.AnnoTrasporto = <anno> - 0),0)) as g28,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 29 and b.AnnoTrasporto = <anno> - 0),0)) as g29,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 30 and b.AnnoTrasporto = <anno> - 0),0)) as g30,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 31 and b.AnnoTrasporto = <anno> - 0),0)) as g31,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAG01' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese>                            and b.AnnoTrasporto = <anno> - 0),0)) as m1\nfrom temp..StatCons a inner join temp..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC = 'Punto Vendita'\n)\nselect Settore, Utente,\n       cast(g01 as float) as Giorno01,\n       cast(g02 as float) as Giorno02,\n       cast(g03 as float) as Giorno03,\n       cast(g04 as float) as Giorno04,\n       cast(g05 as float) as Giorno05,\n       cast(g06 as float) as Giorno06,\n       cast(g07 as float) as Giorno07,\n       cast(g08 as float) as Giorno08,\n       cast(g09 as float) as Giorno09,\n       cast(g10 as float) as Giorno10,\n       cast(g11 as float) as Giorno11,\n       cast(g12 as float) as Giorno12,\n       cast(g13 as float) as Giorno13,\n       cast(g14 as float) as Giorno14,\n       cast(g15 as float) as Giorno15,\n       cast(g16 as float) as Giorno16,\n       cast(g17 as float) as Giorno17,\n       cast(g18 as float) as Giorno18,\n       cast(g19 as float) as Giorno19,\n       cast(g20 as float) as Giorno20,\n       cast(g21 as float) as Giorno21,\n       cast(g22 as float) as Giorno22,\n       cast(g23 as float) as Giorno23,\n       cast(g24 as float) as Giorno24,\n       cast(g25 as float) as Giorno25,\n       cast(g26 as float) as Giorno26,\n       cast(g27 as float) as Giorno27,\n       cast(g28 as float) as Giorno28,\n       cast(g29 as float) as Giorno29,\n       cast(g30 as float) as Giorno30,\n       cast(g31 as float) as Giorno31,\n       cast(m1  as float) as TotaleMese\nfrom sourcea\nunion\nselect Settore, Utente,\n       cast(g01 as float) as Giorno01,\n       cast(g02 as float) as Giorno02,\n       cast(g03 as float) as Giorno03,\n       cast(g04 as float) as Giorno04,\n       cast(g05 as float) as Giorno05,\n       cast(g06 as float) as Giorno06,\n       cast(g07 as float) as Giorno07,\n       cast(g08 as float) as Giorno08,\n       cast(g09 as float) as Giorno09,\n       cast(g10 as float) as Giorno10,\n       cast(g11 as float) as Giorno11,\n       cast(g12 as float) as Giorno12,\n       cast(g13 as float) as Giorno13,\n       cast(g14 as float) as Giorno14,\n       cast(g15 as float) as Giorno15,\n       cast(g16 as float) as Giorno16,\n       cast(g17 as float) as Giorno17,\n       cast(g18 as float) as Giorno18,\n       cast(g19 as float) as Giorno19,\n       cast(g20 as float) as Giorno20,\n       cast(g21 as float) as Giorno21,\n       cast(g22 as float) as Giorno22,\n       cast(g23 as float) as Giorno23,\n       cast(g24 as float) as Giorno24,\n       cast(g25 as float) as Giorno25,\n       cast(g26 as float) as Giorno26,\n       cast(g27 as float) as Giorno27,\n       cast(g28 as float) as Giorno28,\n       cast(g29 as float) as Giorno29,\n       cast(g30 as float) as Giorno30,\n       cast(g31 as float) as Giorno31,\n       cast(m1  as float) as TotaleMese\nfrom sourceb\n--where m1 != 0\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0009": "with foun as (\nselect distinct t.Banco,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAG01' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'LEGNO/PVC ') as LegnoPvc,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAG01' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'ALLUMINIO - FERRO') as AlluminioFerro,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAG01' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'PROD. FINITO') as ProdottoFinito,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAG01' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'UTENSILERIA') as Utensileria,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAG01' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'COMPLEMENTI') as Complementi,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAG01' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' ) as Totale\nfrom TEMP..StatCons s\n     left outer join TEMP..Tecnici t on s.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC = 'Punto Vendita' and InizioTrasporto >= '<fromdate>' and InizioTrasporto <= '<todate>' and t.Banco is not null and s.TipoOrdine != 'Prenota e ritira'\n)\nselect *,\ncase when totale > 0 then cast(cast(cast(LegnoPvc / Totale * 1000 as int) as float)       / 10 as nvarchar) + ' %' else '0 %' end as PercLegnoPvc,\ncase when totale > 0 then cast(cast(cast(AlluminioFerro / Totale * 1000 as int) as float) / 10 as nvarchar) + ' %' else '0 %' end as PercAlluminioFerro,\ncase when totale > 0 then cast(cast(cast(ProdottoFinito / Totale * 1000 as int) as float) / 10 as nvarchar) + ' %' else '0 %' end as PercProdottoFinito,\ncase when totale > 0 then cast(cast(cast(Utensileria / Totale * 1000 as int) as float)    / 10 as nvarchar) + ' %' else '0 %' end as PercUtensileria,\ncase when totale > 0 then cast(cast(cast(Complementi / Totale * 1000 as int) as float)    / 10 as nvarchar) + ' %' else '0 %' end as PercComplementi\nfrom foun\nunion select 'Totale', (select SUM(LegnoPvc) from foun), (select SUM(AlluminioFerro) from foun), (select SUM(ProdottoFinito) from foun), (select SUM(Utensileria) from foun), (select SUM(Complementi) from foun), (select SUM(Totale) from foun),\ncast(cast(cast((select SUM(LegnoPvc      ) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %',\ncast(cast(cast((select SUM(AlluminioFerro) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %',\ncast(cast(cast((select SUM(ProdottoFinito) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %',\ncast(cast(cast((select SUM(Utensileria   ) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %',\ncast(cast(cast((select SUM(Complementi   ) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %'",
    "pun0010": "with ground as (\nselect distinct a.CodiceAgente + ' - ' + a.NomeAgente as Agente, a.CodiceCliente, a.NomeCliente,\n       cast((select isnull(cast(sum(b.NettoRiga) as float),0) from temp..cons b where stats.dbo.InAnnoMobile(b.iniziotrasporto, -2) = 1 and b.codicecliente = a.CodiceCliente ) as decimal(19,2)) as ImponibileAMm2,\n       cast((select isnull(cast(sum(b.NettoRiga) as float),0) from temp..cons b where stats.dbo.InAnnoMobile(b.iniziotrasporto, -1) = 1 and b.codicecliente = a.CodiceCliente ) as decimal(19,2)) as ImponibileAMm1,\n       cast((select isnull(cast(sum(b.NettoRiga) as float),0) from temp..cons b where stats.dbo.InAnnoMobile(b.iniziotrasporto,  0) = 1 and b.codicecliente = a.CodiceCliente ) as decimal(19,2)) as ImponibileAM0,\n       cast((select isnull(cast(sum(b.NettoRiga) as float),0) from temp..cons b where b.AnnoTrasporto = year(GetDate())-2 and MeseTrasporto < month(GetDate()) and b.codicecliente = a.CodiceCliente ) as decimal(19,2)) as ImponibileDueAnniFaPrimiMesi,\n       cast((select isnull(cast(sum(b.NettoRiga) as float),0) from temp..cons b where b.AnnoTrasporto = year(GetDate())-1 and MeseTrasporto < month(GetDate()) and b.codicecliente = a.CodiceCliente ) as decimal(19,2)) as ImponibileAnnoScorsoPrimiMesi,\n       cast((select isnull(cast(sum(b.NettoRiga) as float),0) from temp..cons b where b.AnnoTrasporto = year(GetDate())-0 and MeseTrasporto < month(GetDate()) and b.codicecliente = a.CodiceCliente ) as decimal(19,2)) as ImponibileAnnoCorrentePrimiMesi\nfrom TEMP..StatCons a\nwhere a.InizioTrasporto >= year(getDate())-2 and a.CodiceAgente in ('A     4','A    67')\ngroup by a.CodiceCliente, a.NomeCliente, cast(a.AnnoTrasporto as nvarchar) + '|' + cast(a.MeseTrasporto as nvarchar), a.CodiceAgente + ' - ' + a.NomeAgente\n) select * from ground where ImponibileAM0 + ImponibileAMm1 + ImponibileAMm2 > 0",
    "pun0016": "select Settore, Utente,\n       round(isnull([1] ,0),2) as GG01, round(isnull([2] ,0),2) as GG02, round(isnull([3] ,0),2) as GG03, round(isnull([4] ,0),2) as GG04, round(isnull([5] ,0),2) as GG05, round(isnull([6] ,0),2) as GG06, round(isnull([7] ,0),2) as GG07, round(isnull([8] ,0),2) as GG08, round(isnull([9] ,0),2) as GG09, round(isnull([10],0),2) as GG10,\n\t   round(isnull([11],0),2) as GG11, round(isnull([12],0),2) as GG12, round(isnull([13],0),2) as GG13, round(isnull([14],0),2) as GG14, round(isnull([15],0),2) as GG15, round(isnull([16],0),2) as GG16, round(isnull([17],0),2) as GG17, round(isnull([18],0),2) as GG18, round(isnull([19],0),2) as GG19, round(isnull([20],0),2) as GG20,\n\t   round(isnull([21],0),2) as GG21, round(isnull([22],0),2) as GG22, round(isnull([23],0),2) as GG23, round(isnull([24],0),2) as GG24, round(isnull([25],0),2) as GG25, round(isnull([26],0),2) as GG26, round(isnull([27],0),2) as GG27, round(isnull([28],0),2) as GG28, round(isnull([29],0),2) as GG29, round(isnull([30],0),2) as GG30,isnull([31],0) as GG31,\n       round(isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) + isnull([31],0),2) as TotaleMese\nfrom (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente, a.GiornoTrasporto as Giorno, cast(sum(a.NettoRiga) as float) as Importo\nfrom temp..StatCons a inner join temp..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC = 'Punto Vendita' and a.MeseTrasporto = <mese> and a.AnnoTrasporto = <anno> and a.extra1 = 'MAG01' and a.DocTipo != 'DCV' and a.DocCreatore = a.OrigCreatore and a.InizioTrasporto = (select cast(DATADOC as date) from colfert..TESTEDOCUMENTI where progressivo = OrigProgressivo)\ngroup by a.CdC, t.Banco, a.GiornoTrasporto\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.GiornoTrasporto, cast(sum(a.NettoRiga) as float)\nfrom temp..StatCons a inner join temp..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC = 'Punto Vendita' and a.TipoOrdine != 'Prenota e ritira' and a.extra1 = 'MAG01' and a.MeseTrasporto = <mese> and a.AnnoTrasporto = <anno> and a.DocTipo != 'DCV' and a.DocCreatore = a.OrigCreatore and a.InizioTrasporto = (select cast(DATADOC as date) from colfert..TESTEDOCUMENTI where progressivo = OrigProgressivo)\ngroup by a.CdC, t.Banco, a.GiornoTrasporto\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.GiornoTrasporto, cast(sum(a.NettoRiga) as float)\nfrom temp..StatCons a inner join temp..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'tv'\nwhere CdC = 'Punto Vendita' and a.TipoOrdine = 'Prenota e ritira' and a.OrigCreatore = a.UtenteAssegnato and a.extra1 = 'MAG01' and a.MeseTrasporto = <mese> and a.AnnoTrasporto = <anno> and a.DocTipo != 'DCV' and a.DocCreatore = a.OrigCreatore and a.InizioTrasporto = (select cast(DATADOC as date) from colfert..TESTEDOCUMENTI where progressivo = OrigProgressivo)\ngroup by a.CdC, t.Banco, a.GiornoTrasporto\n) as ground\nPIVOT (\nsum(Importo)\nfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as Layer1\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0017": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Email,2) as Email, round(Telefonico,2) as Telefonico, round(InSede,2) as InSede, round(UfficiCommerciali,2) as UfficiComm, round(Agente,2) as Agente, round(Telefonico+UfficiCommerciali+InSede+Email+Agente,2) as Totale,\n       round(Email/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Mail%',\n\t   round(Telefonico/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Telefonico%',\n\t   round(InSede/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'InSede%',\n\t   round(UfficiCommerciali/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Uffici%',\n\t   round(Agente/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Agente%'\nfrom\n(\nselect Utente,\n\tisnull([TELEFONICO],0) as Telefonico, isnull([UFFICI COMMERCIALI],0) as UfficiCommerciali, isnull([IN SEDE],0) as InSede, isnull([EMAIL],0) as Email, isnull([AGENTE],0) as Agente\nfrom (\nselect u.Banco as Utente, f.Descrizione as TipoFonte, cast(sum(r.TOTNETTORIGAEURO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join temp..tecnici u on x.ND_UTECREAZ = u.Codice\n  inner join colfert..NDTabTipiFonte f on x.TipoFonte = f.Codice\nwhere r.TIPORIGA = 'n' and (t.tipodoc in ('DCB','SCB','FCA','FCV') ) and u.classe in ('Cassa', 'Punto Vendita') and u.Reparto = 'TV' and t.DATADOC between @dadata and @adata\ngroup by t.TIPODOC, f.Descrizione, x.ND_UTECREAZ, u.Banco\n) as pippa\nPIVOT (\nsum(Importo)\nfor TipoFonte in ([TELEFONICO],[UFFICI COMMERCIALI],[IN SEDE],[EMAIL],[AGENTE])\n) as Pippo\n) as ground\norder by 1",
    "pun0019": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Email,2), round(Telefonico,2), round(InSede,2), round(UfficiCommerciali,2), round(Agente,2), round(Telefonico+UfficiCommerciali+InSede+Email+Agente,2) as Totale,\n       round(Email/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Mail%',\n\t   round(Telefonico/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Telefonico%',\n\t   round(InSede/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'InSede%',\n\t   round(UfficiCommerciali/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Uffici%',\n\t   round(Agente/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Agente%'\nfrom\n(\nselect Utente,\n\tisnull([TELEFONICO],0) as Telefonico, isnull([UFFICI COMMERCIALI],0) as UfficiCommerciali, isnull([IN SEDE],0) as InSede, isnull([EMAIL],0) as Email, isnull([AGENTE],0) as Agente\nfrom (\nselect u.Banco as Utente, f.Descrizione as TipoFonte, cast(sum(r.TOTNETTORIGAEURO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join temp..tecnici u on x.ND_UTECREAZ = u.Codice\n  inner join colfert..NDTabTipiFonte f on x.TipoFonte = f.Codice\nwhere r.TIPORIGA = 'n' and (t.tipodoc in ('OCB','OCV','OCW') ) and u.classe in ('Cassa', 'Punto Vendita') and u.Reparto = 'TV' and t.DATADOC between @dadata and @adata\ngroup by t.TIPODOC, f.Descrizione, x.ND_UTECREAZ, u.Banco\n) as pippa\nPIVOT (\nsum(Importo)\nfor TipoFonte in ([TELEFONICO],[UFFICI COMMERCIALI],[IN SEDE],[EMAIL],[AGENTE])\n) as Pippo\n) as ground\norder by 1",
    "pun0018": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Email,2), round(Telefonico,2), round(InSede,2), round(UfficiCommerciali,2), round(Agente,2), round(Telefonico+UfficiCommerciali+InSede+Email+Agente,2) as Totale,\n       round(Email/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Mail%',\n\t   round(Telefonico/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Telefonico%',\n\t   round(InSede/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'InSede%',\n\t   round(UfficiCommerciali/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Uffici%',\n\t   round(Agente/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Agente%'\nfrom\n(\nselect Utente,\n\tisnull([TELEFONICO],0) as Telefonico, isnull([UFFICI COMMERCIALI],0) as UfficiCommerciali, isnull([IN SEDE],0) as InSede, isnull([EMAIL],0) as Email, isnull([AGENTE],0) as Agente\nfrom (\nselect u.Banco as Utente, f.Descrizione as TipoFonte, cast(sum(r.TOTNETTORIGAEURO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join temp..tecnici u on x.ND_UTECREAZ = u.Codice\n  inner join colfert..NDTabTipiFonte f on x.TipoFonte = f.Codice\nwhere r.TIPORIGA = 'n' and (t.tipodoc in ('DCB','SCB','FCA','FCV') ) and u.classe in ('Cassa', 'Punto Vendita') and u.Reparto = 'VA' and t.DATADOC between @dadata and @adata\ngroup by t.TIPODOC, f.Descrizione, x.ND_UTECREAZ, u.Banco\n) as pippa\nPIVOT (\nsum(Importo)\nfor TipoFonte in ([TELEFONICO],[UFFICI COMMERCIALI],[IN SEDE],[EMAIL],[AGENTE])\n) as Pippo\n) as ground\norder by 1",
    "pun0020": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, round(Email,2), round(Telefonico,2), round(InSede,2), round(UfficiCommerciali,2), round(Agente,2), round(Telefonico+UfficiCommerciali+InSede+Email+Agente,2) as Totale,\n       round(Email/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Mail%',\n\t   round(Telefonico/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Telefonico%',\n\t   round(InSede/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'InSede%',\n\t   round(UfficiCommerciali/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Uffici%',\n\t   round(Agente/(Telefonico+UfficiCommerciali+InSede+Email+Agente)*100,2) as 'Agente%'\nfrom\n(\nselect Utente,\n\tisnull([TELEFONICO],0) as Telefonico, isnull([UFFICI COMMERCIALI],0) as UfficiCommerciali, isnull([IN SEDE],0) as InSede, isnull([EMAIL],0) as Email, isnull([AGENTE],0) as Agente\nfrom (\nselect u.Banco as Utente, f.Descrizione as TipoFonte, cast(sum(r.TOTNETTORIGAEURO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join temp..tecnici u on x.ND_UTECREAZ = u.Codice\n  inner join colfert..NDTabTipiFonte f on x.TipoFonte = f.Codice\nwhere r.TIPORIGA = 'n' and (t.tipodoc in ('OCB','OCV','OCW') ) and u.classe in ('Cassa', 'Punto Vendita') and u.Reparto = 'VA' and t.DATADOC between @dadata and @adata\ngroup by t.TIPODOC, f.Descrizione, x.ND_UTECREAZ, u.Banco\n) as pippa\nPIVOT (\nsum(Importo)\nfor TipoFonte in ([TELEFONICO],[UFFICI COMMERCIALI],[IN SEDE],[EMAIL],[AGENTE])\n) as Pippo\n) as ground\norder by 1",
    "pun0021": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.CodiceFornitore, d.NomeFornitore, d.Categoria4, round(sum(d.TotRiga),2) as ConsegnatoPderiodo,\n  (select round(isnull(sum(a.TotRiga),0),2) from stats..acquistato a where a.CodiceCliente =  d.CodiceFornitore and a.Categoria4 = d.Categoria4 and a.DataDoc between @dadata and @adata) as AcquistatoPeriodo\nfrom stats..consegnato d\nwhere d.CodiceFornitore in ('F  9721','F 74841','F  9719','F     6','F    36','F    39','F    98','F   120','F   145','F   159','F   166','F   236','F   242','F   260','F   286','F   436','F   464','F   474','F   519','F   521','F   541','F   666','F   696','F   729','F   801','F   807','F   834','F   870','F   910','F   940','F  1012','F  1072','F  8390','F  8559','F  8631','F  8782','F  8837','F  8858','F  9707','F  8441','F   302','F  9688','F   337')\n  and d.DataDoc between @dadata and @adata\ngroup by d.CodiceFornitore, d.NomeFornitore, d.Categoria4\norder by 1,2,3",
    "pun0022": "select a.CODICE, stats.dbo.piclean(a.DESCRIZIONE) as Descrizione, isnull(dbo.ColGiacenza(a.codice),0) as GiacenzaTV, isnull(dbo.ColGiacenzaVa(a.codice),0) as GiacenzaVA,\ncast(isnull((select top 1 r.PREZZOUNITNETTO from RIGHEDOCUMENTI r where tipodoc like 'df%' and r.codart = a.CODICE and r.PREZZOUNITNETTO > 0 order by IDTESTA desc),0) as float) as UltimoPrezzoAcquisto\nfrom ANAGRAFICAARTICOLI a\n  inner join ANAGRAFICAARTICOLIPROD p on a.codice = p.CODICEART and p.esercizio = 2022\nwhere p.FORNPREFACQ = '<cardcode>'\norder by 1",
    "pun0023": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.NomeUtente, d.UtenteNegozio, count(distinct d.progressivo) as ContoTotalePreventivi,\n  (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') as ContoPreventiviPuri,\n  (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 like 'o%') as ContoPreventiviRealizzati,\n  case when (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') != 0\n  then\n    round(cast((select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 like 'o%') as float) /\n    cast((select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') as float) * 100, 1)\n  else 0\n  end\n  as PercentualeRealizzazione\nfrom stats..preventivato d\nwhere d.datadoc >= @dadata and d.datadoc <= @adata\n  and d.Cdc = 'Punto Vendita' and d.SedeUtente = 'TV'\ngroup by d.NomeUtente, d.UtenteNegozio\norder by 2,1",
    "pun0024": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.NomeUtente, d.UtenteNegozio, count(distinct d.progressivo) as ContoTotalePreventivi,\n  (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') as ContoPreventiviPuri,\n  (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 like 'o%') as ContoPreventiviRealizzati,\n  case when (select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') != 0\n  then\n    round(cast((select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 like 'o%') as float) /\n    cast((select count(distinct a.progressivo) from stats..preventivato a where a.datadoc >= @dadata and a.datadoc <= @adata and a.NomeUtente = d.NomeUtente and a.Cdc = 'Punto Vendita' and a.DExtra0 not like 'p%') as float) * 100, 1)\n  else 0\n  end\n  as PercentualeRealizzazione\nfrom stats..preventivato d\nwhere d.datadoc >= @dadata and d.datadoc <= @adata\n  and d.Cdc = 'Punto Vendita' and d.SedeUtente = 'VA'\ngroup by d.NomeUtente, d.UtenteNegozio\norder by 2,1",
    "pun0025": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect TipoDoc, NumeroDoc, CodiceAgente, NomeAgente, Sede, CodiceCliente, RagioneSociale, Anno, Mese, Giorno, DataDoc, Articolo, Stats.dbo.piClean(Descrizione) as Descrizione, Stats.dbo.piClean(DescExtra) as DescrizioneExtra, UM, Quantita, PrezzoUnitLordo, Sconto, ScontoEsteso, PrezzoUnitNetto, TotRiga, CostoUltimoUnit, CostoUltimoTot, CodiceFornitore, NomeFornitore\nfrom stats..consegnato\nwhere DataDoc between @dadata AND @adata and CodiceFornitore = '<cardcode>'",
    "pun0011": "select Settore, Utente,\n       round(isnull([1] ,0),2) as Gennaio, round(isnull([2] ,0),2) as Febbraio, round(isnull([3] ,0),2) as Marzo    , round(isnull([4] ,0),2) as Aprile , round(isnull([5] ,0),2) as Maggio  , round(isnull([6] ,0),2) as Giugno,\n\t   round(isnull([7] ,0),2) as Luglio , round(isnull([8] ,0),2) as Agosto  , round(isnull([9] ,0),2) as Settembre, round(isnull([10],0),2) as Ottobre, round(isnull([11],0),2) as Novembre, round(isnull([12],0),2) as Dicembre,\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.Anno = <anno> and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Mese\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.TipoOrdine != 'Prenota e ritira' and a.Anno = <anno> and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Mese\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Mese, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Anno = <anno> and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Mese\n) as ground\nPIVOT (\nsum(Importo)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Layer1\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0012": "select Settore, Utente,\n       round(isnull([1] ,0),2) as Set01, round(isnull([2] ,0),2) as Set02, round(isnull([3] ,0),2) as Set03, round(isnull([4] ,0),2) as Set04, round(isnull([5] ,0),2) as Set05, round(isnull([6] ,0),2) as Set06, round(isnull([7] ,0),2) as Set07, round(isnull([8] ,0),2) as Set08, round(isnull([9] ,0),2) as Set09, round(isnull([10],0),2) as Set10,\n\t   round(isnull([11],0),2) as Set11, round(isnull([12],0),2) as Set12, round(isnull([13],0),2) as Set13, round(isnull([14],0),2) as Set14, round(isnull([15],0),2) as Set15, round(isnull([16],0),2) as Set16, round(isnull([17],0),2) as Set17, round(isnull([18],0),2) as Set18, round(isnull([19],0),2) as Set19, round(isnull([20],0),2) as Set20,\n\t   round(isnull([21],0),2) as Set21, round(isnull([22],0),2) as Set22, round(isnull([23],0),2) as Set23, round(isnull([24],0),2) as Set24, round(isnull([25],0),2) as Set25, round(isnull([26],0),2) as Set26, round(isnull([27],0),2) as Set27, round(isnull([28],0),2) as Set28, round(isnull([29],0),2) as Set29, round(isnull([30],0),2) as Set30,\n\t   round(isnull([31],0),2) as Set21, round(isnull([32],0),2) as Set22, round(isnull([33],0),2) as Set23, round(isnull([34],0),2) as Set24, round(isnull([35],0),2) as Set25, round(isnull([36],0),2) as Set26, round(isnull([37],0),2) as Set27, round(isnull([38],0),2) as Set28, round(isnull([39],0),2) as Set29, round(isnull([30],0),2) as Set40,\n\t   round(isnull([41],0),2) as Set21, round(isnull([42],0),2) as Set22, round(isnull([43],0),2) as Set23, round(isnull([44],0),2) as Set24, round(isnull([45],0),2) as Set25, round(isnull([46],0),2) as Set26, round(isnull([47],0),2) as Set27, round(isnull([48],0),2) as Set28, round(isnull([49],0),2) as Set29, round(isnull([30],0),2) as Set50,\n\t   round(isnull([51],0),2) as Set21, round(isnull([52],0),2) as Set22, round(isnull([53],0),2) as Set23,\n\n       round(\n\t   isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) +\n\t   isnull([31],0) + isnull([32],0) + isnull([33],0) + isnull([34],0) + isnull([35],0) + isnull([36],0) + isnull([37],0) + isnull([38],0) + isnull([39],0) + isnull([40],0) +\n\t   isnull([41],0) + isnull([42],0) + isnull([43],0) + isnull([44],0) + isnull([45],0) + isnull([46],0) + isnull([47],0) + isnull([48],0) + isnull([49],0) + isnull([50],0) +\n\t   isnull([51],0) + isnull([52],0) + isnull([53],0)\n\t   ,2) as TotaleAnno\nfrom (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.Anno = <anno> and a.Mese in (<mesi>) and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Settimana\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.TipoOrdine != 'Prenota e ritira' and a.Anno = <anno> and a.Mese in (<mesi>) and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Settimana\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Settimana, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Anno = <anno> and a.Mese in (<mesi>) and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Settimana\n) as ground\nPIVOT (\nsum(Importo)\nfor Settimana in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31],[32],[33],[34],[35],[36],[37],[38],[39],[40],[41],[42],[43],[44],[45],[46],[47],[48],[49],[50],[51],[52],[53])\n) as Layer1\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0013": "select Settore, Utente,\n       round(isnull([1] ,0),2) as GG01, round(isnull([2] ,0),2) as GG02, round(isnull([3] ,0),2) as GG03, round(isnull([4] ,0),2) as GG04, round(isnull([5] ,0),2) as GG05, round(isnull([6] ,0),2) as GG06, round(isnull([7] ,0),2) as GG07, round(isnull([8] ,0),2) as GG08, round(isnull([9] ,0),2) as GG09, round(isnull([10],0),2) as GG10,\n\t   round(isnull([11],0),2) as GG11, round(isnull([12],0),2) as GG12, round(isnull([13],0),2) as GG13, round(isnull([14],0),2) as GG14, round(isnull([15],0),2) as GG15, round(isnull([16],0),2) as GG16, round(isnull([17],0),2) as GG17, round(isnull([18],0),2) as GG18, round(isnull([19],0),2) as GG19, round(isnull([20],0),2) as GG20,\n\t   round(isnull([21],0),2) as GG21, round(isnull([22],0),2) as GG22, round(isnull([23],0),2) as GG23, round(isnull([24],0),2) as GG24, round(isnull([25],0),2) as GG25, round(isnull([26],0),2) as GG26, round(isnull([27],0),2) as GG27, round(isnull([28],0),2) as GG28, round(isnull([29],0),2) as GG29, round(isnull([30],0),2) as GG30,isnull([31],0) as GG31,\n       round(isnull([1],0)  + isnull([2],0)  + isnull([3],0)  + isnull([4],0)  + isnull([5],0)  + isnull([6],0)  + isnull([7],0)  + isnull([8],0)  + isnull([9],0)  + isnull([10],0) +\n\t   isnull([11],0) + isnull([12],0) + isnull([13],0) + isnull([14],0) + isnull([15],0) + isnull([16],0) + isnull([17],0) + isnull([18],0) + isnull([19],0) + isnull([20],0) +\n\t   isnull([21],0) + isnull([22],0) + isnull([23],0) + isnull([24],0) + isnull([25],0) + isnull([26],0) + isnull([27],0) + isnull([28],0) + isnull([29],0) + isnull([30],0) + isnull([31],0),2) as TotaleMese\nfrom (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente, a.Giorno as Giorno, cast(sum(a.TotRiga) as float) as Importo\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.Mese = <mese> and a.Anno = <anno> and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Giorno\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Giorno, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.TipoOrdine != 'Prenota e ritira' and a.Mese = <mese> and a.Anno = <anno> and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Giorno\nunion\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente, a.Giorno, cast(sum(a.TotRiga) as float)\nfrom Stats..consegnato a inner join stats..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and a.TipoOrdine = 'Prenota e ritira' and a.CreatoreOrd = a.UtenteAssegnato and a.Mese = <mese> and a.Anno = <anno> and t.Reparto = 'VA'\ngroup by a.CdC, t.Banco, a.Giorno\n) as ground\nPIVOT (\nsum(Importo)\nfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as Layer1\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0014": "with sourcea as (\nselect distinct a.CdC as Settore, '3cpr - ' + t.Banco as Utente,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto =  1 and b.AnnoTrasporto = <anno> - 0),0)) as g01,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  2 and b.AnnoTrasporto = <anno> - 0),0)) as g02,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  3 and b.AnnoTrasporto = <anno> - 0),0)) as g03,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  4 and b.AnnoTrasporto = <anno> - 0),0)) as g04,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  5 and b.AnnoTrasporto = <anno> - 0),0)) as g05,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  6 and b.AnnoTrasporto = <anno> - 0),0)) as g06,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  7 and b.AnnoTrasporto = <anno> - 0),0)) as g07,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  8 and b.AnnoTrasporto = <anno> - 0),0)) as g08,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  9 and b.AnnoTrasporto = <anno> - 0),0)) as g09,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 10 and b.AnnoTrasporto = <anno> - 0),0)) as g10,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 11 and b.AnnoTrasporto = <anno> - 0),0)) as g11,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 12 and b.AnnoTrasporto = <anno> - 0),0)) as g12,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 13 and b.AnnoTrasporto = <anno> - 0),0)) as g13,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 14 and b.AnnoTrasporto = <anno> - 0),0)) as g14,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 15 and b.AnnoTrasporto = <anno> - 0),0)) as g15,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 16 and b.AnnoTrasporto = <anno> - 0),0)) as g16,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 17 and b.AnnoTrasporto = <anno> - 0),0)) as g17,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 18 and b.AnnoTrasporto = <anno> - 0),0)) as g18,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 19 and b.AnnoTrasporto = <anno> - 0),0)) as g19,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 20 and b.AnnoTrasporto = <anno> - 0),0)) as g20,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 21 and b.AnnoTrasporto = <anno> - 0),0)) as g21,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 22 and b.AnnoTrasporto = <anno> - 0),0)) as g22,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 23 and b.AnnoTrasporto = <anno> - 0),0)) as g23,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 24 and b.AnnoTrasporto = <anno> - 0),0)) as g24,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 25 and b.AnnoTrasporto = <anno> - 0),0)) as g25,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 26 and b.AnnoTrasporto = <anno> - 0),0)) as g26,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 27 and b.AnnoTrasporto = <anno> - 0),0)) as g27,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 28 and b.AnnoTrasporto = <anno> - 0),0)) as g28,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 29 and b.AnnoTrasporto = <anno> - 0),0)) as g29,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 30 and b.AnnoTrasporto = <anno> - 0),0)) as g30,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 31 and b.AnnoTrasporto = <anno> - 0),0)) as g31,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese>                            and b.AnnoTrasporto = <anno> - 0),0)) as m1\nfrom temp..StatCons a inner join temp..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita'\n) , sourceb as (\nselect distinct a.CdC as Settore, '1spr - ' + t.Banco as Utente,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto =  1 and b.AnnoTrasporto = <anno> - 0),0)) as g01,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  2 and b.AnnoTrasporto = <anno> - 0),0)) as g02,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  3 and b.AnnoTrasporto = <anno> - 0),0)) as g03,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  4 and b.AnnoTrasporto = <anno> - 0),0)) as g04,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  5 and b.AnnoTrasporto = <anno> - 0),0)) as g05,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  6 and b.AnnoTrasporto = <anno> - 0),0)) as g06,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  7 and b.AnnoTrasporto = <anno> - 0),0)) as g07,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  8 and b.AnnoTrasporto = <anno> - 0),0)) as g08,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto =  9 and b.AnnoTrasporto = <anno> - 0),0)) as g09,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 10 and b.AnnoTrasporto = <anno> - 0),0)) as g10,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 11 and b.AnnoTrasporto = <anno> - 0),0)) as g11,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 12 and b.AnnoTrasporto = <anno> - 0),0)) as g12,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 13 and b.AnnoTrasporto = <anno> - 0),0)) as g13,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 14 and b.AnnoTrasporto = <anno> - 0),0)) as g14,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 15 and b.AnnoTrasporto = <anno> - 0),0)) as g15,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 16 and b.AnnoTrasporto = <anno> - 0),0)) as g16,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 17 and b.AnnoTrasporto = <anno> - 0),0)) as g17,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 18 and b.AnnoTrasporto = <anno> - 0),0)) as g18,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 19 and b.AnnoTrasporto = <anno> - 0),0)) as g19,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 20 and b.AnnoTrasporto = <anno> - 0),0)) as g20,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 21 and b.AnnoTrasporto = <anno> - 0),0)) as g21,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 22 and b.AnnoTrasporto = <anno> - 0),0)) as g22,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 23 and b.AnnoTrasporto = <anno> - 0),0)) as g23,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 24 and b.AnnoTrasporto = <anno> - 0),0)) as g24,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 25 and b.AnnoTrasporto = <anno> - 0),0)) as g25,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 26 and b.AnnoTrasporto = <anno> - 0),0)) as g26,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 27 and b.AnnoTrasporto = <anno> - 0),0)) as g27,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 28 and b.AnnoTrasporto = <anno> - 0),0)) as g28,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 29 and b.AnnoTrasporto = <anno> - 0),0)) as g29,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.Mesetrasporto = <mese> and b.GiornoTrasporto = 30 and b.AnnoTrasporto = <anno> - 0),0)) as g30,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese> and b.GiornoTrasporto = 31 and b.AnnoTrasporto = <anno> - 0),0)) as g31,\n(isnull((select sum (NettoRiga) from temp..StatCons b inner join temp..Tecnici s on b.UtenteAssegnato = s.Codice where b.CdC = a.CdC and b.TipoOrdine != 'Prenota e ritira' and s.Banco = t.Banco and b.extra1 = 'MAGVA' and b.DocTipo in ('srb', 'rcb','rcd','rca') and b.MeseTrasporto = <mese>                            and b.AnnoTrasporto = <anno> - 0),0)) as m1\nfrom temp..StatCons a inner join temp..Tecnici t on a.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita'\n)\nselect Settore, Utente,\n       cast(g01 as float) as Giorno01,\n       cast(g02 as float) as Giorno02,\n       cast(g03 as float) as Giorno03,\n       cast(g04 as float) as Giorno04,\n       cast(g05 as float) as Giorno05,\n       cast(g06 as float) as Giorno06,\n       cast(g07 as float) as Giorno07,\n       cast(g08 as float) as Giorno08,\n       cast(g09 as float) as Giorno09,\n       cast(g10 as float) as Giorno10,\n       cast(g11 as float) as Giorno11,\n       cast(g12 as float) as Giorno12,\n       cast(g13 as float) as Giorno13,\n       cast(g14 as float) as Giorno14,\n       cast(g15 as float) as Giorno15,\n       cast(g16 as float) as Giorno16,\n       cast(g17 as float) as Giorno17,\n       cast(g18 as float) as Giorno18,\n       cast(g19 as float) as Giorno19,\n       cast(g20 as float) as Giorno20,\n       cast(g21 as float) as Giorno21,\n       cast(g22 as float) as Giorno22,\n       cast(g23 as float) as Giorno23,\n       cast(g24 as float) as Giorno24,\n       cast(g25 as float) as Giorno25,\n       cast(g26 as float) as Giorno26,\n       cast(g27 as float) as Giorno27,\n       cast(g28 as float) as Giorno28,\n       cast(g29 as float) as Giorno29,\n       cast(g30 as float) as Giorno30,\n       cast(g31 as float) as Giorno31,\n       cast(m1  as float) as TotaleMese\nfrom sourcea\nunion\nselect Settore, Utente,\n       cast(g01 as float) as Giorno01,\n       cast(g02 as float) as Giorno02,\n       cast(g03 as float) as Giorno03,\n       cast(g04 as float) as Giorno04,\n       cast(g05 as float) as Giorno05,\n       cast(g06 as float) as Giorno06,\n       cast(g07 as float) as Giorno07,\n       cast(g08 as float) as Giorno08,\n       cast(g09 as float) as Giorno09,\n       cast(g10 as float) as Giorno10,\n       cast(g11 as float) as Giorno11,\n       cast(g12 as float) as Giorno12,\n       cast(g13 as float) as Giorno13,\n       cast(g14 as float) as Giorno14,\n       cast(g15 as float) as Giorno15,\n       cast(g16 as float) as Giorno16,\n       cast(g17 as float) as Giorno17,\n       cast(g18 as float) as Giorno18,\n       cast(g19 as float) as Giorno19,\n       cast(g20 as float) as Giorno20,\n       cast(g21 as float) as Giorno21,\n       cast(g22 as float) as Giorno22,\n       cast(g23 as float) as Giorno23,\n       cast(g24 as float) as Giorno24,\n       cast(g25 as float) as Giorno25,\n       cast(g26 as float) as Giorno26,\n       cast(g27 as float) as Giorno27,\n       cast(g28 as float) as Giorno28,\n       cast(g29 as float) as Giorno29,\n       cast(g30 as float) as Giorno30,\n       cast(g31 as float) as Giorno31,\n       cast(m1  as float) as TotaleMese\nfrom sourceb\n--where m1 != 0\nunion select 'Punto Vendita','2----------',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\norder by 1,2",
    "pun0015": "with foun as (\nselect distinct t.Banco,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAGVA' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'LEGNO/PVC ') as LegnoPvc,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAGVA' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'ALLUMINIO - FERRO') as AlluminioFerro,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAGVA' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'PROD. FINITO') as ProdottoFinito,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAGVA' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'UTENSILERIA') as Utensileria,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAGVA' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' and f.CategoriaFornitore = 'COMPLEMENTI') as Complementi,\n(select cast(isnull(SUM(f.NettoRiga),0) as float) from TEMP..StatCons f left outer join TEMP..Tecnici u on f.UtenteAssegnato = u.Codice where u.Banco = t.Banco and f.extra1 = 'MAGVA' and f.InizioTrasporto >= '<fromdate>' and f.InizioTrasporto <= '<todate>' and CdC = 'Punto Vendita' and f.TipoOrdine != 'Prenota e ritira' ) as Totale\nfrom TEMP..StatCons s\n     left outer join TEMP..Tecnici t on s.UtenteAssegnato = t.Codice and t.reparto = 'va'\nwhere CdC = 'Punto Vendita' and InizioTrasporto >= '<fromdate>' and InizioTrasporto <= '<todate>' and t.Banco is not null and s.TipoOrdine != 'Prenota e ritira'\n)\nselect *,\ncase when totale > 0 then cast(cast(cast(LegnoPvc / Totale * 1000 as int) as float)       / 10 as nvarchar) + ' %' else '0 %' end as PercLegnoPvc,\ncase when totale > 0 then cast(cast(cast(AlluminioFerro / Totale * 1000 as int) as float) / 10 as nvarchar) + ' %' else '0 %' end as PercAlluminioFerro,\ncase when totale > 0 then cast(cast(cast(ProdottoFinito / Totale * 1000 as int) as float) / 10 as nvarchar) + ' %' else '0 %' end as PercProdottoFinito,\ncase when totale > 0 then cast(cast(cast(Utensileria / Totale * 1000 as int) as float)    / 10 as nvarchar) + ' %' else '0 %' end as PercUtensileria,\ncase when totale > 0 then cast(cast(cast(Complementi / Totale * 1000 as int) as float)    / 10 as nvarchar) + ' %' else '0 %' end as PercComplementi\nfrom foun\nunion select 'Totale', (select SUM(LegnoPvc) from foun), (select SUM(AlluminioFerro) from foun), (select SUM(ProdottoFinito) from foun), (select SUM(Utensileria) from foun), (select SUM(Complementi) from foun), (select SUM(Totale) from foun),\ncast(cast(cast((select SUM(LegnoPvc      ) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %',\ncast(cast(cast((select SUM(AlluminioFerro) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %',\ncast(cast(cast((select SUM(ProdottoFinito) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %',\ncast(cast(cast((select SUM(Utensileria   ) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %',\ncast(cast(cast((select SUM(Complementi   ) from foun) / (select SUM(Totale) from foun) * 1000 as int) as float) / 10 as nvarchar) + ' %'",
    "ute0001": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect c.Codice as CodiceFornitore, c.RagioneSociale as NomeFornitore,\n  (select round(isnull(sum(d.TotRiga),0),2) from stats..consegnato d where d.CodiceFornitore = c.Codice and d.DataDoc between @dadata and @adata) as ConsegnatoPeriodo,\n  (select round(isnull(sum(d.TotRiga),0),2) from stats..acquistato d where d.CodiceCliente = c.Codice and d.DataDoc between @dadata and @adata) as AcquistatoPeriodo\nfrom stats..clis c left outer join stats..arts a on c.Codice = a.CodiceFornitore\nwhere c.Codice in ('F  9721','F 74841','F  9719','F     6','F    36','F    39','F    98','F   100','F   120','F   145','F   159','F   166','F   236','F   242','F   260','F   286','F   436','F   464','F   474','F   519','F   521','F   541','F   666','F   696','F   729','F   801','F   807','F   834','F   870','F   910','F   940','F  1012','F  1072','F  8390','F  8559','F  8631','F  8782','F  8837','F  8858','F  9707','F  8441','F   302','F  9688','F   337','F  9732','F  9733','F  9734','F   191','F   338','F   474')\ngroup by c.Codice, c.RagioneSociale\norder by 1,3",
    "ute0002": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect a.CODICE, stats.dbo.piclean(a.DESCRIZIONE) as Descrizione, a.DescrEstesa, isnull(colfert.dbo.ColGiacenza(a.codice),0) as GiacenzaTV, isnull(colfert.dbo.ColGiacenzaVa(a.codice),0) as GiacenzaVA,\n  cast(isnull((select top 1 r.PREZZOUNITNETTO from colfert..RIGHEDOCUMENTI r where tipodoc like 'df%' and r.codart = a.CODICE and r.PREZZOUNITNETTO > 0 order by IDTESTA desc),0) as float) as UltimoPrezzoAcquisto,\n  (select round(isnull(sum(totriga),0 ),2) from stats..consegnato d where d.articolo = a.codice and d.datadoc >= @dadata and d.datadoc <= @adata) as VendutoPeriodo,\n  (select round(isnull(sum(quantita),0),2) from stats..consegnato d where d.articolo = a.codice and d.datadoc >= @dadata and d.datadoc <= @adata) as QtaVendutaPeriodo,\n  (select round(isnull(sum(totriga),0) / isnull(sum(quantita),1),2) from stats..consegnato d where d.articolo = a.codice and d.datadoc >= @dadata and d.datadoc <= @adata) as PrezzoMedioPeriodo,\n  x.TipoGestione, x.TipoGestioneAlbert as TipoGestioneTV, x.TipoGestioneVarese, x.Web\nfrom colfert..ANAGRAFICAARTICOLI a\n  inner join colfert..ANAGRAFICAARTICOLIPROD p on a.codice = p.CODICEART and p.esercizio = 2022\n  inner join colfert..extramag x on a.codice = x.CODART\nwhere p.FORNPREFACQ = '<cardcode>'\norder by 1",
    "ute0003": "select distinct c.CodiceFornitore, c.NomeFornitore,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-0),0) as Spedito<anno-0>TV,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-1 and InizioTrasporto <= DATEADD(year,-1,Getdate())),0 ) as Spedito<anno-1>TV,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-2 and InizioTrasporto <= DATEADD(year,-2,Getdate())),0 ) as Spedito<anno-2>TV,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-3 and InizioTrasporto <= DATEADD(year,-3,Getdate())),0 ) as Spedito<anno-3>TV,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-4 and InizioTrasporto <= DATEADD(year,-4,Getdate())),0 ) as Spedito<anno-4>TV,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-5 and InizioTrasporto <= DATEADD(year,-5,Getdate())),0 ) as Spedito<anno-5>TV,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-0),0) as CostoVenduto<anno-0>TV,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-1 and InizioTrasporto <= DATEADD(year,-1,Getdate())),0 ) as CostoVenduto<anno-1>TV,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-2 and InizioTrasporto <= DATEADD(year,-2,Getdate())),0 ) as CostoVenduto<anno-2>TV,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-3 and InizioTrasporto <= DATEADD(year,-3,Getdate())),0 ) as CostoVenduto<anno-3>TV,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-4 and InizioTrasporto <= DATEADD(year,-4,Getdate())),0 ) as CostoVenduto<anno-4>TV,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAG01' and AnnoTrasporto = <anno>-5 and InizioTrasporto <= DATEADD(year,-5,Getdate())),0 ) as CostoVenduto<anno-5>TV,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-0),0) as Spedito<anno-0>VA,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-1 and InizioTrasporto <= DATEADD(year,-1,Getdate())),0 ) as Spedito<anno-1>VA,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-2 and InizioTrasporto <= DATEADD(year,-2,Getdate())),0 ) as Spedito<anno-2>VA,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-3 and InizioTrasporto <= DATEADD(year,-3,Getdate())),0 ) as Spedito<anno-3>VA,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-4 and InizioTrasporto <= DATEADD(year,-4,Getdate())),0 ) as Spedito<anno-4>VA,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-5 and InizioTrasporto <= DATEADD(year,-5,Getdate())),0 ) as Spedito<anno-5>VA,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-0),0) as CostoVenduto<anno-0>VA,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-1 and InizioTrasporto <= DATEADD(year,-1,Getdate())),0 ) as CostoVenduto<anno-1>VA,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-2 and InizioTrasporto <= DATEADD(year,-2,Getdate())),0 ) as CostoVenduto<anno-2>VA,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-3 and InizioTrasporto <= DATEADD(year,-3,Getdate())),0 ) as CostoVenduto<anno-3>VA,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-4 and InizioTrasporto <= DATEADD(year,-4,Getdate())),0 ) as CostoVenduto<anno-4>VA,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and extra1 = 'MAGVA' and AnnoTrasporto = <anno>-5 and InizioTrasporto <= DATEADD(year,-5,Getdate())),0 ) as CostoVenduto<anno-5>VA,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-0 ),0) as Ricevimenti<anno-0>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-1 and t.DATADOC <= DATEADD(year,-1,Getdate())),0) as Ricevimenti<anno-1>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-2 and t.DATADOC <= DATEADD(year,-2,Getdate())),0) as Ricevimenti<anno-2>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-3 and t.DATADOC <= DATEADD(year,-3,Getdate())),0) as Ricevimenti<anno-3>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-4 and t.DATADOC <= DATEADD(year,-4,Getdate())),0) as Ricevimenti<anno-4>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-5 and t.DATADOC <= DATEADD(year,-5,Getdate())),0) as Ricevimenti<anno-5>\nfrom temp..StatCons c\nwhere c.CodiceFornitore in ('F  9721','F 74841','F  9719','F     6','F    36','F    39','F    98','F   100','F   120','F   145','F   159','F   166','F   236','F   242','F   260','F   286','F   436','F   464','F   338','F   191','F   474','F   519','F   521','F   541','F   666','F   696','F   729','F   801','F   807','F   834','F   870','F   910','F   940','F  1012','F  1072','F  8390','F  8559','F  8631','F  8782','F  8837','F  8858','F  9707','F  8622','F   302','F  9688','F  9720','F  9721','F  8557','F   707','F    11','F   392','F   747','F   337')\n  and c.Categoria4 != 'SPAX'\norder by 1",
    "ute0004": "select distinct c.CodiceFornitore, c.NomeFornitore,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-0 ),0 ) as Spedito<anno-0>,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-1 ),0 ) as Spedito<anno-1>,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-2 ),0 ) as Spedito<anno-2>,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-3 ),0 ) as Spedito<anno-3>,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-4 ),0 ) as Spedito<anno-4>,\nisnull(( select cast(sum(d.NettoRiga     ) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-5 ),0 ) as Spedito<anno-5>,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-0 ),0 ) as CostoVenduto<anno-0>,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-1 ),0 ) as CostoVenduto<anno-1>,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-2 ),0 ) as CostoVenduto<anno-2>,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-3 ),0 ) as CostoVenduto<anno-3>,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-4 ),0 ) as CostoVenduto<anno-4>,\nisnull(( select cast(sum(d.CostoUltimoTot) as float) from temp..StatCons d where d.CodiceFornitore = c.CodiceFornitore and AnnoTrasporto = <anno>-5 ),0 ) as CostoVenduto<anno-5>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-0 ),0) as Ricevimenti<anno-0>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-1 ),0) as Ricevimenti<anno-1>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-2 ),0) as Ricevimenti<anno-2>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-3 ),0) as Ricevimenti<anno-3>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-4 ),0) as Ricevimenti<anno-4>,\nisnull(( select cast(sum(r.TOTNETTORIGA  ) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.CODCLIFOR = c.CodiceFornitore and t.TIPODOC in ('DFA','DFD','DFB','DFR') and r.CODART not in ('0011','0012','0013','0014','0015') and t.Esercizio = <anno>-5 ),0) as Ricevimenti<anno-5>\nfrom temp..StatCons c\nwhere c.CodiceFornitore in ('F  9721','F 74841','F  9719','F     6','F    36','F    39','F    98','F   100','F   120','F   145','F   159','F   166','F   236','F   242','F   260','F   286','F   436','F   464','F   338','F   191','F   474','F   519','F   521','F   541','F   666','F   696','F   729','F   801','F   807','F   834','F   870','F   910','F   940','F  1012','F  1072','F  8390','F  8559','F  8631','F  8782','F  8837','F  8858','F  9707','F  8622','F   302','F  9688','F  9720','F  9721','F  8557','F   707','F    11','F   392','F   747','F   337')\n  and c.Categoria4 != 'SPAX'\norder by 1",
    "ute0005": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect c.Codice, c.RagioneSociale,\n  isnull(v0.Venduto,0) as Spedito2024,\n  isnull(v1.Venduto,0) as Spedito2023,\n  isnull(v2.Venduto,0) as Spedito2022,\n  isnull(v3.Venduto,0) as Spedito2021,\n  isnull(v4.Venduto,0) as Spedito2020,\n  isnull(v5.Venduto,0) as Spedito2019,\n  isnull(v0.CostoRelativo,0) as CostoVenduto2024,\n  isnull(v1.CostoRelativo,0) as CostoVenduto2023,\n  isnull(v2.CostoRelativo,0) as CostoVenduto2022,\n  isnull(v3.CostoRelativo,0) as CostoVenduto2021,\n  isnull(v4.CostoRelativo,0) as CostoVenduto2020,\n  isnull(v5.CostoRelativo,0) as CostoVenduto2019,\n  isnull(s0.ScontoMedio,0) as ScontoMedio2024,\n  isnull(s1.ScontoMedio,0) as ScontoMedio2023,\n  isnull(s2.ScontoMedio,0) as ScontoMedio2022,\n  isnull(s3.ScontoMedio,0) as ScontoMedio2021,\n  isnull(s4.ScontoMedio,0) as ScontoMedio2020,\n  isnull(s5.ScontoMedio,0) as ScontoMedio2019,\n  isnull(a0.Acquistato,0) as Ricevimenti2024,\n  isnull(a1.Acquistato,0) as Ricevimenti2023,\n  isnull(a2.Acquistato,0) as Ricevimenti2022,\n  isnull(a3.Acquistato,0) as Ricevimenti2021,\n  isnull(a4.Acquistato,0) as Ricevimenti2020,\n  isnull(a5.Acquistato,0) as Ricevimenti2019\nfrom stats..clis c\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v0 on c.codice = v0.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100\n\tgroup by d.CodiceFornitore\n  ) s0 on c.codice = s0.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a0 on c.codice = a0.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v1 on c.codice = v1.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100\n\tgroup by d.CodiceFornitore\n  ) s1 on c.codice = s1.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a1 on c.codice = a1.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v2 on c.codice = v2.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100\n\tgroup by d.CodiceFornitore\n  ) s2 on c.codice = s2.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a2 on c.codice = a2.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v3 on c.codice = v3.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100\n\tgroup by d.CodiceFornitore\n  ) s3 on c.codice = s3.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a3 on c.codice = a3.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v4 on c.codice = v4.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100\n\tgroup by d.CodiceFornitore\n  ) s4 on c.codice = s4.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a4 on c.codice = a4.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v5 on c.codice = v5.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100\n\tgroup by d.CodiceFornitore\n  ) s5 on c.codice = s5.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a5 on c.codice = a5.codice\nwhere c.Codice like 'F%' and Settore = 'Utensileria'\norder by 1",
    "ute0006": "with ground as (\nselect distinct d.CodiceCliente, d.RagioneSociale, d.CodiceAgente, d.NomeAgente,\n  cast((select isnull(sum(a.totriga),0) from stats..fatturato a where a.CodiceCliente = d.CodiceCliente and a.DataDoc between GetDate()-730 and GetDate()-365 ) as decimal(12,2)) as ImportoAP,\n  cast((select isnull(sum(a.totriga),0) from stats..fatturato a where a.CodiceCliente = d.CodiceCliente and a.DataDoc between GetDate()-365 and GetDate()-0   ) as decimal(12,2)) as ImportoAc,\n  (select count(distinct a.progressivo) from stats..fatturato a where a.CodiceCliente = d.CodiceCliente and a.DataDoc between GetDate()-730 and GetDate()-365 ) as ContoAP,\n  (select count(distinct a.progressivo) from stats..fatturato a where a.CodiceCliente = d.CodiceCliente and a.DataDoc between GetDate()-365 and GetDate()-0   ) as ContoAc\nfrom stats..fatturato d\nwhere d.anno >= Year(getDate()) -2\n  and CodiceAgente in ('A     4','A   155')\n)\nselect *\nfrom ground\nwhere CodiceAgente in ('A     4','A   155')\nand ImportoAP = 0 and importoac >= 500 and ContoAC >= 2\norder by 1",
    "ute0007": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect CodiceArticolo, DescrizioneArticolo, CodiceFornitore, NomeFornitore, ClasseRotazioneTV, ClasseRotazioneVA, TipoGestioneTV, TipoGestioneVA,\n  cast((select isnull(sum(Quantita),0) from stats..Consegne d where d.Articolo = a.CodiceArticolo and d.DataDoc >= @dadata and d.DataDoc <= @adata) as decimal(12,2)) as QtaVendutaPeriodo,\n  cast((select isnull(sum(Quantita),0) from stats..Acquisti d where d.Articolo = a.CodiceArticolo and d.DataDoc >= @dadata and d.DataDoc <= @adata) as decimal(12,2)) as QtaAcquistataPeriodo,\n  cast((select isnull(sum(TotRiga),0) from stats..Consegne d where d.Articolo = a.CodiceArticolo and d.DataDoc >= @dadata and d.DataDoc <= @adata) as decimal(12,2)) as VendutoPeriodo,\n  cast((select isnull(sum(CostoUltimoTot),0) from stats..Consegne d where d.Articolo = a.CodiceArticolo and d.DataDoc >= @dadata and d.DataDoc <= @adata) as decimal(12,2)) as CostoRelativo,\n  cast((select isnull(sum(TotRiga),0) from stats..Acquisti d where d.Articolo = a.CodiceArticolo and d.DataDoc >= @dadata and d.DataDoc <= @adata) as decimal(12,2)) as AcquistatoPeriodo,\n  cast((select isnull(avg(PrezzoUnitNetto),0) from stats..Consegne d where d.Articolo = a.CodiceArticolo and d.DataDoc >= @dadata and d.DataDoc <= @adata) as decimal(12,2)) as PrezzoMedioVenditaPeriodo,\n  cast((select isnull(avg(PrezzoUnitNetto),0) from stats..Acquisti d where d.Articolo = a.CodiceArticolo and d.DataDoc >= @dadata and d.DataDoc <= @adata) as decimal(12,2)) as PrezzoMedioAcquistoPeriodo,\n  cast((select top 1 isnull(PrezzoUnitNetto,0) from stats..Acquisti d where d.Articolo = a.CodiceArticolo order by d.datadoc desc ) as decimal(12,2)) as UltimoPrezzoAcquisto\nfrom stats..arts a\nwhere a.CodiceArticolo >= '<daart>' and a.CodiceArticolo <= '<adart>'",
    "ute0008": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'UTENSILERIA' and Period = 'Month'\norder by 1",
    "ute0009": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'UTENSILERIA' and Period = 'Year'\norder by 1",
    "ute0010": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.Progressivo, d.TipoDoc, d.NumeroDoc, d.CodiceCliente, d.RagioneSociale, d.DataDoc, d.NomeUtente, d.TipoOrdine, d.ImponibileDoc, d.CodiceAgente, d.NomeAgente, round(100 - (sum(totriga) / sum(PrezzoUnitLordo * Quantita) * 100), 2) as ScontoMedio\nfrom stats..ordinato d\nwhere TipoOrdine in ('Furgone utensileria','Canvas Furgone Utensileria') and tiporiga = 'normale'\nand DataDoc between @dadata and @adata\ngroup by d.Progressivo, d.TipoDoc, d.NumeroDoc, d.CodiceCliente, d.RagioneSociale, d.DataDoc, d.NomeUtente, d.TipoOrdine, d.ImponibileDoc, d.CodiceAgente, d.NomeAgente\norder by 1",
    "ute0011": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'UTENSILERIA' and Period = 'Month<mese>'\norder by 1",
    "ute0012": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect a.CodiceArticolo, a.DescrizioneArticolo, a.CodiceFornitore, a.NomeFornitore, g.MAG01 + g.MAGVA as GiacenzaTot, g.MAG01 as GiacenzaMag01, g.MAGVA as GiacenzaMagVA,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo) as QtaPeriodoTotale,\n   (select isnull(SUM(d.TotRiga),0)  from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo) as VendutoPeriodo,\n   (select isnull(SUM(d.CostoUltimoTot),0)  from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo) as CostoPeriodo,\n   (select isnull(SUM(d.TotRiga) / SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo having sum(d.quantita) != 0) as PrezzoMedioVenditaPeriodo,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.Sede = 'Treviso') as QtaPeriodoTreviso,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.Sede = 'Varese')  as QtaPeriodoVarese,\n   (select isnull(SUM(d.Quantita),0) from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo )  as QtaPeriodoAcquisto,\n   (select isnull(SUM(d.TotRiga),0)  from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo )  as AcquistatoPeriodo,\n   (select isnull(SUM(d.TotRiga) / SUM(d.Quantita),0) from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.Quantita != 0 )  as PrezzoMedioAcquistoPeriodo,\n   isnull((select top 1 d.PrezzoUnitNetto from Stats..BolleAcquisti d where a.CodiceArticolo = d.Articolo order by d.DataDoc desc),0)  as UltimoPrezzoAcquisto,\n   isnull((select top 1 d.TipoDoc + ' ' + CAST(d.NumeroDoc as nvarchar) + ' del ' + CONVERT(nvarchar, d.DataDoc, 103) from Stats..BolleAcquisti d where a.CodiceArticolo = d.Articolo order by d.DataDoc desc),'')  as UltimoDocumento\nfrom Stats..arts a inner join COLFERT..GiacenzeAllaData (GETDATE()) g on a.CodiceArticolo = g.CodiceArticolo\nand a.CodiceArticolo in ('094003186','094003187','094003188','094003191','094003192','094003193','094003194','094003195','094003196','094003197','094003198','094003199','094003200','094003201','094003202','094003203','094003204','094003205','094003255','094003262','001CODOLOCIS25','001CODOLOCIS25L','001CODOLOCIS30','001CODOLOCIS35','001CODOLOCIS40','001CODOLOCIS45','001CODOLOCIS50','001CODOLOCIS55','001CODOLOF525','001CODOLOF525L','001CODOLOF530','001CODOLOF535','001CODOLOF540','001CODOLOF545','001CODOLOF555','001CODOLOF560','001CODOLOF575','001CODOLOR1125','001CODOLOR1125L','001CODOLOR1130','001CODOLOR1135','001CODOLOR1140','001CODOLOR1145','001CODOLOR1150','001CODOLOR1155','001DC3KS','001DC4KS','001DCAP4','001DCAP4I','001DCASIX','001DCASIXP8','001DCASTRAL','001DCASTRALG','001DCASTRALTPRO','001DCASTRALTPROC','001DCAUTO','001DCAUTOG','001DCCOLORE','001DCCORBIN','001DCCS17','001DCDM','001DCDMG','001DCDMT','001DCFPS','001DCHCS','001DCICS','001DCICSG','001DCLUCCHETTO','001DCMGX8','001DCNORMALE','001DCOMEC','001DCOPERA','001DCPATENT','001DCPOMPA','001DCR11','001DCR50','001DCR6','001DCR6PLUS','001DCR6PLUSHS','001DCSECUREMME','001DCSP','001DCSPG','001DCSPILLO','001DCSPILLOG','001DCTAPPO','001KA3KS','001KAASIX','001KAASTRAL','001KADM','001KAFPS','001KAICS','001KALUCCHETTO','001KAOVALE','001KAR11','001KAR50','001KAR6','001KASAGOMATO','001KAX8','001KCASIX','001KCASTRAL','001KCOVALE','001KCR6','001KCSAGOMATO','001KCX8','001KIT05','001KPBW4','001KPSCHUKOW','001MCASIX','001MCASTRAL','001MKASIX','001MKASTRAL','001MKF5','001MKF5CI','001MKICS','001MKR6','001MOLLA','021J42401500','021J42403500','021J42405500','021J42407500','021J42408500','021J42409500','021J42410500','021J44601500','021J4AP11584','094003188','001KASTARKY','001KALOCKY','001DCLOCKY','001DCSTARKY')\ngroup by a.CodiceArticolo, a.DescrizioneArticolo, a.CodiceFornitore, a.NomeFornitore, g.MAG01, g.MAGVA\norder by 1",
    "ute0013": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect\n    a.CodiceArticolo, a.DescrizioneArticolo, a.CodiceFornitore, a.NomeFornitore, g.MAG01 + g.MAGVA as GiacenzaTot, g.MAG01 as GiacenzaMag01, g.MAGVA as GiacenzaMagVA, a.CodArticoloFornitore,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and TipoRiga != 'Omaggio' and d.tipodoc != 'RFV') as QtaPeriodoTotale,\n   (select isnull(SUM(d.TotRiga),0)  from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and TipoRiga != 'Omaggio' and d.tipodoc != 'RFV') as VendutoPeriodo,\n   (select isnull(SUM(d.CostoUltimoTot),0)  from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and TipoRiga != 'Omaggio' and d.tipodoc != 'RFV') as CostoPeriodo,\n   (select isnull(SUM(d.TotRiga) / SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and TipoRiga != 'Omaggio' and d.tipodoc != 'RFV' having sum(d.quantita) != 0) as PrezzoMedioVenditaPeriodo,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.Sede = 'Treviso' and TipoRiga != 'Omaggio' and d.tipodoc != 'RFV') as QtaPeriodoTreviso,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.Sede = 'Varese' and TipoRiga != 'Omaggio' and d.tipodoc != 'RFV')  as QtaPeriodoVarese,\n   (select isnull(SUM(d.Quantita),0) from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.tipodoc != 'RFV')  as QtaPeriodoAcquisto,\n   (select isnull(SUM(d.TotRiga),0)  from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.tipodoc != 'RFV')  as AcquistatoPeriodo,\n   (select isnull(SUM(d.TotRiga) / SUM(d.Quantita),0) from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.tipodoc != 'RFV' having sum(d.Quantita) != 0 )  as PrezzoMedioAcquistoPeriodo,\n   isnull((select top 1 d.PrezzoUnitNetto from Stats..BolleAcquisti d where a.CodiceArticolo = d.Articolo and d.tipodoc != 'RFV' order by d.DataDoc desc),0)  as UltimoPrezzoAcquisto,\n   isnull((select top 1 d.TipoDoc + ' ' + CAST(d.NumeroDoc as nvarchar) + ' del ' + CONVERT(nvarchar, d.DataDoc, 103) from Stats..BolleAcquisti d where a.CodiceArticolo = d.Articolo and d.tipodoc != 'RFV' order by d.DataDoc desc),'')  as UltimoDocumento,\n   cast(l.PREZZOEURO as float) as Listino21\nfrom Stats..arts a left outer join COLFERT..GiacenzeAllaData (GETDATE()) g on a.CodiceArticolo = g.CodiceArticolo\n     left outer join colfert..LISTINIARTICOLI l on a.CodiceArticolo = l.codart and l.NRLISTINO = 21\nwhere a.CodiceFornitore = '<cardcode>'\ngroup by a.CodiceArticolo, a.DescrizioneArticolo, a.CodiceFornitore, a.NomeFornitore, g.MAG01, g.MAGVA, a.CodArticoloFornitore, l.PREZZOEURO\norder by 1",
    "ute0014": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect a.CodiceArticolo, a.DescrizioneArticolo, a.CodiceFornitore, a.NomeFornitore, g.MAG01 + g.MAGVA as GiacenzaTot, g.MAG01 as GiacenzaMag01, g.MAGVA as GiacenzaMagVA,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and TipoRiga != 'Omaggio') as QtaPeriodoTotale,\n   (select isnull(SUM(d.TotRiga),0)  from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and TipoRiga != 'Omaggio') as VendutoPeriodo,\n   (select isnull(SUM(d.CostoUltimoTot),0)  from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and TipoRiga != 'Omaggio') as CostoPeriodo,\n   (select isnull(SUM(d.TotRiga) / SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and TipoRiga != 'Omaggio' having sum(d.quantita) != 0) as PrezzoMedioVenditaPeriodo,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.Sede = 'Treviso' and TipoRiga != 'Omaggio') as QtaPeriodoTreviso,\n   (select isnull(SUM(d.Quantita),0) from Stats..consegnato d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo and d.Sede = 'Varese' and TipoRiga != 'Omaggio')  as QtaPeriodoVarese,\n   (select isnull(SUM(d.Quantita),0) from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo )  as QtaPeriodoAcquisto,\n   (select isnull(SUM(d.TotRiga),0)  from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo )  as AcquistatoPeriodo,\n   (select isnull(SUM(d.TotRiga) / SUM(d.Quantita),0) from Stats..BolleAcquisti d where d.datadoc between @dadata and @adata and a.CodiceArticolo = d.Articolo having sum(d.Quantita) != 0 )  as PrezzoMedioAcquistoPeriodo,\n   isnull((select top 1 d.PrezzoUnitNetto from Stats..BolleAcquisti d where a.CodiceArticolo = d.Articolo order by d.DataDoc desc),0)  as UltimoPrezzoAcquisto,\n   isnull((select top 1 d.TipoDoc + ' ' + CAST(d.NumeroDoc as nvarchar) + ' del ' + CONVERT(nvarchar, d.DataDoc, 103) from Stats..BolleAcquisti d where a.CodiceArticolo = d.Articolo order by d.DataDoc desc),'')  as UltimoDocumento\nfrom Stats..arts a left outer join COLFERT..GiacenzeAllaData (GETDATE()) g on a.CodiceArticolo = g.CodiceArticolo\nwhere --a.CodiceFornitore = 'F   474' and\n a.CategoriaFornitore = '<categoriafornitore>'\ngroup by a.CodiceArticolo, a.DescrizioneArticolo, a.CodiceFornitore, a.NomeFornitore, g.MAG01, g.MAGVA\norder by 1",
    "ute0015": "select d.CodiceCliente, d.RagioneSociale, d.Indirizzo, d.Localita, d.Cap, d.Provincia, d.CodiceAgente + '  - ' + d.NomeAgente as Agente,\n  (select isnull(sum(a.totriga),0) from stats..consegnato a where a.anno = year(getdate())-3 and d.CodiceCliente = a.CodiceCliente and a.CodiceFornitore = '<cardcode>') as ConsegnatoTreAnnifa,\n  (select isnull(sum(a.totriga),0) from stats..consegnato a where a.anno = year(getdate())-2 and d.CodiceCliente = a.CodiceCliente and a.CodiceFornitore = '<cardcode>') as ConsegnatoDueAnnifa,\n  (select isnull(sum(a.totriga),0) from stats..consegnato a where a.anno = year(getdate())-1 and d.CodiceCliente = a.CodiceCliente and a.CodiceFornitore = '<cardcode>') as ConsegnatoUnAnnofa,\n  (select isnull(sum(a.totriga),0) from stats..consegnato a where a.anno = year(getdate())-0 and d.CodiceCliente = a.CodiceCliente and a.CodiceFornitore = '<cardcode>') as ConsegnatoAnnoCorrente\nfrom stats..consegnato d\nwhere d.anno >= year(getdate())-3\nand d.CodiceFornitore = '<cardcode>'\ngroup by d.CodiceCliente, d.RagioneSociale, d.CodiceAgente + '  - ' + d.NomeAgente, d.Indirizzo, d.Localita, d.Cap, d.Provincia\norder by 1",
    "ute0016": "select c.Codice as CodiceCliente, c.RagioneSociale, c.Provincia, c.Localita, c.Indirizzo, cast(c.ConsegnatoAA as decimal(15,2)) as Consegnato2AnniFa, cast(c.ConsegnatoAP as decimal(15,2)) as Consegnato1AnnoFa, cast(c.ConsegnatoAC as decimal(15,2)) as ConsegnatoAnnoCorrente,\n       (select cast(isnull(sum(d.totriga),0) as decimal(15,2)) from stats..consegnato d where c.codice = d.CodiceCliente and anno = year(getdate())-2 and CategoriaFornitore = 'UTENSILERIA') as ConsUtensialeria2Annifa,\n       (select cast(isnull(sum(d.totriga),0) as decimal(15,2)) from stats..consegnato d where c.codice = d.CodiceCliente and anno = year(getdate())-1 and CategoriaFornitore = 'UTENSILERIA') as ConsUtensialeria1AnnoFa,\n       (select cast(isnull(sum(d.totriga),0) as decimal(15,2)) from stats..consegnato d where c.codice = d.CodiceCliente and anno = year(getdate())-0 and CategoriaFornitore = 'UTENSILERIA') as ConsUtensialeriaAnnoCorrente\nfrom stats..cliext c\nwhere c.CodiceAgente = '<agente>'",
    "ute0017": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect c.Codice, c.RagioneSociale,\n  isnull(v0.Venduto,0) as Spedito2024,\n  isnull(v1.Venduto,0) as Spedito2023,\n  isnull(v2.Venduto,0) as Spedito2022,\n  isnull(v3.Venduto,0) as Spedito2021,\n  isnull(v4.Venduto,0) as Spedito2020,\n  isnull(v5.Venduto,0) as Spedito2019,\n  isnull(v0.CostoRelativo,0) as CostoVenduto2024,\n  isnull(v1.CostoRelativo,0) as CostoVenduto2023,\n  isnull(v2.CostoRelativo,0) as CostoVenduto2022,\n  isnull(v3.CostoRelativo,0) as CostoVenduto2021,\n  isnull(v4.CostoRelativo,0) as CostoVenduto2020,\n  isnull(v5.CostoRelativo,0) as CostoVenduto2019,\n  isnull(s0.ScontoMedio,0) as ScontoMedio2024,\n  isnull(s1.ScontoMedio,0) as ScontoMedio2023,\n  isnull(s2.ScontoMedio,0) as ScontoMedio2022,\n  isnull(s3.ScontoMedio,0) as ScontoMedio2021,\n  isnull(s4.ScontoMedio,0) as ScontoMedio2020,\n  isnull(s5.ScontoMedio,0) as ScontoMedio2019,\n  isnull(a0.Acquistato,0) as Ricevimenti2024,\n  isnull(a1.Acquistato,0) as Ricevimenti2023,\n  isnull(a2.Acquistato,0) as Ricevimenti2022,\n  isnull(a3.Acquistato,0) as Ricevimenti2021,\n  isnull(a4.Acquistato,0) as Ricevimenti2020,\n  isnull(a5.Acquistato,0) as Ricevimenti2019\nfrom stats..clis c\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.CategoriaFornitore = 'Utensileria' and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) v0 on c.codice = v0.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s0 on c.codice = s0.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a0 on c.codice = a0.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.CategoriaFornitore = 'Utensileria' and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) v1 on c.codice = v1.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s1 on c.codice = s1.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a1 on c.codice = a1.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.CategoriaFornitore = 'Utensileria' and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) v2 on c.codice = v2.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s2 on c.codice = s2.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a2 on c.codice = a2.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.CategoriaFornitore = 'Utensileria' and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) v3 on c.codice = v3.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s3 on c.codice = s3.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a3 on c.codice = a3.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.CategoriaFornitore = 'Utensileria' and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) v4 on c.codice = v4.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s4 on c.codice = s4.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a4 on c.codice = a4.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(d.TotRiga),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.CategoriaFornitore = 'Utensileria' and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) v5 on c.codice = v5.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s5 on c.codice = s5.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a5 on c.codice = a5.codice\nwhere c.Codice like 'F%' and Settore = 'Utensileria'\norder by 1",
    "ute0018": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect c.Codice, c.RagioneSociale,\n  isnull(v0.Venduto,0) as Spedito2024,\n  isnull(v1.Venduto,0) as Spedito2023,\n  isnull(v2.Venduto,0) as Spedito2022,\n  isnull(v3.Venduto,0) as Spedito2021,\n  isnull(v4.Venduto,0) as Spedito2020,\n  isnull(v5.Venduto,0) as Spedito2019,\n  isnull(v0.CostoRelativo,0) as CostoVenduto2024,\n  isnull(v1.CostoRelativo,0) as CostoVenduto2023,\n  isnull(v2.CostoRelativo,0) as CostoVenduto2022,\n  isnull(v3.CostoRelativo,0) as CostoVenduto2021,\n  isnull(v4.CostoRelativo,0) as CostoVenduto2020,\n  isnull(v5.CostoRelativo,0) as CostoVenduto2019,\n  isnull(s0.ScontoMedio,0) as ScontoMedio2024,\n  isnull(s1.ScontoMedio,0) as ScontoMedio2023,\n  isnull(s2.ScontoMedio,0) as ScontoMedio2022,\n  isnull(s3.ScontoMedio,0) as ScontoMedio2021,\n  isnull(s4.ScontoMedio,0) as ScontoMedio2020,\n  isnull(s5.ScontoMedio,0) as ScontoMedio2019,\n  isnull(a0.Acquistato,0) as Ricevimenti2024,\n  isnull(a1.Acquistato,0) as Ricevimenti2023,\n  isnull(a2.Acquistato,0) as Ricevimenti2022,\n  isnull(a3.Acquistato,0) as Ricevimenti2021,\n  isnull(a4.Acquistato,0) as Ricevimenti2020,\n  isnull(a5.Acquistato,0) as Ricevimenti2019\nfrom stats..clis c\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(case when d.TipoRiga = 'omaggio' then 0 else d.TotRiga end),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v0 on c.codice = v0.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s0 on c.codice = s0.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-0,@dadata) and DATEADD(year,-0,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a0 on c.codice = a0.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(case when d.TipoRiga = 'omaggio' then 0 else d.TotRiga end),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v1 on c.codice = v1.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s1 on c.codice = s1.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-1,@dadata) and DATEADD(year,-1,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a1 on c.codice = a1.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(case when d.TipoRiga = 'omaggio' then 0 else d.TotRiga end),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v2 on c.codice = v2.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s2 on c.codice = s2.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-2,@dadata) and DATEADD(year,-2,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a2 on c.codice = a2.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(case when d.TipoRiga = 'omaggio' then 0 else d.TotRiga end),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v3 on c.codice = v3.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s3 on c.codice = s3.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-3,@dadata) and DATEADD(year,-3,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a3 on c.codice = a3.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(case when d.TipoRiga = 'omaggio' then 0 else d.TotRiga end),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v4 on c.codice = v4.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s4 on c.codice = s4.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-4,@dadata) and DATEADD(year,-4,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a4 on c.codice = a4.codice\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(sum(case when d.TipoRiga = 'omaggio' then 0 else d.TotRiga end),2) as Venduto, round(sum(d.CostoUltimoTot),2) as CostoRelativo\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.CategoriaFornitore = 'Utensileria'\n\tgroup by d.CodiceFornitore\n  ) v5 on c.codice = v5.codicefornitore\n  left outer join\n  (\n\tselect d.CodiceFornitore, round(100 - (sum(d.TotRiga) / sum(d.quantita * d.prezzounitlordo) * 100), 2) as ScontoMedio\n\tfrom stats..consegnato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.CategoriaFornitore = 'Utensileria' and d.Quantita != 0 and d.PrezzoUnitLordo != 0 and d.sconto != 100 and d.tiporiga != 'omaggio'\n\tgroup by d.CodiceFornitore\n  ) s5 on c.codice = s5.codicefornitore\n  left outer join\n  (\n\tselect d.Codice, round(sum(d.TotRiga),2) as Acquistato\n\tfrom stats..bolleacquistato d\n\twhere d.DataDoc between DATEADD(year,-5,@dadata) and DATEADD(year,-5,@adata) and d.Settore = 'Utensileria' and d.TipoDoc in ('DFA','DFD','DFB','DFR') and d.Articolo not in ('0011','0012','0013','0014','0015')\n\tgroup by d.Codice\n  ) a5 on c.codice = a5.codice\nwhere c.Codice like 'F%' and Settore = 'Utensileria'\norder by 1",
    "ute0019": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect CodiceArticolo, DescrizioneArticolo, Quantita, CostoUltimoTot, CodiceCliente, RagioneSociale,\n       isnull(o.Descrizione,'') as TipoOmaggio, d.TipoOrdine,\n\t   d.NomeAgente, isnull(g.DSCAGENTE,'') as NomeSpecialistaUT\nfrom stats..consegnato d\n     inner join colfert..extrarighedoc er on d.Progressivo = er.IDTESTA and d.IdRiga = er.IDRIGA\n\t left outer join colfert..NDTabTipiOmaggio o on er.TipoOmaggio = o.Codice\n\t left outer join colfert..ND_TabSpecialistiClienti s on d.CodiceCliente = s.CODCONTO and s.TIPOSPECIALISTA = 'UT'\n\t left outer join colfert..ANAGRAFICAAGENTI g on s.CODSPECIALISTA = g.CODAGENTE\nwhere d.DataDoc between @dadata and @adata and d.CategoriaFornitore = 'utensileria' and d.TipoRiga = 'omaggio'\norder by 1",
    "fur0001": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.Progressivo, d.TipoDoc, d.NumeroDoc, d.CodiceCliente, d.RagioneSociale, d.DataDoc, d.NomeUtente, d.TipoOrdine, d.ImponibileDoc, d.CodiceAgente, d.NomeAgente, round(100 - (sum(totriga) / sum(PrezzoUnitLordo * Quantita) * 100), 2) as ScontoMedio\nfrom stats..ordinato d\nwhere TipoOrdine in ('Furgone utensileria','Canvas Furgone Utensileria') and tiporiga = 'normale' and d.articolo not in ('zzzacc')\nand DataDoc between @dadata and @adata\ngroup by d.Progressivo, d.TipoDoc, d.NumeroDoc, d.CodiceCliente, d.RagioneSociale, d.DataDoc, d.NomeUtente, d.TipoOrdine, d.ImponibileDoc, d.CodiceAgente, d.NomeAgente\norder by 1",
    "fur0002": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect g.* , cast(g.ProvvigionePerc * TotRiga / 100 as decimal(15,2)) as Provvigione\nfrom (\nselect d.Progressivo, d.TipoDoc, d.NumeroDoc, d.CodiceCliente, d.RagioneSociale, d.Provincia, d.DataDoc, d.NomeUtente, d.TipoOrdine, d.CodiceAgente, d.NomeAgente, d.Articolo, d.Descrizione,\n       d.PrezzoUnitLordo as Lordo, d.Sconto, d.ScontoEsteso, d.PrezzoUnitNetto, d.TotRiga, round(d.CostoUltimoTot,2) as CostoRelativo, round(d.MargineTot,2) as Margine,\n\t   s.CodSpecialista as CodiceSpecialista, g.DSCAGENTE as NomeSpecialista,\n\t   stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso) as ScontoProvvisionabile, cast(stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) as decimal(5,2)) as ScontoUnicoProvvisionabile,\n\t   case\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso))  = 0    then 0\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 35   then 2.56\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 36   then 2.50\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 37   then 2.44\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 38   then 2.38\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 39   then 2.31\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 40   then 2.25\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 41   then 2.19\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 42   then 2.13\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 43   then 2.06\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 44   then 2.00\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 45   then 1.94\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 46   then 1.88\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 47   then 1.81\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 48   then 1.75\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 49   then 1.69\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 50   then 1.63\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 51   then 1.56\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 52   then 1.50\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 53   then 1.44\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 54   then 1.38\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 55   then 1.31\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 56   then 1.25\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 57   then 1.19\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 58   then 1.13\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 59   then 1.06\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 60   then 1.00\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 60.4 then 0.94\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 60.8 then 0.88\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 61.2 then 0.81\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 61.6 then 0.75\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 62   then 0.69\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 62.4 then 0.63\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 62.8 then 0.56\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 63.2 then 0.50\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 63.6 then 0.44\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 64   then 0.38\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 64.4 then 0.31\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 64.8 then 0.25\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 65.2 then 0.19\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 65.6 then 0.13\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 66   then 0.13\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 66.4 then 0.06\n\t   when stats.dbo.CalculateDiscount(stats.dbo.MultiToDoubleDiscount(d.ScontoEsteso)) <= 66.8 then 0.03\n\t   else 0.03\n\t   end as ProvvigionePerc\nfrom stats..ordinato d\n     left outer join colfert..ND_TabSpecialistiClienti s on d.CodiceCliente = s.CODCONTO and s.TIPOSPECIALISTA = 'UT'\n\t left outer join colfert..anagraficaagenti g on s.CODSPECIALISTA = g.CODAGENTE\nwhere TipoOrdine in ('Furgone utensileria','Canvas Furgone Utensileria') and tiporiga = 'normale' and d.articolo not in ('zzzacc')\nand DataDoc between @dadata and @adata\n) g\norder by 1",
    "fur0003": "select c.Codice as CodiceCliente, c.RagioneSociale, c.Provincia, c.Localita, c.Indirizzo, c.NomeAgente, isnull(a.DSCAGENTE,'') as Specialista,\n       isnull(d.RagioneSociale,'') as RagioneSocialeDD, isnull(d.Indirizzo,'') as IndirizzoDD, isnull(d.Cap,'') as CapDD, isnull(d.Provincia,'') as provinciaDD,\n       cast(c.ConsegnatoAA as decimal(15,2)) as Consegnato2AnniFa, cast(c.ConsegnatoAP as decimal(15,2)) as Consegnato1AnnoFa, cast(c.ConsegnatoAC as decimal(15,2)) as ConsegnatoAnnoCorrente,\n       (select cast(isnull(sum(d.totriga),0) as decimal(15,2)) from stats..consegnato d where c.codice = d.CodiceCliente and anno = year(getdate())-2 and CategoriaFornitore = 'UTENSILERIA') as ConsUtensialeria2Annifa,\n       (select cast(isnull(sum(d.totriga),0) as decimal(15,2)) from stats..consegnato d where c.codice = d.CodiceCliente and anno = year(getdate())-1 and CategoriaFornitore = 'UTENSILERIA') as ConsUtensialeria1AnnoFa,\n       (select cast(isnull(sum(d.totriga),0) as decimal(15,2)) from stats..consegnato d where c.codice = d.CodiceCliente and anno = year(getdate())-0 and CategoriaFornitore = 'UTENSILERIA') as ConsUtensialeriaAnnoCorrente\nfrom stats..cliext c\n     left outer join colfert..ND_TabSpecialistiClienti s on c.codice = s.codconto and s.TIPOSPECIALISTA = 'UT'\n\t left outer join COLFERT..ANAGRAFICAAGENTI a on s.CODSPECIALISTA = a.CODAGENTE\n\t left outer join\n\t (\n\t\tselect d.*\n\t\tfrom colfert..anagraficariservaticf r\n\t\tinner join DESTINAZIONIDIVERSE d on r.DESTDIVMERCI = d.codice and r.CODCONTO = d.CODCONTO and r.ESERCIZIO = year(getDate())\n\t ) d on c.codice = d.codconto\nwhere c.CodiceAgente like '%<agente>%'",
    "dir0000.delete": "delete from temp..StatCons",
    "dir0000.create": "\ninsert into temp..StatCons\nselect\n       t.esercizio                      as Esercizio,\n\t   ''                               as ClasseDocumento,\n\t   ''                               as UtenteAssegnato,\n\t   ''                               as NomeUtente,\n\t   ''                               as TipoUtente,\n\t   ''                               as ClasseUtente,\n       t.DATAINIZIOTRASP                as InizioTrasporto,\n       Year(t.DATAINIZIOTRASP)          as AnnoTrasporto,\n       Month(t.DATAINIZIOTRASP)         as MeseTrasporto,\n       Day(t.DATAINIZIOTRASP)           as GiornoTrasporto,\n       DATEPART(week,t.DATAINIZIOTRASP) as SettimanaTrasporto,\n       DATEPART(dw,t.DATAINIZIOTRASP)   as GiornoSettimana,\n\t   t.CODCLIFOR                      as CodiceCliente,\n\t   c.DSCCONTO1                      as NomeCliente,\n\t   w.descrizione                    as SettoreCliente,\n\t   y.dsccategoria                   as CategoriaCliente,\n\t   x.CODAGENTE1                     as CodiceAgente,\n\t   s.DSCAGENTE                      as NomeAgente,\n\t   o.Descrizione                    as TipoOrdine,\n\t   r.TOTNETTORIGAEURO * t.SEGNO     as NettoRiga,\n\t   isnull(h.ND_UTECREAZ,'')         as DocCreatore,\n\t   t.PROGRESSIVO                    as DocProgressivo,\n\t   t.tipodoc                        as DocTipo,\n\t   t.NUMERODOC                      as DocNumero,\n\t   r.IDRIGA                         as DocRiga,\n       (select w.ND_UTECREAZ from colfert..extratestedoc w where w.IDTESTA = dbo.piGetOrderProg(t.progressivo, r.idriga))    as OrigCreatore,\n\t   dbo.piGetOrderProg(t.progressivo, r.idriga)                                                                  as OrigProgressivo,\n\t   (select w.TIPODOC   from colfert..TESTEDOCUMENTI w where w.progressivo = dbo.piGetOrderProg(t.progressivo, r.idriga)) as OrigTipo,\n\t   (select w.NUMERODOC from colfert..TESTEDOCUMENTI w where w.progressivo = dbo.piGetOrderProg(t.progressivo, r.idriga)) as OrigNumero,\n\t   isnull(l.Nd_Stat_BancoUtente,'') as UtenteBanco,\n\t   p.descrizione                    as Pagamento,\n\t   isnull(sd.RAGSOCSPED,'')         as Vettore,\n\t   t.PROVINCIADDM                   as Provincia,\n       t.TOTSPESEDOCEURO * t.SEGNO\t    as SpeseDocumento,\n       t.TOTIMPONIBILEEURO * t.SEGNO    as ImponibileDocumento,\n       t.TOTIMPOSTAEURO\t* t.SEGNO\t    as IvaDocumento,\n       t.TOTDOCUMENTOEURO * t.SEGNO     as TotaleDocumento,\n       t.CONSEGNAURGENTE\t            as ConsegnaUrgente,\n       t.TOTPESONETTO\t\t            as PesoDocumento,\n       t.TOTVOLUME\t\t\t            as VolumeDocumento,\n       r.CODART                         as Articolo,\n       r.DESCRIZIONEART\t\t\t        as Descrizione,\n       r.UMPREZZO    \t\t\t        as UM,\n       r.QTAPREZZO\t\t\t\t        as Quantita,\n       r.PREZZOUNITLORDOEURO\t        as PrezzoUnitLordo,\n       r.SCONTORIGA\t\t\t\t        as Sconto,\n       r.PREZZOUNITNETTOEURO\t        as PrezzoUnitNetto,\n       r.SCONTIESTESI\t\t\t        as ScontoEsteso,\n       r.TOTPROVVAGEURO1\t\t        as Provvigione,\n       r.GENCONTROP\t\t\t\t        as Coge,\n       isnull(mr.segno * mr.COSTOMEDIOEURO * sign(mr.PrezzoUnitLordoEURO),0)  as CostoUltimo,\n       isnull(mr.segno * mr.COSTOMEDIOEURO*(mr.qtavenduta+mr.qtaomaggio) * sign(mr.PrezzoUnitLordoEURO),0)  as TotCostoUltimo,\n       isnull(mr.PrezzoUnitNettoEuro,0)  as PrezzoMedio,\n       isnull(mr.TotNettoRigaEuro,0)  as TotPrezzoMedio,\n\t   ap.FORNPREFACQ                   as CodiceFornitore,\n\t   fa.DSCCONTO1                     as NomeFornitore,\n\t   sf.DESCRIZIONE                   as CategoriaFornitore,\n       tg.DESCRIZIONE                   as GruppoArticolo,\n       tc.DESCRIZIONE                   as CategoriaArticolo,\n\t   case r.Tiporiga when 'N' then 'Normale' when 'O' then 'Omaggio' when 'S' then 'Spese' when 'D' then 'Descrizione' when 'R' then 'Riferimento' when 'V' then 'Valore' else 'Non classificato' end as TipoRiga,\n\t   case when em.Generico = 'S' then 'Generico' else case em.TipoGestione when 'D' then 'Discontinuo' when 'E' then 'Non ordinabile' when 'M' then 'Manuale' when 'R' then 'Regolare' else 'Non classificato' end end as TipoArticolo,\n\t   (select sa.Pers_ABC_RS from SISMAG..ARTICOLI sa where sa.CODART = r.CODART) as ClasseRotazione,\n\t   t.orainiziotrasp                 as OraInizioTrasporto,\n\t   em.Categoria4                    as Categoria4,\n\t   ''                               as UtenteMappabanco,\n\t   ''                               as Cdc,\n\t   ''                               as Regione,\n\t   ''                               as Nazione,\n\t   ''                               as Extra0,\n\t   ''                               as Extra1,\n\t   ''                               as Extra2,\n\t   ''                               as Extra3,\n\t   ''                               as Extra4,\n\t   ''                               as Extra5,\n\t   ''                               as Extra6,\n\t   ''                               as Extra7,\n\t   ''                               as Extra8,\n\t   ''                               as Extra9\n\n\nfrom colfert..TESTEDOCUMENTI                        t\n\t     inner join colfert..EXTRATESTEDOC          h  on t.PROGRESSIVO                    = h.IDTESTA\n\t     inner join colfert..RIGHEDOCUMENTI         r  on t.PROGRESSIVO                    = r.IDTESTA\n\t     inner join colfert..EXTRARIGHEDOC          l  on r.IDTESTA                        = l.IDTESTA and r.IDRIGA = l.IDRIGA\n\t     inner join colfert..ANAGRAFICACF           c  on t.codclifor                      = c.CODCONTO\n\tleft outer join colfert..ANAGRAFICARISERVATICF  x  on (t.CODCLIFOR = x.CODCONTO and x.ESERCIZIO = year(GetDate()))\n\tleft outer join colfert..ANAGRAFICAAGENTI       s  on x.CODAGENTE1 = s.CODAGENTE\n\tleft outer join colfert..NDTabTipiOrdine        o  on h.TipoOrdine = o.Codice\n\tleft outer join colfert..TABSETTORI             w  on x.CODSETTORE = w.CODICE\n\tleft outer join colfert..CATEGORIECF            y  on x.CODCATEGORIA = y.CODCATEGORIA\n\tleft outer join colfert..TABPAGAMENTI           p  on t.CODPAGAMENTO = p.CODICE\n\tleft outer join colfert..SPEDIZDOCUMENTI        sd on (t.PROGRESSIVO = sd.IDTESTA and sd.POSSPED = 1)\n\tleft outer join colfert..NDMargineLordo         mr on (t.PROGRESSIVO = mr.IDTESTA and r.IDRIGA = mr.IDRIGA)\n\tleft outer join colfert..ANAGRAFICAARTICOLIPROD ap on (r.CODART = ap.codiceart and ap.esercizio = year(GetDate()))\n\tleft outer join colfert..ANAGRAFICACF           fa on fa.codconto = ap.FORNPREFACQ\n\tleft outer join colfert..ANAGRAFICAARTICOLI     aa on r.CODART = aa.CODICE\n\tleft outer join colfert..TABGRUPPI              tg on aa.GRUPPO = tg.CODICE\n\tleft outer join colfert..TABCATEGORIE           tc on aa.CATEGORIA = tc.CODICE\n\tleft outer join colfert..ANAGRAFICARISERVATICF  fr on (fr.CODCONTO = ap.FORNPREFACQ and fr.ESERCIZIO = year(GetDate()))\n\tleft outer join colfert..TABSETTORI             sf on (fr.CODSETTORE = sf.CODICE )\n\tleft outer join colfert..EXTRAMAG               em on aa.CODICE = em.CODART\n\nwhere t.esercizio > 2013\n\tand month(t.DATAINIZIOTRASP) in (1,2,3,4,5,6,7,8,9,10,11,12)\n\tand t.codclifor != 'C  3118'\n\tand r.tiporiga in ('n','s','v')\n\tand ( ( t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rca','fce','fcd','dcm') and r.TOTNETTORIGAEURO > 0 ) or ( t.tipodoc in ('rcd') ) )\n\n",
    "dir0000.update1": "delete from temp..StatCons where InizioTrasporto >= dateadd(DAY,-31,GetDate())",
    "dir0000.update2": "insert into temp..StatCons\nselect\n       t.esercizio                      as Esercizio,\n\t   ''                               as ClasseDocumento,\n\t   ''                               as UtenteAssegnato,\n\t   ''                               as NomeUtente,\n\t   ''                               as TipoUtente,\n\t   ''                               as ClasseUtente,\n       t.DATAINIZIOTRASP                as InizioTrasporto,\n       Year(t.DATAINIZIOTRASP)          as AnnoTrasporto,\n       Month(t.DATAINIZIOTRASP)         as MeseTrasporto,\n       Day(t.DATAINIZIOTRASP)           as GiornoTrasporto,\n       DATEPART(week,t.DATAINIZIOTRASP) as SettimanaTrasporto,\n       DATEPART(dw,t.DATAINIZIOTRASP)   as GiornoSettimana,\n\t   t.CODCLIFOR                      as CodiceCliente,\n\t   c.DSCCONTO1                      as NomeCliente,\n\t   w.descrizione                    as SettoreCliente,\n\t   y.dsccategoria                   as CategoriaCliente,\n\t   x.CODAGENTE1                     as CodiceAgente,\n--\t   t.CODAGENTE1                     as CodiceAgente,\n\t   s.DSCAGENTE                      as NomeAgente,\n\t   o.Descrizione                    as TipoOrdine,\n\t   r.TOTNETTORIGAEURO * t.SEGNO     as NettoRiga,\n\t   isnull(h.ND_UTECREAZ,'')         as DocCreatore,\n\t   t.PROGRESSIVO                    as DocProgressivo,\n\t   t.tipodoc                        as DocTipo,\n\t   t.NUMERODOC                      as DocNumero,\n\t   r.IDRIGA                         as DocRiga,\n       (select w.ND_UTECREAZ from colfert..extratestedoc w where w.IDTESTA = dbo.piGetOrderProg(t.progressivo, r.idriga))    as OrigCreatore,\n\t   dbo.piGetOrderProg(t.progressivo, r.idriga)                                                                  as OrigProgressivo,\n\t   (select w.TIPODOC   from colfert..TESTEDOCUMENTI w where w.progressivo = dbo.piGetOrderProg(t.progressivo, r.idriga)) as OrigTipo,\n\t   (select w.NUMERODOC from colfert..TESTEDOCUMENTI w where w.progressivo = dbo.piGetOrderProg(t.progressivo, r.idriga)) as OrigNumero,\n\t   isnull(l.Nd_Stat_BancoUtente,'') as UtenteBanco,\n\t   p.descrizione                    as Pagamento,\n\t   isnull(sd.RAGSOCSPED,'')         as Vettore,\n\t   t.PROVINCIADDM                   as Provincia,\n       t.TOTSPESEDOCEURO * t.SEGNO\t    as SpeseDocumento,\n       t.TOTIMPONIBILEEURO * t.SEGNO    as ImponibileDocumento,\n       t.TOTIMPOSTAEURO\t* t.SEGNO\t    as IvaDocumento,\n       t.TOTDOCUMENTOEURO * t.SEGNO     as TotaleDocumento,\n       t.CONSEGNAURGENTE\t            as ConsegnaUrgente,\n       t.TOTPESONETTO\t\t            as PesoDocumento,\n       t.TOTVOLUME\t\t\t            as VolumeDocumento,\n       r.CODART                         as Articolo,\n       r.DESCRIZIONEART\t\t\t        as Descrizione,\n       r.UMPREZZO\t\t\t\t        as UM,\n       r.QTAPREZZO\t\t\t\t        as Quantita,\n       r.PREZZOUNITLORDOEURO\t        as PrezzoUnitLordo,\n       r.SCONTORIGA\t\t\t\t        as Sconto,\n       r.PREZZOUNITNETTOEURO\t        as PrezzoUnitNetto,\n       r.SCONTIESTESI\t\t\t        as ScontoEsteso,\n       r.TOTPROVVAGEURO1\t\t        as Provvigione,\n       r.GENCONTROP\t\t\t\t        as Coge,\n       isnull(mr.segno * mr.COSTOMEDIOEURO * sign(mr.PrezzoUnitLordoEURO),0)  as CostoUltimo,\n       isnull(mr.segno * mr.COSTOMEDIOEURO*(mr.qtavenduta+mr.qtaomaggio) * sign(mr.PrezzoUnitLordoEURO),0)  as TotCostoUltimo,\n       isnull(mr.PrezzoUnitNettoEuro,0)  as PrezzoMedio,\n       isnull(mr.TotNettoRigaEuro,0)  as TotPrezzoMedio,\n\t   ap.FORNPREFACQ                   as CodiceFornitore,\n\t   fa.DSCCONTO1                     as NomeFornitore,\n\t   sf.DESCRIZIONE                   as CategoriaFornitore,\n       tg.DESCRIZIONE                   as GruppoArticolo,\n       tc.DESCRIZIONE                   as CategoriaArticolo,\n\t   case r.Tiporiga when 'N' then 'Normale' when 'O' then 'Omaggio' when 'S' then 'Spese' when 'D' then 'Descrizione' when 'R' then 'Riferimento' when 'V' then 'Valore' else 'Non classificato' end as TipoRiga,\n\t   case when em.Generico = 'S' then 'Generico' else case em.TipoGestione when 'D' then 'Discontinuo' when 'E' then 'Non ordinabile' when 'M' then 'Manuale' when 'R' then 'Regolare' else 'Non classificato' end end as TipoArticolo,\n\t   (select sa.Pers_ABC_RS from SISMAG..ARTICOLI sa where sa.CODART = r.CODART) as ClasseRotazione,\n\t   t.orainiziotrasp                 as OraInizioTrasporto,\n\t   em.Categoria4                    as Categoria4,\n\t   ''                               as UtenteMappabanco,\n\t   ''                               as Cdc,\n\t   ''                               as Regione,\n\t   ''                               as Nazione,\n\t   ''                               as Extra0,\n\t   ''                               as Extra1,\n\t   ''                               as Extra2,\n\t   ''                               as Extra3,\n\t   ''                               as Extra4,\n\t   ''                               as Extra5,\n\t   ''                               as Extra6,\n\t   ''                               as Extra7,\n\t   ''                               as Extra8,\n\t   ''                               as Extra9\n\nfrom colfert..TESTEDOCUMENTI                        t\n\tinner join colfert..EXTRATESTEDOC               h  on t.PROGRESSIVO                    = h.IDTESTA\n\tinner join colfert..RIGHEDOCUMENTI              r  on t.PROGRESSIVO                    = r.IDTESTA\n\tinner join colfert..EXTRARIGHEDOC               l  on r.IDTESTA                        = l.IDTESTA and r.IDRIGA = l.IDRIGA\n\tinner join colfert..ANAGRAFICACF                c  on t.codclifor                      = c.CODCONTO\n\tleft outer join colfert..ANAGRAFICARISERVATICF  x  on (t.CODCLIFOR = x.CODCONTO and x.ESERCIZIO = year(GetDate()))\n\tleft outer join colfert..ANAGRAFICAAGENTI       s  on x.CODAGENTE1 = s.CODAGENTE\n\tleft outer join colfert..NDTabTipiOrdine        o  on h.TipoOrdine = o.Codice\n\tleft outer join colfert..TABSETTORI             w  on x.CODSETTORE = w.CODICE\n\tleft outer join colfert..CATEGORIECF            y  on x.CODCATEGORIA = y.CODCATEGORIA\n\tleft outer join colfert..TABPAGAMENTI           p  on t.CODPAGAMENTO = p.CODICE\n\tleft outer join colfert..SPEDIZDOCUMENTI        sd on (t.PROGRESSIVO = sd.IDTESTA and sd.POSSPED = 1)\n\tleft outer join colfert..NDMargineLordo         mr on (t.PROGRESSIVO = mr.IDTESTA and r.IDRIGA = mr.IDRIGA)\n\tleft outer join colfert..ANAGRAFICAARTICOLIPROD ap on (r.CODART = ap.codiceart and ap.esercizio = year(GetDate()))\n\tleft outer join colfert..ANAGRAFICACF           fa on fa.codconto = ap.FORNPREFACQ\n\tleft outer join colfert..ANAGRAFICAARTICOLI     aa on r.CODART = aa.CODICE\n\tleft outer join colfert..TABGRUPPI              tg on aa.GRUPPO = tg.CODICE\n\tleft outer join colfert..TABCATEGORIE           tc on aa.CATEGORIA = tc.CODICE\n\tleft outer join colfert..ANAGRAFICARISERVATICF  fr on (fr.CODCONTO = ap.FORNPREFACQ and fr.ESERCIZIO = year(GetDate()))\n\tleft outer join colfert..TABSETTORI             sf on (fr.CODSETTORE = sf.CODICE )\n\tleft outer join colfert..EXTRAMAG               em on aa.CODICE = em.CODART\n\nwhere t.esercizio > 2013\n\tand month(t.DATAINIZIOTRASP) in (1,2,3,4,5,6,7,8,9,10,11,12)\n\tand t.DATAINIZIOTRASP >= dateadd(DAY,-31,GetDate())\n\tand t.codclifor != 'C  3118'\n\tand r.tiporiga in ('n','s','v')\n\tand ( ( t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rca','fce','fcd','dcm') and r.TOTNETTORIGAEURO > 0 ) or ( t.tipodoc in ('rcd') ) )\n",
    "dir0000.update3": "insert into temp..StatCons\nselect\n       t.esercizio                      as Esercizio,\n\t   ''                               as ClasseDocumento,\n\t   ''                               as UtenteAssegnato,\n\t   ''                               as NomeUtente,\n\t   ''                               as TipoUtente,\n\t   ''                               as ClasseUtente,\n       t.DATAINIZIOTRASP                as InizioTrasporto,\n       Year(t.DATAINIZIOTRASP)          as AnnoTrasporto,\n       Month(t.DATAINIZIOTRASP)         as MeseTrasporto,\n       Day(t.DATAINIZIOTRASP)           as GiornoTrasporto,\n       DATEPART(week,t.DATAINIZIOTRASP) as SettimanaTrasporto,\n       DATEPART(dw,t.DATAINIZIOTRASP)   as GiornoSettimana,\n\t   t.CODCLIFOR                      as CodiceCliente,\n\t   c.DSCCONTO1                      as NomeCliente,\n\t   w.descrizione                    as SettoreCliente,\n\t   y.dsccategoria                   as CategoriaCliente,\n\t   x.CODAGENTE1                     as CodiceAgente,\n--\t   t.CODAGENTE1                     as CodiceAgente,\n\t   s.DSCAGENTE                      as NomeAgente,\n\t   o.Descrizione                    as TipoOrdine,\n\t   r.TOTNETTORIGAEURO * t.SEGNO     as NettoRiga,\n\t   isnull(h.ND_UTECREAZ,'')         as DocCreatore,\n\t   t.PROGRESSIVO                    as DocProgressivo,\n\t   t.tipodoc                        as DocTipo,\n\t   t.NUMERODOC                      as DocNumero,\n\t   r.IDRIGA                         as DocRiga,\n       (select w.ND_UTECREAZ from colfert..extratestedoc w where w.IDTESTA = dbo.piGetOrderProg(t.progressivo, r.idriga))    as OrigCreatore,\n\t   dbo.piGetOrderProg(t.progressivo, r.idriga)                                                                  as OrigProgressivo,\n\t   (select w.TIPODOC   from colfert..TESTEDOCUMENTI w where w.progressivo = dbo.piGetOrderProg(t.progressivo, r.idriga)) as OrigTipo,\n\t   (select w.NUMERODOC from colfert..TESTEDOCUMENTI w where w.progressivo = dbo.piGetOrderProg(t.progressivo, r.idriga)) as OrigNumero,\n\t   isnull(l.Nd_Stat_BancoUtente,'') as UtenteBanco,\n\t   p.descrizione                    as Pagamento,\n\t   isnull(sd.RAGSOCSPED,'')         as Vettore,\n\t   t.PROVINCIADDM                   as Provincia,\n       t.TOTSPESEDOCEURO * t.SEGNO\t    as SpeseDocumento,\n       t.TOTIMPONIBILEEURO * t.SEGNO    as ImponibileDocumento,\n       t.TOTIMPOSTAEURO\t* t.SEGNO\t    as IvaDocumento,\n       t.TOTDOCUMENTOEURO * t.SEGNO     as TotaleDocumento,\n       t.CONSEGNAURGENTE\t            as ConsegnaUrgente,\n       t.TOTPESONETTO\t\t            as PesoDocumento,\n       t.TOTVOLUME\t\t\t            as VolumeDocumento,\n       r.CODART                         as Articolo,\n       r.DESCRIZIONEART\t\t\t        as Descrizione,\n       r.UMPREZZO\t\t\t\t        as UM,\n       r.QTAPREZZO\t\t\t\t        as Quantita,\n       r.PREZZOUNITLORDOEURO\t        as PrezzoUnitLordo,\n       r.SCONTORIGA\t\t\t\t        as Sconto,\n       r.PREZZOUNITNETTOEURO\t        as PrezzoUnitNetto,\n       r.SCONTIESTESI\t\t\t        as ScontoEsteso,\n       r.TOTPROVVAGEURO1\t\t        as Provvigione,\n       r.GENCONTROP\t\t\t\t        as Coge,\n       isnull(mr.segno * mr.COSTOMEDIOEURO * sign(mr.PrezzoUnitLordoEURO),0)  as CostoUltimo,\n       isnull(mr.segno * mr.COSTOMEDIOEURO*(mr.qtavenduta+mr.qtaomaggio) * sign(mr.PrezzoUnitLordoEURO),0)  as TotCostoUltimo,\n       isnull(mr.PrezzoUnitNettoEuro,0)  as PrezzoMedio,\n       isnull(mr.TotNettoRigaEuro,0)  as TotPrezzoMedio,\n\t   ap.FORNPREFACQ                   as CodiceFornitore,\n\t   fa.DSCCONTO1                     as NomeFornitore,\n\t   sf.DESCRIZIONE                   as CategoriaFornitore,\n       tg.DESCRIZIONE                   as GruppoArticolo,\n       tc.DESCRIZIONE                   as CategoriaArticolo,\n\t   case r.Tiporiga when 'N' then 'Normale' when 'O' then 'Omaggio' when 'S' then 'Spese' when 'D' then 'Descrizione' when 'R' then 'Riferimento' when 'V' then 'Valore' else 'Non classificato' end as TipoRiga,\n\t   case when em.Generico = 'S' then 'Generico' else case em.TipoGestione when 'D' then 'Discontinuo' when 'E' then 'Non ordinabile' when 'M' then 'Manuale' when 'R' then 'Regolare' else 'Non classificato' end end as TipoArticolo,\n\t   (select sa.Pers_ABC_RS from SISMAG..ARTICOLI sa where sa.CODART = r.CODART) as ClasseRotazione,\n\t   t.orainiziotrasp                 as OraInizioTrasporto,\n\t   em.Categoria4                    as Categoria4,\n\t   ''                               as UtenteMappabanco,\n\t   ''                               as Cdc,\n\t   ''                               as Regione,\n\t   ''                               as Nazione,\n\t   ''                               as Extra0,\n\t   ''                               as Extra1,\n\t   ''                               as Extra2,\n\t   ''                               as Extra3,\n\t   ''                               as Extra4,\n\t   ''                               as Extra5,\n\t   ''                               as Extra6,\n\t   ''                               as Extra7,\n\t   ''                               as Extra8,\n\t   ''                               as Extra9\n\nfrom colfert..TESTEDOCUMENTI                        t\n\tinner join colfert..EXTRATESTEDOC               h  on t.PROGRESSIVO                    = h.IDTESTA\n\tinner join colfert..RIGHEDOCUMENTI              r  on t.PROGRESSIVO                    = r.IDTESTA\n\tinner join colfert..EXTRARIGHEDOC               l  on r.IDTESTA                        = l.IDTESTA and r.IDRIGA = l.IDRIGA\n\tinner join colfert..ANAGRAFICACF                c  on t.codclifor                      = c.CODCONTO\n\tleft outer join colfert..ANAGRAFICARISERVATICF  x  on (t.CODCLIFOR = x.CODCONTO and x.ESERCIZIO = year(GetDate()))\n\tleft outer join colfert..ANAGRAFICAAGENTI       s  on x.CODAGENTE1 = s.CODAGENTE\n\tleft outer join colfert..NDTabTipiOrdine        o  on h.TipoOrdine = o.Codice\n\tleft outer join colfert..TABSETTORI             w  on x.CODSETTORE = w.CODICE\n\tleft outer join colfert..CATEGORIECF            y  on x.CODCATEGORIA = y.CODCATEGORIA\n\tleft outer join colfert..TABPAGAMENTI           p  on t.CODPAGAMENTO = p.CODICE\n\tleft outer join colfert..SPEDIZDOCUMENTI        sd on (t.PROGRESSIVO = sd.IDTESTA and sd.POSSPED = 1)\n\tleft outer join colfert..NDMargineLordo         mr on (t.PROGRESSIVO = mr.IDTESTA and r.IDRIGA = mr.IDRIGA)\n\tleft outer join colfert..ANAGRAFICAARTICOLIPROD ap on (r.CODART = ap.codiceart and ap.esercizio = year(GetDate()))\n\tleft outer join colfert..ANAGRAFICACF           fa on fa.codconto = ap.FORNPREFACQ\n\tleft outer join colfert..ANAGRAFICAARTICOLI     aa on r.CODART = aa.CODICE\n\tleft outer join colfert..TABGRUPPI              tg on aa.GRUPPO = tg.CODICE\n\tleft outer join colfert..TABCATEGORIE           tc on aa.CATEGORIA = tc.CODICE\n\tleft outer join colfert..ANAGRAFICARISERVATICF  fr on (fr.CODCONTO = ap.FORNPREFACQ and fr.ESERCIZIO = year(GetDate()))\n\tleft outer join colfert..TABSETTORI             sf on (fr.CODSETTORE = sf.CODICE )\n\tleft outer join colfert..EXTRAMAG               em on aa.CODICE = em.CODART\n\tleft outer join colfert..PARAMETRIDOC           pd on t.TIPODOC = pd.CODICE\n\nwhere t.esercizio > 2013\n\tand month(t.DATAINIZIOTRASP) in (1,2,3,4,5,6,7,8,9,10,11,12)\n\tand t.DATAINIZIOTRASP >= dateadd(DAY,-31,GetDate())\n\tand pd.CLIFOR = 'c' and pd.TIPO = 'F'\n\tand t.codclifor != 'C  3118'\n\tand r.TOTNETTORIGAEURO > 0\n\tand r.tiporiga in ('n','s','v')\n\tand isnull(r.IDTESTARP,0) = 0 and isnull(idtestarp,0) = 0\n\tand r.codart in ('MANODOPERA','POSA')\n\tand t.progressivo not in (2718927,2718176)\n",
    "dir0000.reclassify": "update temp..StatCons set ClasseDocumento = '', UtenteAssegnato = '', NomeUtente = '', TipoUtente = '', ClasseUtente = ''",
    "dir0000.correct": "update temp..StatCons set DocCreatore  = '' where DocCreatore is null\nupdate temp..StatCons set OrigCreatore = '' where OrigCreatore is null\nupdate temp..StatCons set UtenteBanco  = '' where UtenteBanco is null\nupdate temp..StatCons set CategoriaFornitore = 'ALLUMINIO - FERRO' where CategoriaFornitore = 'ALLUM/FERRO'\nupdate temp..StatCons set SettoreCliente = 'ALLUMINIO - FERRO' where SettoreCliente = 'ALLUM/FERRO'\nupdate temp..StatCons set SettoreCliente = 'PVC - LEGNO' where SettoreCliente = 'LEGNO/PVC'\nupdate temp..StatCons set TipoOrdine = 'Prenota e ritira' where DocProgressivo in (select progressivo from temp..PENCambiati) and year(InizioTrasporto) >= 2021\nupdate temp..StatCons set TipoOrdine = 'Prenota e ritira' where OrigProgressivo in (select progressivo from temp..PENCambiati) and year(InizioTrasporto) >= 2021\nupdate temp..StatCons set UtenteAssegnato = OrigCreatore\nupdate temp..StatCons set ClasseUtente = (select top 1 classe      from temp..Tecnici where Codice = UtenteAssegnato) where ClasseUtente = ''\nupdate temp..StatCons set NomeUtente   = (select top 1 Descrizione from temp..Tecnici where Codice = UtenteAssegnato) where NomeUtente   = ''\nupdate temp..StatCons set TipoUtente   = (select top 1 Tipo        from temp..Tecnici where Codice = UtenteAssegnato) where TipoUtente   = ''\nupdate temp..StatCons set ClasseUtente = 'Altri Uffici' , TipoUtente = 'T' where UtenteAssegnato = 'cil'\nupdate temp..StatCons set ClasseDocumento = 'Punto Vendita', NomeUtente = 'Cristiano Bet', TipoUtente = 'B', ClasseUtente = 'Punto Vendita' where OrigTipo in ('PCB','dcb','scb','fca') and OrigCreatore = 'CIL'\nupdate temp..StatCons set ClasseDocumento = 'Punto Vendita' where ClasseUtente = 'Punto Vendita'\nupdate temp..StatCons set TipoUtente = 'B', ClasseUtente = 'Punto Vendita', ClasseDocumento = 'Punto Vendita' where NomeUtente = 'Claudio Borghese' and OrigTipo like '%b%'\nupdate temp..StatCons set TipoUtente = 'B', ClasseUtente = 'Altri Uffici' , ClasseDocumento = 'Punto Vendita' where NomeUtente = 'Alberto Camerini' and OrigTipo like '%b%'\nupdate temp..StatCons set TipoUtente = 'B', ClasseUtente = 'Altri Uffici' , ClasseDocumento = 'Punto Vendita' where NomeUtente = 'Elena Pozzobon'   and OrigTipo like '%b%'\nupdate temp..StatCons set TipoUtente = 'B', ClasseUtente = 'Altri Uffici' , ClasseDocumento = 'Punto Vendita' where NomeUtente = 'Mario Berto'      and OrigTipo like '%b%'\nupdate temp..StatCons set TipoUtente = 'B', ClasseUtente = 'Altri Uffici' , ClasseDocumento = 'Punto Vendita' where NomeUtente = 'Carmen Cascella'  and OrigTipo like '%b%'\nupdate temp..StatCons set ClasseDocumento = 'Punto Vendita' where TipoOrdine = 'Prenota e ritira'\nupdate temp..StatCons set ClasseDocumento = 'Punto Vendita' where OrigTipo like '%B' and ClasseDocumento = ''\nupdate temp..StatCons set utenteassegnato = 'Susi.k' where nomeagente = 'WEB - Susi' and utenteassegnato = ''\nupdate temp..StatCons set UtenteAssegnato = DocCreatore where UtenteAssegnato = ''\nupdate temp..StatCons set NomeUtente   = (select top 1 Descrizione from temp..Tecnici where Codice = UtenteAssegnato) where NomeUtente   = 'nessuno'\nupdate temp..StatCons set ClasseUtente    = (select top 1 classe      from temp..Tecnici where Codice = UtenteAssegnato) where ClasseUtente = ''\nupdate temp..StatCons set NomeUtente      = (select top 1 Descrizione from temp..Tecnici where Codice = UtenteAssegnato) where NomeUtente   = ''\nupdate temp..StatCons set TipoUtente      = (select top 1 Tipo        from temp..Tecnici where Codice = UtenteAssegnato) where TipoUtente   = ''\nupdate temp..StatCons set classeutente    = 'Web' where nomeutente = 'Nicola Trevisan' and origtipo = 'oce' and classeutente = ''\nupdate temp..StatCons set ClasseDocumento = ClasseUtente      where ClasseUtente in ('Alluminio Ferro','Legno PVC','Web','Prodotto Finito','Punto Vendita') and ClasseDocumento = '' and nomeutente != 'Nicola Trevisan' and nomeutente != 'Enrico Moretto'\nupdate temp..StatCons set ClasseDocumento = 'Punto Vendita'   where (DocTipo like '%B' or OrigTipo like '%B') and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Utensileria'     where ClasseDocumento = '' and TipoUtente = 'M'\nupdate temp..StatCons set ClasseDocumento = 'Legno PVC'       where NomeUtente = 'Enrico Moretto'  and SettoreCliente = 'PVC - LEGNO' and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where NomeUtente = 'Enrico Moretto'  and SettoreCliente = 'ALLUMINIO - FERRO' and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Web'             where NomeUtente = 'Enrico Moretto'  and SettoreCliente = 'WEB' and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Legno PVC'       where NomeUtente = 'Nicola Trevisan' and SettoreCliente = 'PVC - LEGNO' and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where NomeUtente = 'Nicola Trevisan' and SettoreCliente = 'ALLUMINIO - FERRO' and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Web'             where NomeUtente = 'Nicola Trevisan' and SettoreCliente = 'WEB' and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Legno PVC'       where NomeUtente = 'Susi Kurzen' and NomeAgente <> 'WEB - Susi' and SettoreCliente = 'PVC - LEGNO' and ClasseDocumento != 'Punto Vendita'\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where NomeUtente = 'Susi Kurzen' and NomeAgente <> 'WEB - Susi' and SettoreCliente = 'ALLUMINIO - FERRO' and ClasseDocumento != 'Punto Vendita'\nupdate temp..StatCons set ClasseDocumento = 'Utensileria'     where NomeUtente = 'Susi Kurzen' and NomeAgente <> 'WEB - Susi' and SettoreCliente = 'UTENSILERIA E COMPLEMENTI' and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Web'             where NomeUtente = 'Susi Kurzen' and NomeAgente <> 'WEB - Susi' and SettoreCliente = 'WEB' and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Legno PVC'       where NomeUtente = 'Roberta Attanasi' and SettoreCliente = 'PVC - LEGNO'\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where NomeUtente = 'Roberta Attanasi' and SettoreCliente = 'ALLUMINIO - FERRO'\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where NomeUtente = 'Vanessa Tronchin' and InizioTrasporto >= '20200901' and ClasseDocumento != 'Punto Vendita'\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where NomeUtente = 'Vanessa Tronchin' and InizioTrasporto >= '20200901' and ClasseDocumento != 'Punto Vendita'\nupdate temp..StatCons set ClasseDocumento = 'Termag'          where CodiceFornitore = 'F   620'\nupdate temp..StatCons set ClasseDocumento = 'Utensileria'     where SettoreCliente = 'UTENSILERIA E COMPLEMENTI'    and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Legno PVC'       where SettoreCliente = 'PVC - LEGNO'\t\t\t        and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where SettoreCliente = 'ALLUMINIO - FERRO'\t\t    and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Web'             where SettoreCliente = 'WEB'\t\t\t\t\t        and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Legno PVC'       where SettoreCliente = 'PVC - LEGNO'\t\t\t        and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where SettoreCliente = 'ALLUMINIO - FERRO'\t\t    and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set ClasseDocumento = 'Web'             where SettoreCliente = 'WEB'\t\t\t\t\t        and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set ClasseDocumento = 'Prodotto Finito' where CategoriaFornitore = 'PROD. FINITO'             and ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Utensileria'     where ClasseDocumento = ''\nupdate temp..StatCons set ClasseDocumento = 'Prodotto Finito' where CodiceAgente in ('A    46','A    52','A    62') and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set ClasseDocumento = 'Punto Vendita'   where CodiceAgente in ('A     4','A    99','A   100') and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set ClasseDocumento = 'Web'             where CodiceAgente in ('A    50') and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set ClasseDocumento = 'Alluminio Ferro' where CodiceAgente in ('A    61') and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set ClasseDocumento = 'Legno PVC'       where CodiceAgente in ('A    60') and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set ClasseDocumento = 'Termag'          where CodiceAgente in ('A    53') and ClasseDocumento = 'Utensileria'\nupdate temp..StatCons set UtenteAssegnato = DocCreatore, NomeUtente = '', ClasseUtente = '', TipoUtente = '' where TipoOrdine = 'Prenota e ritira'\nupdate temp..StatCons set UtenteAssegnato = OrigCreatore, NomeUtente = '', ClasseUtente = '', TipoUtente = '' where TipoOrdine = 'Prenota e ritira' and AnnoTrasporto >= 2021 and OrigCreatore in ('BAS','Claudio.ba','CRI','Cristiano','SAM','Samuel.durigon','FAB','Fabio','GIA','Giancarlo.l','NIC','Nicola','VAL','Valentino.vedelago')\nupdate temp..StatCons set ClasseUtente = (select top 1 classe      from temp..Tecnici where Codice = UtenteAssegnato) where ClasseUtente = ''\nupdate temp..StatCons set NomeUtente   = (select top 1 Descrizione from temp..Tecnici where Codice = UtenteAssegnato) where NomeUtente   = ''\nupdate temp..StatCons set TipoUtente   = (select top 1 Tipo        from temp..Tecnici where Codice = UtenteAssegnato) where TipoUtente   = ''\nupdate temp..StatCons set UtenteMappaBanco   = (select top 1 Banco        from temp..Tecnici where Codice = UtenteAssegnato) where UtenteMappaBanco   = ''\ndelete from temp..StatCons where Articolo in ('0011','0012','0013','0014','0015')\nupdate temp..StatCons set cdc = 'Alluminio Ferro' where NomeUtente = 'Vanessa Tronchin' and InizioTrasporto >= '20200901' and ClasseDocumento != 'Punto Vendita'\nupdate temp..StatCons set cdc = 'Alluminio Ferro', ClasseDocumento = 'Alluminio Ferro' where NomeUtente = 'Massimo Morello' and InizioTrasporto >= '20210405' and ClasseDocumento != 'Punto Vendita'\nupdate temp..StatCons set cdc = 'WEB', ClasseDocumento = 'WEB' where NomeUtente = 'Massimo Morello' and InizioTrasporto >= '20210101' and OrigTipo = 'OCE'\nupdate temp..StatCons set cdc = 'WEB', ClasseDocumento = 'WEB' where NomeUtente = 'Sonia Sarnari' and InizioTrasporto >= '20210101' and OrigTipo = 'OCE'\nupdate temp..StatCons set cdc = 'Waterproof', ClasseDocumento = 'Waterproof' where NomeUtente in ('Paolo Traverso', 'Alessio Vecchiato') and year(InizioTrasporto) >= 2020\nupdate temp..StatCons set cdc = 'Waterproof', ClasseDocumento = 'Waterproof' where NomeUtente in ('Paolo Traverso', 'Alessio Vecchiato') and year(InizioTrasporto) >= 2020\nupdate temp..StatCons set cdc = 'Waterproof', ClasseDocumento = 'Waterproof' where cdc = 'Prodotto Finito' and CodiceFornitore in ('F   616','F     1','F   404','F  7516','F   406','F   978','F   446','F   448','F   267','F  7512') and year(InizioTrasporto) < 2020\nupdate temp..StatCons set Extra1 = 'Waterproof' where cdc in ('Prodotto Finito','Waterproof') and CodiceFornitore in ('F   616','F     1','F  7516','F   978','F  8345','F   404','F   446','F   448','F   406','F   409','F   104','F  8423','F  7512','F  8482','F  8829')\nupdate temp..StatCons set Extra2 = 'Waterproof' where NomeUtente in ('Paolo Traverso','Alessio Vecchiato')\nupdate temp..StatCons set cdc = 'Waterproof', ClasseDocumento = 'Waterproof' where DocProgressivo in (select IDTESTA from colfert..EXTRATESTEDOC where TipoOrdine = 16) and year(InizioTrasporto) >= 2021\nupdate temp..StatCons set cdc = 'Waterproof', ClasseDocumento = 'Waterproof' where OrigProgressivo in (select IDTESTA from colfert..EXTRATESTEDOC where TipoOrdine = 16) and year(InizioTrasporto) >= 2021\nupdate temp..StatCons set Cdc                = ClasseDocumento where Cdc   = ''\nupdate temp..StatCons set Cdc                = ClasseDocumento where Cdc != ClasseDocumento",
    "dir0001.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith source as (\nselect distinct a.CdC as 'Settore',\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.CdC = a.CdC  and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.CdC = a.CdC  and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.CdC = a.CdC  and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as TotaleNetto,\n(isnull((select sum (Provvigione)                from temp..StatCons b where b.CdC = a.CdC  and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.CdC = a.CdC  and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.CdC = a.CdC  and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as Margine\nfrom temp..StatCons a\n)\nSelect '' as St, Settore as Settore,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tProvvigione as Provvigione,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc\nfrom source\norder by 1,2",
    "dir0001.02": "declare @anno int;\ndeclare @mese int;\nset @anno = <anno>;\nset @mese = <mese>;\nwith source as (\nselect distinct a.ClasseUtente as ClasseUtente, a.NomeUtente as Utente,\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.ClasseUtente = a.ClasseUtente and b.NomeUtente = a.NomeUtente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.ClasseUtente = a.ClasseUtente and b.NomeUtente = a.NomeUtente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.ClasseUtente = a.ClasseUtente and b.NomeUtente = a.NomeUtente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as TotaleNetto,\n(isnull((select sum (Provvigione)                from temp..StatCons b where b.ClasseUtente = a.ClasseUtente and b.NomeUtente = a.NomeUtente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.ClasseUtente = a.ClasseUtente and b.NomeUtente = a.NomeUtente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.ClasseUtente = a.ClasseUtente and b.NomeUtente = a.NomeUtente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Margine\nfrom temp..StatCons a\n)\nSelect ClasseUtente as ClasseUtente, Utente as Utente,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tProvvigione as Provvigione,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc\nfrom source\nwhere Quantita != 0\norder by 1,2",
    "dir0001.03": "declare @anno int;\ndeclare @mese int;\nset @anno = <anno>;\nset @mese = <mese>;\nwith source as (\nselect distinct a.SettoreCliente as SettoreCliente, a.CodiceCliente + ' - ' + a.NomeCliente as Cliente,\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.SettoreCliente = a.SettoreCliente and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.SettoreCliente = a.SettoreCliente and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.SettoreCliente = a.SettoreCliente and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as TotaleNetto,\n(isnull((select sum (Provvigione)                from temp..StatCons b where b.SettoreCliente = a.SettoreCliente and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.SettoreCliente = a.SettoreCliente and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.SettoreCliente = a.SettoreCliente and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Margine\nfrom temp..StatCons a\n)\nSelect SettoreCliente as SettoreCliente, Cliente as Cliente,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tProvvigione as Provvigione,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc\nfrom source\nwhere Quantita != 0\norder by 1,2",
    "dir0001.04": "declare @anno int;\ndeclare @mese int;\nset @anno = <anno>;\nset @mese = <mese>;\nwith source as (\nselect distinct a.CodiceAgente + ' - ' + a.NomeAgente as Agente, a.CdC as Settore,\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as TotaleNetto,\n(isnull((select sum (Provvigione)                from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto =  @mese and b.AnnoTrasporto = @anno),0)) as Margine\nfrom temp..StatCons a\n)\nSelect Agente as Agente, Settore as Settore,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tProvvigione as Provvigione,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc\nfrom source\nwhere Quantita != 0\norder by 1,2",
    "dir0001.05": "declare @anno int;\ndeclare @mese int;\nset @anno = <anno>;\nset @mese = <mese>;\nwith source as (\nselect distinct a.pagamento as Pagamento, a.CodiceCliente + ' - ' + a.NomeCliente as Cliente,\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as TotaleNetto,\n(isnull((select sum (Provvigione)                from temp..StatCons b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Margine\nfrom temp..StatCons a\n)\nSelect Pagamento as Pagamento, Cliente as Cliente,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tProvvigione as Provvigione,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc\nfrom source\nwhere Quantita != 0\norder by 1,2",
    "dir0001.06": "declare @anno int;\ndeclare @mese int;\nset @anno = <anno>;\nset @mese = <mese>;\nwith source as (\nselect distinct a.Vettore as Vettore, a.Provincia as Provincia,\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as TotaleNetto,\n(isnull((select sum (Provvigione)                from temp..StatCons b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Margine\nfrom temp..StatCons a\n)\nSelect Vettore as Vettore, Provincia as Provincia,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tProvvigione as Provvigione,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc\nfrom source\nwhere Quantita != 0\norder by 1,2",
    "dir0001.07": "declare @anno int;\ndeclare @mese int;\nset @anno = <anno>;\nset @mese = <mese>;\nwith source as (\nselect distinct a.GruppoArticolo as GruppoArticolo, a.Articolo + ' - ' + a.Descrizione as Articolo,\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.GruppoArticolo = a.GruppoArticolo and b.Articolo = a.Articolo and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.GruppoArticolo = a.GruppoArticolo and b.Articolo = a.Articolo and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.GruppoArticolo = a.GruppoArticolo and b.Articolo = a.Articolo and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as TotaleNetto,\n(isnull((select sum (Provvigione)                from temp..StatCons b where b.GruppoArticolo = a.GruppoArticolo and b.Articolo = a.Articolo and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.GruppoArticolo = a.GruppoArticolo and b.Articolo = a.Articolo and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.GruppoArticolo = a.GruppoArticolo and b.Articolo = a.Articolo and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Margine\nfrom temp..StatCons a\n)\nSelect GruppoArticolo as GruppoArticolo, Articolo as Articolo,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tProvvigione as Provvigione,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc\nfrom source\nwhere Quantita != 0\norder by 1,2",
    "dir0001.08": "declare @anno int;\ndeclare @mese int;\nset @anno = <anno>;\nset @mese = <mese>;\nwith source as (\nselect distinct a.CategoriaFornitore as CategoriaFornitore, a.CodiceFornitore + ' - ' + a.NomeFornitore as Fornitore,\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.CategoriaFornitore= a.CategoriaFornitore and b.CodiceFornitore = a.CodiceFornitore and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.CategoriaFornitore= a.CategoriaFornitore and b.CodiceFornitore = a.CodiceFornitore and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.CategoriaFornitore= a.CategoriaFornitore and b.CodiceFornitore = a.CodiceFornitore and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as TotaleNetto,\n(isnull((select sum (Provvigione)                from temp..StatCons b where b.CategoriaFornitore= a.CategoriaFornitore and b.CodiceFornitore = a.CodiceFornitore and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.CategoriaFornitore= a.CategoriaFornitore and b.CodiceFornitore = a.CodiceFornitore and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.CategoriaFornitore= a.CategoriaFornitore and b.CodiceFornitore = a.CodiceFornitore and b.MeseTrasporto = @mese and b.AnnoTrasporto = @anno),0)) as Margine\nfrom temp..StatCons a\n)\nSelect CategoriaFornitore as CategoriaFornitore, Fornitore as Fornitore,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tProvvigione as Provvigione,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc\nfrom source\nwhere Quantita != 0\norder by 1,2",
    "dir0002.cellclick": "select * from stats..consegnato where <rowfilter> <colfilter>",
    "dir0002.01": "with source as (\nselect distinct a.CodiceAgente + ' - ' + a.NomeAgente as Agente, a.CdC as Settore,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto =  1 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m01,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  2 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m02,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  3 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m03,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  4 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m04,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  5 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m05,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  6 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m06,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  7 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m07,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  8 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m08,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  9 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m09,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto = 10 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m0a,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto = 11 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m0b,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto = 12 and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as m0c,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC                          and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as a0,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto =  1 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m11,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  2 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m12,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  3 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m13,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  4 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m14,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  5 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m15,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  6 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m16,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  7 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m17,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  8 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m18,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto =  9 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m19,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto = 10 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m1a,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.Mesetrasporto = 11 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m1b,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC and b.MeseTrasporto = 12 and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as m1c,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CdC = a.CdC                          and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as a1\nfrom temp..StatCons a\n)\nselect Agente, Settore,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast(a0  as float) as AnnoPrecedente,\n\t   '' as Sep,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast(a1  as float) as AnnoCorrente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast(a1  - a0  as float) as DiffTotaleAnno, cast(coalesce(round(((a1 /nullif(a0,0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "dir0003.02": "declare @minset int;\nselect @minset = min(SettimanaTrasporto) from temp..StatCons where MeseTrasporto = <mese> and AnnoTrasporto = <anno>;\nselect distinct a.CdC as 'Settore',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC  and b.MeseTrasporto = <mese> and b.AnnoTrasporto = <anno> and b.SettimanaTrasporto = @minset+0),0)) as float) as PrimaSettimana,\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC  and b.MeseTrasporto = <mese> and b.AnnoTrasporto = <anno> and b.SettimanaTrasporto = @minset+1),0)) as float) as SecondaSettimana,\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC  and b.MeseTrasporto = <mese> and b.AnnoTrasporto = <anno> and b.SettimanaTrasporto = @minset+2),0)) as float) as TerzaSettimana,\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC  and b.MeseTrasporto = <mese> and b.AnnoTrasporto = <anno> and b.SettimanaTrasporto = @minset+3),0)) as float) as QuartaSettimana,\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC  and b.MeseTrasporto = <mese> and b.AnnoTrasporto = <anno> and b.SettimanaTrasporto = @minset+4),0)) as float) as QuintaSettimana,\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC  and b.MeseTrasporto = <mese> and b.AnnoTrasporto = <anno> and b.SettimanaTrasporto = @minset+5),0)) as float) as SestaSettimana\nfrom temp..StatCons a\norder by 1",
    "dir0003.01": "select CodiceAgente + ' - ' +  NomeAgente as Agente, CategoriaCliente, SettoreCliente, CodiceCliente + ' - ' +  NomeCliente as Cliente, cast(sum(NettoRiga) as float) as Importo\nfrom temp..StatCons\nwhere InizioTrasporto >= dateadd(day,-1,   datefromparts(year(GetDate())-1, month(getDate()), day(GetDate())) ) and InizioTrasporto < cast(GetDate() as Date)\ngroup by CodiceAgente + ' - ' +  NomeAgente, CategoriaCliente, SettoreCliente, CodiceCliente + ' - ' +  NomeCliente\norder by 1,2,3,4",
    "dir0004": "with firsttab as(\nselect b.CodiceAgente + ' - ' + b.NomeAgente as Agente, b.CodiceCliente + ' - ' + b.NomeCliente as Cliente, b.MeseTrasporto as Mese, b.AnnoTrasporto As Anno, sum(b.Quantita) as Quantita\nfrom temp..StatCons b\nwhere b.Articolo in\n('473','47301','473016','47301690D','47301690S','4730190D','4730190S','47301K','473B16','473B1680BBBD','473B1680BBBS','473B1680BBTD','473B1680BBTS','473B1680MTTD','473B1680MTTS','473B1685BBBD','473B1685BBBS','473B1685BBTD','473B1685BBTS','473B1685MTTD','473B1685MTTS','473B1690BBBD','473B1690BBBS','473B1690BBTD','473B1690BBTS','473B1690MTTD','473B1690MTTS','473C16903030D','473C16903030S','473C16903131D','473C16903131S','473C16903535D','473C16903535S','473C16903830D','473C16903830S','473000000000000000','4730000000000000000','473E1690D','473E1690S','473E16F','473E16K','473EK','473EK90D','473EK90S','473F0','473F1','473J16','473J17','473M15','473M16','473M1680D','473M1680S','473M1685D','473M1685S','473M1690D','473M1690S','473M16D','473M16D2','473M16D3','473M16F','473M17','473M17D','473M18','473M180','473M185D','473M185S','473M18F','473M190D','473M190S','473M1D','473M1D2','473M1F','473M1K','473M2','473M2D','473M2D2','473M6','473M600','473M690D','473M690S','473M6D','473M6F','473M7','473MIX','473MIXF','473MNT6000','473S16','473V6090240ABDX','473V6090240ABSX','473VIP20','473VIP60','473VIP60F','473VIP70','473VIP70F')\nand b.InizioTrasporto >= '<fromdate>' and b.InizioTrasporto <= '<todate>'\ngroup by b.CodiceAgente + ' - ' + b.NomeAgente, b.CodiceCliente + ' - ' + b.NomeCliente,  b.MeseTrasporto, b.AnnoTrasporto\n)\nselect distinct f.Agente, f.Cliente,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  0-1) / 12) and mese = ((month('<fromdate>') +  0-1) % 12)+1)  ,0) as float) as m01,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  1-1) / 12) and mese = ((month('<fromdate>') +  1-1) % 12)+1)  ,0) as float) as m02,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  2-1) / 12) and mese = ((month('<fromdate>') +  2-1) % 12)+1)  ,0) as float) as m03,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  3-1) / 12) and mese = ((month('<fromdate>') +  3-1) % 12)+1)  ,0) as float) as m04,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  4-1) / 12) and mese = ((month('<fromdate>') +  4-1) % 12)+1)  ,0) as float) as m05,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  5-1) / 12) and mese = ((month('<fromdate>') +  5-1) % 12)+1)  ,0) as float) as m06,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  6-1) / 12) and mese = ((month('<fromdate>') +  6-1) % 12)+1)  ,0) as float) as m07,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  7-1) / 12) and mese = ((month('<fromdate>') +  7-1) % 12)+1)  ,0) as float) as m08,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  8-1) / 12) and mese = ((month('<fromdate>') +  8-1) % 12)+1)  ,0) as float) as m09,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') +  9-1) / 12) and mese = ((month('<fromdate>') +  9-1) % 12)+1)  ,0) as float) as m10,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') + 10-1) / 12) and mese = ((month('<fromdate>') + 10-1) % 12)+1)  ,0) as float) as m11,\ncast(isnull((select q.quantita from firsttab q where q.Cliente = f.Cliente and q.Agente = f.Agente  and Anno = year('<fromdate>') + ((month('<fromdate>') + 11-1) / 12) and mese = ((month('<fromdate>') + 11-1) % 12)+1)  ,0) as float) as m12\nfrom firsttab f\norder by 1,2",
    "dir0005": "declare @anno int = <anno>;\ndeclare @firsab DateTime;\nselect @firsab = case when datepart(weekday,DATEFROMPARTS(@anno,1,1))=7 then DATEFROMPARTS(@anno,1,1) else dateadd(dd,7-(datepart(weekday,DATEFROMPARTS(@anno,1,1))),DATEFROMPARTS(@anno,1,1)) end;\n\nwith source as (\nselect distinct a.CdC as 'Settore', a.NomeUtente as 'Utente',\n(isnull((select sum (Quantita)                   from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.GiornoSettimana = 7 and b.AnnoTrasporto = @anno),0)) as Quantita,\n(isnull((select sum (PrezzoUnitLordo * Quantita) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.GiornoSettimana = 7 and b.AnnoTrasporto = @anno),0)) as TotaleLordo,\n(isnull((select sum (NettoRiga)                  from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.GiornoSettimana = 7 and b.AnnoTrasporto = @anno),0)) as TotaleNetto,\n--(isnull((select sum (Provvigione)                from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.GiornoSettimana = 7 and b.AnnoTrasporto = @anno),0)) as Provvigione,\n(isnull((select sum (CostoUltimoTot)             from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.GiornoSettimana = 7 and b.AnnoTrasporto = @anno),0)) as Costo,\n(isnull((select sum (MargineTot)                 from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.GiornoSettimana = 7 and b.AnnoTrasporto = @anno),0)) as Margine,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  0 * 7,@firsab)),0)) as TotSab01,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  1 * 7,@firsab)),0)) as TotSab02,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  2 * 7,@firsab)),0)) as TotSab03,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  3 * 7,@firsab)),0)) as TotSab04,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  4 * 7,@firsab)),0)) as TotSab05,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  5 * 7,@firsab)),0)) as TotSab06,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  6 * 7,@firsab)),0)) as TotSab07,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  7 * 7,@firsab)),0)) as TotSab08,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  8 * 7,@firsab)),0)) as TotSab09,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd,  9 * 7,@firsab)),0)) as TotSab10,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 10 * 7,@firsab)),0)) as TotSab11,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 11 * 7,@firsab)),0)) as TotSab12,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 12 * 7,@firsab)),0)) as TotSab13,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 13 * 7,@firsab)),0)) as TotSab14,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 14 * 7,@firsab)),0)) as TotSab15,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 15 * 7,@firsab)),0)) as TotSab16,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 16 * 7,@firsab)),0)) as TotSab17,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 17 * 7,@firsab)),0)) as TotSab18,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 18 * 7,@firsab)),0)) as TotSab19,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 19 * 7,@firsab)),0)) as TotSab20,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 20 * 7,@firsab)),0)) as TotSab21,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 21 * 7,@firsab)),0)) as TotSab22,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 22 * 7,@firsab)),0)) as TotSab23,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 23 * 7,@firsab)),0)) as TotSab24,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 24 * 7,@firsab)),0)) as TotSab25,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 25 * 7,@firsab)),0)) as TotSab26,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 26 * 7,@firsab)),0)) as TotSab27,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 27 * 7,@firsab)),0)) as TotSab28,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 28 * 7,@firsab)),0)) as TotSab29,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 29 * 7,@firsab)),0)) as TotSab30,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 30 * 7,@firsab)),0)) as TotSab31,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 31 * 7,@firsab)),0)) as TotSab32,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 32 * 7,@firsab)),0)) as TotSab33,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 33 * 7,@firsab)),0)) as TotSab34,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 34 * 7,@firsab)),0)) as TotSab35,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 35 * 7,@firsab)),0)) as TotSab36,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 36 * 7,@firsab)),0)) as TotSab37,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 37 * 7,@firsab)),0)) as TotSab38,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 38 * 7,@firsab)),0)) as TotSab39,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 39 * 7,@firsab)),0)) as TotSab40,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 40 * 7,@firsab)),0)) as TotSab41,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 41 * 7,@firsab)),0)) as TotSab42,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 42 * 7,@firsab)),0)) as TotSab43,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 43 * 7,@firsab)),0)) as TotSab44,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 44 * 7,@firsab)),0)) as TotSab45,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 45 * 7,@firsab)),0)) as TotSab46,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 46 * 7,@firsab)),0)) as TotSab47,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 47 * 7,@firsab)),0)) as TotSab48,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 48 * 7,@firsab)),0)) as TotSab49,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 49 * 7,@firsab)),0)) as TotSab50,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 50 * 7,@firsab)),0)) as TotSab51,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 51 * 7,@firsab)),0)) as TotSab52,\n(isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.InizioTrasporto = dateadd(dd, 52 * 7,@firsab)),0)) as TotSab53\nfrom temp..StatCons a\nWhere TipoUtente = 'B'\n)\nSelect Settore as Settore, Utente as Utente,\n--\tformat(Quantita   ,'N','it-it') as Quantita,\n\tTotaleLordo as TotaleLordo,\n\tcast  (coalesce(-(TotaleNetto-TotaleLordo)/nullif(TotaleLordo,0)*100,0) as int) as Sconto,\n\tTotaleNetto as TotaleNetto,\n\tCosto       as Costo,\n\tMargine     as Margine,\n\tcast  (coalesce((Margine/nullif(TotaleNetto,0))*100,0) as int) as MargPerc,\n\t         TotSab01,TotSab02,TotSab03,TotSab04,TotSab05,TotSab06,TotSab07,TotSab08,TotSab09,\n\tTotSab10,TotSab11,TotSab12,TotSab13,TotSab14,TotSab15,TotSab16,TotSab17,TotSab18,TotSab19,\n\tTotSab20,TotSab21,TotSab22,TotSab23,TotSab24,TotSab25,TotSab26,TotSab27,TotSab28,TotSab29,\n\tTotSab30,TotSab31,TotSab32,TotSab33,TotSab34,TotSab35,TotSab36,TotSab37,TotSab38,TotSab39,\n\tTotSab40,TotSab41,TotSab42,TotSab43,TotSab44,TotSab45,TotSab46,TotSab47,TotSab48,TotSab49,\n\tTotSab50,TotSab51,TotSab52,TotSab53\nfrom source\nwhere TotaleNetto > 0\norder by 1,2",
    "dir0007a": "drop table temp..tempgiacda;\ndrop table temp..tempgiaca;",
    "dir0007b": "select s.codart, p.FORNPREFACQ, sum(s.GIACENZA * s.QTA1UM) as giac1, isnull((select top 1 q.IMPORTOTOTNETTOEURO / q.QTA1UM from colfert..STORICOMAG q where q.TIPODOC in ('dfa','dfd','dfb','dfr') and s.CODART = q.codart order by q.DATAMOV desc),0) as costo\ninto temp..tempgiacda\nfrom STORICOMAG s inner join colfert..ANAGRAFICAARTICOLIPROD p on (p.AnnoTrasporto = 2018 and s.CODART = p.CODICEART)\nwhere s.DATAMOV <= '<fromdate>'\ngroup by s.CODART, p.FORNPREFACQ",
    "dir0007c": "select s.codart, p.FORNPREFACQ, sum(s.GIACENZA * s.QTA1UM) as giac1, isnull((select top 1 q.IMPORTOTOTNETTOEURO / q.QTA1UM from colfert..STORICOMAG q where q.TIPODOC in ('dfa','dfd','dfb','dfr') and s.CODART = q.codart order by q.DATAMOV desc),0) as costo\ninto temp..tempgiaca\nfrom STORICOMAG s inner join colfert..ANAGRAFICAARTICOLIPROD p on (p.AnnoTrasporto = 2018 and s.CODART = p.CODICEART)\nwhere s.DATAMOV <= '<todate>'\ngroup by s.CODART, p.FORNPREFACQ",
    "dir0007.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nset @adata = dateadd(day,1,@adata);\nwith a as (\nselect distinct a.CODCONTO, a.DSCCONTO1,\n(select sum(c.NettoRiga     ) from temp..StatCons c where c.InizioTrasporto >= @dadata and c.InizioTrasporto < @adata and c.CodiceFornitore = a.CODCONTO) as Imponibile,\n(select sum(c.CostoUltimoTot) from temp..StatCons c where c.InizioTrasporto >= @dadata and c.InizioTrasporto < @adata and c.CodiceFornitore = a.CODCONTO) as Costo,\n(select sum(c.MargineTot    ) from temp..StatCons c where c.InizioTrasporto >= @dadata and c.InizioTrasporto < @adata and c.CodiceFornitore = a.CODCONTO) as Margine,\n(select sum(t.SEGNO * r.TOTNETTORIGAEURO) from TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC < @adata and t.TIPODOC in ('dfa','dfd','dfb','dfr') and r.CODART != '' and t.CODCLIFOR = a.CODCONTO) as Acquistato,\n(select sum(m.giac1 * m.costo) from temp..tempgiacda m where m.fornprefacq = a.codconto) as GiacenzaIniziale,\n(select sum(m.giac1 * m.costo) from temp..tempgiaca  m where m.fornprefacq = a.codconto) as GiacenzaFinale\nfrom ANAGRAFICACF a\n)\nselect a.CODCONTO as 'CodFornitore', a.DSCCONTO1 as 'NomeFornitore', round(cast(isnull(a.Imponibile,0) as float),2) as Imponibile, round(cast(isnull(a.Costo,0) as float),2) as Costo,\nround(cast(isnull(a.Margine,0) as float),2) as margine, round(cast(isnull(a.Acquistato,0) as float),2) as Acquistato,\nround(cast(isnull(GiacenzaIniziale,0) as float),2) as GiacenzaIniziale, round(cast(isnull(GiacenzaFinale,0) as float),2) as GiacenzaFinale\nfrom a\nwhere Imponibile != 0  or Acquistato != 0\norder by 1",
    "dir0007.02": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nset @adata = dateadd(day,1,@adata);\nwith a as (\nselect distinct a.CODCONTO, a.DSCCONTO1, s.CODICE,\n(select sum(c.NettoRiga     ) from temp..StatCons c where c.InizioTrasporto >= @dadata and c.InizioTrasporto < @adata and c.Articolo = s.CODICE) as Imponibile,\n(select sum(c.CostoUltimoTot) from temp..StatCons c where c.InizioTrasporto >= @dadata and c.InizioTrasporto < @adata and c.Articolo = s.CODICE) as Costo,\n(select sum(c.MargineTot    ) from temp..StatCons c where c.InizioTrasporto >= @dadata and c.InizioTrasporto < @adata and c.Articolo = s.CODICE) as Margine,\n(select sum(t.SEGNO * r.TOTNETTORIGAEURO) from TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC < @adata and t.TIPODOC in ('dfa','dfd','dfb','dfr') and r.CODART = s.CODICE) as Acquistato,\n(select sum(m.giac1 * m.costo) from temp..tempgiacda m where m.Codart = s.Codice) as GiacenzaIniziale,\n(select sum(m.giac1 * m.costo) from temp..tempgiaca  m where m.Codart = s.Codice) as GiacenzaFinale\nfrom ANAGRAFICAARTICOLI s inner join colfert..ANAGRAFICAARTICOLIPROD p on (p.AnnoTrasporto = 2018 and s.CODICE = p.CODICEART) inner join colfert..ANAGRAFICACF a on p.FORNPREFACQ = a.CODCONTO\n)\nselect a.codice, a.CODCONTO as 'CodFornitore', a.DSCCONTO1 as 'NomeFornitore', round(cast(isnull(a.Imponibile,0) as float),2) as Imponibile, round(cast(isnull(a.Costo,0) as float),2) as Costo,\nround(cast(isnull(a.Margine,0) as float),2) as margine, round(cast(isnull(a.Acquistato,0) as float),2) as Acquistato,\nround(cast(isnull(GiacenzaIniziale,0) as float),2) as GiacenzaIniziale, round(cast(isnull(GiacenzaFinale,0) as float),2) as GiacenzaFinale\nfrom a\nwhere Imponibile != 0  or Acquistato != 0\norder by 2,1",
    "dir0008.01": "with a as(\nselect distinct c.CodiceCliente, c.NomeCliente, c.CodiceFornitore, c.NomeFornitore,\n(select cast(isnull(sum(a.NettoRiga)     ,0) as float) from temp..StatCons a where a.CodiceCliente = c.CodiceCliente and a.CodiceFornitore = c.CodiceFornitore and a.AnnoTrasporto = year(GetDate()) - 1 and a.MeseTrasporto < month(GetDate()) ) as vendutoFSMAP,\n(select cast(isnull(sum(a.CostoUltimoTot),0) as float) from temp..StatCons a where a.CodiceCliente = c.CodiceCliente and a.CodiceFornitore = c.CodiceFornitore and a.AnnoTrasporto = year(GetDate()) - 1 and a.MeseTrasporto < month(GetDate()) ) as costoFSMAP,\n(select cast(isnull(sum(a.MargineTot)    ,0) as float) from temp..StatCons a where a.CodiceCliente = c.CodiceCliente and a.CodiceFornitore = c.CodiceFornitore and a.AnnoTrasporto = year(GetDate()) - 1 and a.MeseTrasporto < month(GetDate()) ) as margineFSMAP,'' as nothing,\n(select cast(isnull(sum(a.NettoRiga)     ,0) as float) from temp..StatCons a where a.CodiceCliente = c.CodiceCliente and a.CodiceFornitore = c.CodiceFornitore and a.AnnoTrasporto = year(GetDate()) - 0 and a.MeseTrasporto < month(GetDate()) ) as vendutoFSMAC,\n(select cast(isnull(sum(a.CostoUltimoTot),0) as float) from temp..StatCons a where a.CodiceCliente = c.CodiceCliente and a.CodiceFornitore = c.CodiceFornitore and a.AnnoTrasporto = year(GetDate()) - 0 and a.MeseTrasporto < month(GetDate()) ) as costoFSMAC,\n(select cast(isnull(sum(a.MargineTot)    ,0) as float) from temp..StatCons a where a.CodiceCliente = c.CodiceCliente and a.CodiceFornitore = c.CodiceFornitore and a.AnnoTrasporto = year(GetDate()) - 0 and a.MeseTrasporto < month(GetDate()) ) as margineFSMAC\nfrom temp..StatCons c\nwhere CodiceCliente = '<cardcode>'\n)\nselect  a.CodiceCliente, a.NomeCliente, a.CodiceFornitore, a.NomeFornitore,\nround(a.vendutoFSMAP,2) as vendutoFSMAP, round(a.costoFSMAP,2) as costoFSMAP, round(a.margineFSMAP,2) as margineFSMAP, case when a.vendutoFSMAP = 0 then 0 else round(a.margineFSMAP / a.vendutoFSMAP * 100,0) end as marginePerc, case when a.costoFSMAP = 0 then 0 else round(a.margineFSMAP / a.costoFSMAP * 100,0) end as ricaricoPerc,\nround(a.vendutoFSMAC,2) as vendutoFSMAC, round(a.costoFSMAC,2) as costoFSMAC, round(a.margineFSMAC,2) as margineFSMAC, case when a.vendutoFSMAC = 0 then 0 else round(a.margineFSMAC / a.vendutoFSMAC * 100,0) end as marginePerc, case when a.costoFSMAC = 0 then 0 else round(a.margineFSMAC / a.costoFSMAC * 100,0) end as ricaricoPerc,\nround(a.vendutoFSMAC - a.vendutoFSMAP,2) as 'DiffAC-AP', case when a.vendutoFSMAC = 0 then 0 else round((a.vendutoFSMAC - a.vendutoFSMAP) / a.vendutoFSMAC * 100,0) end as Margineperc\nfrom a\norder by 3",
    "com0001.01": "with source as (\nselect extra1 as Mag, Cdc,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect case when a.Magazzino = 'MAGVA' then 'MAGVA' else 'MAG01' end as extra1, a.cdc, case when a.Anno = year(getdate()) then 'AC' when a.Anno = year(getdate()) - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(totriga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1\ngroup by a.Magazzino, a.cdc, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect Mag as Mag, Cdc as Settore,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.02": "with source as (\nselect ClasseUtente, NomeUtente,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.ClasseUtente, a.NomeUtente, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(TotRiga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1\ngroup by a.ClasseUtente, a.NomeUtente, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect ClasseUtente, NomeUtente,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.03": "with source as (\nselect Settore, Cliente,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.Settore, a.CodiceCliente + ' - ' + a.RagioneSociale as Cliente, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(TotRiga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1\ngroup by a.Settore, a.CodiceCliente + ' - ' + a.RagioneSociale, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect Settore, Cliente,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.04": "with source as (\nselect Agente, Settore,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.CodiceAgente + ' - ' + a.NomeAgente as Agente, a.CdC as Settore, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(TotRiga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1\ngroup by a.CodiceAgente + ' - ' + a.NomeAgente, a.CdC, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect Agente, Settore,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.05": "with source as (\nselect distinct a.pagamento as Pagamento, a.CodiceCliente + ' - ' + a.NomeCliente as Cliente,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  1 and b.Anno = <anno> - 1),0)) as m01,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  2 and b.Anno = <anno> - 1),0)) as m02,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  3 and b.Anno = <anno> - 1),0)) as m03,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  4 and b.Anno = <anno> - 1),0)) as m04,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  5 and b.Anno = <anno> - 1),0)) as m05,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  6 and b.Anno = <anno> - 1),0)) as m06,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  7 and b.Anno = <anno> - 1),0)) as m07,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  8 and b.Anno = <anno> - 1),0)) as m08,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  9 and b.Anno = <anno> - 1),0)) as m09,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese = 10 and b.Anno = <anno> - 1),0)) as m0a,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese = 11 and b.Anno = <anno> - 1),0)) as m0b,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese = 12 and b.Anno = <anno> - 1),0)) as m0c,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>'                 and b.Anno = <anno> - 1),0)) as a0,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  1 and b.Anno = <anno> - 0),0)) as m11,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  2 and b.Anno = <anno> - 0),0)) as m12,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  3 and b.Anno = <anno> - 0),0)) as m13,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  4 and b.Anno = <anno> - 0),0)) as m14,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  5 and b.Anno = <anno> - 0),0)) as m15,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  6 and b.Anno = <anno> - 0),0)) as m16,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  7 and b.Anno = <anno> - 0),0)) as m17,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  8 and b.Anno = <anno> - 0),0)) as m18,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese =  9 and b.Anno = <anno> - 0),0)) as m19,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese = 10 and b.Anno = <anno> - 0),0)) as m1a,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese = 11 and b.Anno = <anno> - 0),0)) as m1b,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>' and b.Mese = 12 and b.Anno = <anno> - 0),0)) as m1c,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.pagamento = a.pagamento and b.CodiceCliente = a.CodiceCliente and b.extra1 = '<mag>'                          and b.Anno = <anno> - 0),0)) as a1\nfrom stats..consegnato a\n)\nselect Pagamento, Cliente,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast(a1  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast(a0  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast(a1  - a0  as float) as DiffTotaleAnno, cast(coalesce(round(((a1 /nullif(a0,0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.06": "with source as (\nselect distinct a.Vettore as Vettore, a.Provincia as Provincia,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  1 and b.Anno = <anno> - 1),0)) as m01,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  2 and b.Anno = <anno> - 1),0)) as m02,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  3 and b.Anno = <anno> - 1),0)) as m03,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  4 and b.Anno = <anno> - 1),0)) as m04,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  5 and b.Anno = <anno> - 1),0)) as m05,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  6 and b.Anno = <anno> - 1),0)) as m06,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  7 and b.Anno = <anno> - 1),0)) as m07,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  8 and b.Anno = <anno> - 1),0)) as m08,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  9 and b.Anno = <anno> - 1),0)) as m09,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese = 10 and b.Anno = <anno> - 1),0)) as m0a,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese = 11 and b.Anno = <anno> - 1),0)) as m0b,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese = 12 and b.Anno = <anno> - 1),0)) as m0c,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>'                 and b.Anno = <anno> - 1),0)) as a0,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  1 and b.Anno = <anno> - 0),0)) as m11,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  2 and b.Anno = <anno> - 0),0)) as m12,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  3 and b.Anno = <anno> - 0),0)) as m13,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  4 and b.Anno = <anno> - 0),0)) as m14,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  5 and b.Anno = <anno> - 0),0)) as m15,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  6 and b.Anno = <anno> - 0),0)) as m16,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  7 and b.Anno = <anno> - 0),0)) as m17,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  8 and b.Anno = <anno> - 0),0)) as m18,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese =  9 and b.Anno = <anno> - 0),0)) as m19,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese = 10 and b.Anno = <anno> - 0),0)) as m1a,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese = 11 and b.Anno = <anno> - 0),0)) as m1b,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>' and b.Mese = 12 and b.Anno = <anno> - 0),0)) as m1c,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.Vettore = a.Vettore and b.Provincia = a.Provincia and b.extra1 = '<mag>'                 and b.Anno = <anno> - 0),0)) as a1\nfrom stats..consegnato a\n)\nselect Vettore, Provincia,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast(a1  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast(a0  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast(a1  - a0  as float) as DiffTotaleAnno, cast(coalesce(round(((a1 /nullif(a0,0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.07": "with source as (\nselect Gruppo, Articolo,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.Gruppo, a.Articolo + ' - ' + a.Descrizione as Articolo, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(TotRiga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1\ngroup by a.Gruppo, a.Articolo + ' - ' + a.Descrizione, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect Gruppo, Articolo,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.08": "with source as (\nselect CategoriaFornitore, Fornitore,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.CategoriaFornitore, a.CodiceFornitore + ' - ' + a.NomeFornitore as Fornitore, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(TotRiga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1\ngroup by a.CategoriaFornitore, a.CodiceFornitore + ' - ' + a.NomeFornitore, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect CategoriaFornitore, Fornitore,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.09": "select u.Descrizione as Operatore, year(datadoc) as Anno, month(datadoc) as Mese, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('ocv','ocw','ocd') and year(datadoc) = <anno> and month(datadoc) = <mese> --and tipo = 'M'\ngroup by u.Descrizione, year(datadoc), month(datadoc)\norder by 1",
    "com0001.10": "select u.classe as Operatore, year(datadoc) as Anno, month(datadoc) as Mese, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join temp..Tecnici u on w.ND_UTECREAZ = u.Codice\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('ocv','ocw','ocd') and year(datadoc) = <anno> and month(datadoc) = <mese> --and tipo = 'M'\ngroup by u.classe, year(datadoc), month(datadoc)\norder by 1",
    "com0001.11": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith source as (\nselect distinct a.CdC as 'Settore', NomeUtente As Utente,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.Magazzino = '<mag>' and b.DataDoc >= @dadata and b.DataDoc <= @adata - 1),0)) as ConsPeriodoCorr,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.NomeUtente = a.NomeUtente and b.Magazzino = '<mag>' and b.DataDoc >= @dadata-365 and b.DataDoc <= @adata-365 - 1),0)) as ConsPeriodoPrec\nfrom stats..consegnato a\n)\nselect Settore, Utente,\n       cast(ConsPeriodoCorr as float) as ConsPeriodoCorr,\n       cast(ConsPeriodoPrec as float) as ConsPeriodoPrec,\n       cast(ConsPeriodoCorr - ConsPeriodoPrec as float) as Diff   , cast(coalesce(round(((ConsPeriodoCorr/nullif(ConsPeriodoPrec,0))-1)*100,0),0) as int) as DiffPerc\nfrom source\nwhere ConsPeriodoCorr != 0 or ConsPeriodoPrec != 0\norder by 1,2",
    "com0001.12": "select u.Descrizione as Operatore, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('ocv','ocw','ocd') and datadoc >= '<fromdate>' and datadoc <= '<todate>'\ngroup by u.Descrizione\norder by 1",
    "com0001.13": "with source as (\nselect distinct a.CdC as CdC, a.CodiceFornitore + ' - ' + a.NomeFornitore as Fornitore,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  1 and b.Anno = <anno> - 1),0)) as m01,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  2 and b.Anno = <anno> - 1),0)) as m02,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  3 and b.Anno = <anno> - 1),0)) as m03,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  4 and b.Anno = <anno> - 1),0)) as m04,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  5 and b.Anno = <anno> - 1),0)) as m05,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  6 and b.Anno = <anno> - 1),0)) as m06,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  7 and b.Anno = <anno> - 1),0)) as m07,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  8 and b.Anno = <anno> - 1),0)) as m08,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  9 and b.Anno = <anno> - 1),0)) as m09,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese = 10 and b.Anno = <anno> - 1),0)) as m0a,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese = 11 and b.Anno = <anno> - 1),0)) as m0b,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese = 12 and b.Anno = <anno> - 1),0)) as m0c,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>'                 and b.Anno = <anno> - 1),0)) as a0,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  1 and b.Anno = <anno> - 0),0)) as m11,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  2 and b.Anno = <anno> - 0),0)) as m12,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  3 and b.Anno = <anno> - 0),0)) as m13,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  4 and b.Anno = <anno> - 0),0)) as m14,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  5 and b.Anno = <anno> - 0),0)) as m15,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  6 and b.Anno = <anno> - 0),0)) as m16,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  7 and b.Anno = <anno> - 0),0)) as m17,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  8 and b.Anno = <anno> - 0),0)) as m18,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese =  9 and b.Anno = <anno> - 0),0)) as m19,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese = 10 and b.Anno = <anno> - 0),0)) as m1a,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese = 11 and b.Anno = <anno> - 0),0)) as m1b,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>' and b.Mese = 12 and b.Anno = <anno> - 0),0)) as m1c,\n(isnull((select sum (TotRiga) from stats..consegnato b where b.CdC = a.CdC and b.CodiceFornitore = a.CodiceFornitore and b.Magazzino = '<mag>'                 and b.Anno = <anno> - 0),0)) as a1\nfrom stats..consegnato a\n)\nselect CdC, Fornitore,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast(a1  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast(a0  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast(a1  - a0  as float) as DiffTotaleAnno, cast(coalesce(round(((a1 /nullif(a0,0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0001.14": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect u.Classe as ClasseUtente, u.Descrizione as NomeUtente, isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) as Imponibile, count(distinct t.PROGRESSIVO) as NrTeste, count(distinct cast(r.idtesta as nvarchar) + '|' + cast(r.idriga as nvarchar)) as NrRighe\nfrom colfert..testedocumenti t inner join colfert..EXTRATESTEDOC x on t.PROGRESSIVO = x.IDTESTA inner join temp..Tecnici u on x.ND_UTECREAZ = u.Codice left outer join RIGHEDOCUMENTI r on t.progressivo = r.IDTESTA and r.TIPORIGA = 'n'\nwhere t.TIPODOC like 'o%' and t.CODCLIFOR like 'c%' and t.esercizio = 2019\ngroup by u.Classe, u.Descrizione\norder by 1,2",
    "com0001.15": "select t.CODCLIFOR as Codice, a.DSCCONTO1 as RagioneSociale, cast( sum(r.QTA1MAG) as float) as Punti\nfrom colfert..TESTEDOCUMENTI t\n inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n inner join colfert..ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\nwhere t.TIPODOC like 'oc%' and r.CODART = 'yelpuntiposa'\ngroup by t.CODCLIFOR, a.DSCCONTO1\norder by 1",
    "com0001.16": "select s.CODAGENTE1 as Codice, a.DSCAGENTE as Agente, cast( sum(r.QTA1MAG) as float) as Punti\nfrom colfert..TESTEDOCUMENTI t\n inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n inner join colfert..ANAGRAFICARISERVATICF s on t.CODCLIFOR = s.CODCONTO and s.ESERCIZIO = YEAR(getdate())\n inner join ANAGRAFICAAGENTI a on s.CODAGENTE1 = a.CODAGENTE\nwhere t.TIPODOC like 'oc%' and r.CODART = 'yelpuntiposa'\ngroup by s.CODAGENTE1, a.DSCAGENTE\norder by 1",
    "com0001.17": "select s.CODAGENTE1 as Codice, a.DSCAGENTE as Agente, t.CODCLIFOR as CodCliente, c.DSCCONTO1 as RagioneSociale, cast( sum(r.QTA1MAG) as float) as PuntiTotali,\n(select isnull(cast(sum(x.QTA1MAG) as float),0) from TESTEDOCUMENTI w inner join RIGHEDOCUMENTI x on w.PROGRESSIVO = x.IDTESTA where w.TIPODOC like 'oc%' and x.CODART = 'yelpuntiposa' and x.QTA1MAG >0 and w.CODCLIFOR = t.CODCLIFOR) as PuntiDati,\n(select isnull(cast(sum(x.QTA1MAG) as float),0) from TESTEDOCUMENTI w inner join RIGHEDOCUMENTI x on w.PROGRESSIVO = x.IDTESTA where w.TIPODOC like 'oc%' and x.CODART = 'yelpuntiposa' and x.QTA1MAG <0 and w.CODCLIFOR = t.CODCLIFOR) as PuntiScalati\nfrom colfert..TESTEDOCUMENTI t\n inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n inner join colfert..ANAGRAFICARISERVATICF s on t.CODCLIFOR = s.CODCONTO and s.ESERCIZIO = YEAR(getdate())\n inner join ANAGRAFICAAGENTI a on s.CODAGENTE1 = a.CODAGENTE\n inner join ANAGRAFICACF c on t.CODCLIFOR = c.CODCONTO\nwhere t.TIPODOC like 'oc%' and r.CODART = 'yelpuntiposa'\ngroup by s.CODAGENTE1, a.DSCAGENTE, t.CODCLIFOR, c.DSCCONTO1\norder by 1,3",
    "com0001.18": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @cliente nvarchar(20) = '<cardcode>';\nselect a.Articolo,a.Descrizione, a.CodiceFornitore, a.NomeFornitore, a.Categoria, a.Gruppo, a.Aextra0 as Gestione,\n       a.QtaPerConfezione as QtaScatola,\n       cast(sum(a.Quantita) as float) as Quantità,\n       count(distinct a.ProgressivoOrd) as NrOrdini,\n       cast(sum(a.TotRiga) as float) as VendutoPeriodo\nfrom stats..consegnato a\nwhere\na.CodiceCliente = @cliente\nand a.DataDoc >= @dadata\nand a.dataDoc <= @adata\ngroup by a.Articolo,a.Descrizione,a.CodiceFornitore,a.Categoria,a.Gruppo,a.Aextra0,a.NomeFornitore,a.QtaPerConfezione\norder by 1",
    "com0001.19": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect NomeUtente, CodiceAgente, NomeAgente, CodiceCliente, RagioneSociale, TipoDoc, NumeroDoc, DataDoc, Anno, Articolo, Descrizione, UM, PrezzoUnitLordo, ScontoEsteso, PrezzoUnitNetto, Quantita, TotRiga, CostoUltimoTot, MargineTot\nfrom stats..consegnato\n--where CodiceCliente in ('C310035','C311203','C310026','C  4294','C310018','C310259','C310021','C310072','C310015','C310019','C310020','C310197','C310439','C310764','C310247','C310688','C310525','C310820','C310235')\nwhere CodiceCliente in ('C310235','C310035','C311203','C310026','C  4294','C310018','C310259','C310021','C310072','C310015','C310019','C310020','C310197','C310439','C107464','C310525','C310820','C311261','C310688','C310334','C310169')\nand Articolo in ('0784353','0784202000','0784203000','0784284','0784285','0784301K','07843550001','07843550002','07843560001','07843560002','0783963','0783963376','0784153','0784153376','0784153410','0784153500','0784153600','0784154','0784154376','0784154410','0784154500','0784156','0784156376','0784156410','0784156500','0784420000001SG','0783955000 (01)','0781061','0784711','0784711376','0784711380','0784711390','0784711410','0784711411','0784711430','0784711500','0784711530','0784711680','07843540001','07843540002','0782168000K','0784274','0784274000K','0784278010N','0784278000K','0784282000K','0782191K','0782195K','0782189000K','0782165010','0782165000K','0784045000K','0782188000K','0784728','0781029000K','0783954000','0784153','0784153376','0784153410','0784153500','0784153600','0784154','0784154376','0784154410','0784154500','0784155','0784155376','0784155410','0784155500','0784156','0784156376','0784156410','0784156500','0784274','0784274000K','0782168000K','0782191K','0782195K','0782189000K','0782165010','0782165000K','0784045000K','0782188000K','0784278010N','0784728','07801201','07801200201','07801203761','07801203801','07801203901','07801204101','07801204301','07801204901','07801205001','07801202','07801200202','07801203762','07801203802','07801203902','07801204102','07801204302','07801204902','07801205002','07801221','07801223761','07801224101','07801224301','07801225001','07801222','07801223762','07801224102','078014411','078014441011','078014443011','078014450011','078014421','078014437621','078014441021','078014450021','07843540001','07843540002','0783524590N','0783524542N','078114901','078114937601','078114950001','078119102','078119137602','078119141002','078119150002','0781350K','0784358','0784019000K','0784024K','0781352000K','0781356000K','0781347K','0781362000K','0782111000K','0782111010N','0782114010','0782114000K','0782188000K','0782336010','0781348K','0781349K','0784031K','0784046000K','0784026000K','0784014000K','0782187010','0782187K')\nand DataDoc between @dadata and @adata",
    "com0001.20": "with source as (\nselect Magazzino as Mag, Cdc, NomeFornitore, NomeBuyer,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.Magazzino, a.cdc, a.NomeFornitore, a.NomeBuyer, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(a.totRiga) as impo\nfrom stats..consegnato a --inner join stats..Arts i on a.Articolo = i.CodiceArticolo\nwhere a.Anno >= <anno> - 1\ngroup by a.Magazzino, a.cdc, a.Anno, a.Mese, a.NomeFornitore, a.NomeBuyer\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect Mag as Mag, Cdc as Settore, NomeFornitore, NomeBuyer,\n       cast(m11 as float) as GennaioAC,\n       cast(m12 as float) as FebbraioAC,\n       cast(m13 as float) as MarzoAC,\n       cast(m14 as float) as AprileAC,\n       cast(m15 as float) as MaggioAC,\n       cast(m16 as float) as GiugnoAC,\n       cast(m17 as float) as LuglioAC,\n       cast(m18 as float) as AgostoAC,\n       cast(m19 as float) as SettembreAC,\n       cast(m1a as float) as OttobreAC,\n       cast(m1b as float) as NovembreAC,\n       cast(m1c as float) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as float) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as float) as GennaioAP,\n       cast(m02 as float) as FebbraioAP,\n       cast(m03 as float) as MarzoAP,\n       cast(m04 as float) as AprileAP,\n       cast(m05 as float) as MaggioAP,\n       cast(m06 as float) as GiugnoAP,\n       cast(m07 as float) as LuglioAP,\n       cast(m08 as float) as AgostoAP,\n       cast(m09 as float) as SettembreAP,\n       cast(m0a as float) as OttobreAP,\n       cast(m0b as float) as NovembreAP,\n       cast(m0c as float) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as float) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as float) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as float) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as float) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as float) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as float) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as float) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as float) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as float) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as float) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as float) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as float) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as float) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0002.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare\n\t  @dscok1 varchar(100) = 'ordine sbloccabile'\n\t, @dscok2 varchar(100) = 'ordine sbloccato'\n\t, @motivo1 varchar(100) = 'Ordine web inserito da cliente'\n\t, @motivo1ex varchar(100) = 'Ordine con campo Extratestedoc.Nota = CLI-'\n\t, @motivo2 varchar(100) = 'Ordine con righe omaggio'\n\t, @motivo3 varchar(100) = 'Ordine con check evasione totale attivo'\n\t, @motivo4 varchar(100) = 'Ordine con data consegna programmata (extratestedoc.DataAttivazioneOrd)'\n\t, @motivo5 varchar(100) = 'Ordine di tipo \"Prenota e ritira\"'\n\t, @motivo6 varchar(100) = 'Ordine con note aggiuntive (extratestedoc.NotaWeb)'\n\t, @motivo7 varchar(100) = 'Ordine con campo Extratestedoc.Nota compilato'\n\t, @motivo8 varchar(100) = 'Ordine con pagamento bloccante'\n\t, @motivo9 varchar(100) = 'Ordine con articoli non regolari o extramag.CalcAutDataConsegna = N'\n\t, @motivo9ex varchar(100) = 'Ordine con articoli non regolari o con extramag.CalcAutDataConsegna = N'\n\t, @motivo10 varchar(100) = 'Ordine con articoli con extramag.MagDisponibili <> MAG01'\n\t, @motivo11 varchar(100) = 'Ordine con articoli con extramag.tipolavorazione diverso da '''''\n\t, @motivo12 varchar(100) = 'Ordine con articoli con cilindri (relazioni articoli like ''PERS*'''\n\t, @motivo13 varchar(100) = 'Ordine con articoli aventi vendita a multipli'\n\t, @motivo14 varchar(100) = 'Ordine con articoli soggetti a promo'\n\t, @motivo15 varchar(100) = 'Ordine con articoli non disponibili'\n\t, @motivo16 varchar(100) = 'Ordine data consegna richiesta inferiore a disponibile'\nselect res.*\nfrom\n\t(select ESERCIZIO, TIPODOC, NUMERODOC, CONVERT(VARCHAR,DATADOC,103) AS DATAAD\n\t\t\t, CODCLIFOR, RAGSOCIALE, TESTATA, CONVERT(FLOAT, TOTIMPONIBILEEURO) AS TOTIMPONIBILE, Nota, NOTEALTRO, Nd_Web_Bloccato, BLOCCATO\n\t\t\t, (CASE when Tipo like @motivo1 + '%' then '1) ' + @motivo1 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo1ex + '%' then '1) ' + @motivo1 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo2 + '%' then '2) ' + @motivo2 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo3 + '%' then '3) ' + @motivo3 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo4 + '%' then '4) ' + @motivo4 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo5 + '%' then '5) ' + @motivo5 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo6 + '%' then '6) ' + @motivo6 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo7 + '%' then '7) ' + @motivo7 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo8 + '%' then '8) ' + @motivo8 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo9 + '%' then '9) ' + @motivo9 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo9ex + '%' then '9) ' + @motivo9 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo10 + '%' then '10) ' + @motivo10 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo11 + '%' then '11) ' + @motivo11 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo12 + '%' then '12) ' + @motivo12 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo13 + '%' then '13) ' + @motivo13 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo14 + '%' then '14) ' + @motivo14 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo15 + '%' then '15) ' + @motivo15 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo16 + '%' then '16) ' + @motivo16 else '' end)\n\t\t\t+ (CASE when Tipo like @dscok1 + '%' then '0) ' + @dscok2 else '' end)\n\t\t\t+ (CASE when Tipo like @dscok2 + '%' then '0) ' + @dscok2 else '' end)\n\t\t\t\tas Tipo\n\t\t\t, EvasioneTotale\n\t\t\t, ND_UTECREAZ\n\t\t\t, FlgInvioEmailCOrd\n\t\t\t, prg\n\t\t\t, InseritoDa = (case when charindex('-', Nota) >= 1 and charindex('-', Nota) <= 8 then\n\t\t\t\t\t\t\t(case when left(nota, charindex('-', Nota) - 1) = 'CLI' then\n\t\t\t\t\t\t\t\t'Cliente'\n\t\t\t\t\t\t\t else\n\t\t\t\t\t\t\t\t(case when left(nota,1) = 'A' then 'Agente' else 'Altro' end)\n\t\t\t\t\t\t\t end)\n\t\t\t\t\t\t  else\n\t\t\t\t\t\t\t'Altro'\n\t\t\t\t\t\t  end)\n\t\t\t--, TipoOrig\n\tfrom (SELECT ESERCIZIO, TIPODOC, NUMERODOC, DATADOC\n\t\t\t, right(notealtro,  len(notealtro ) - (CHARINDEX(' ', notealtro) + 22)) as TipoOrig\n\t\t\t, right(notealtro,  len(notealtro ) - (CHARINDEX(' ', notealtro) + 22)) as Tipo\n\t\t\t, CODCLIFOR, (SELECT DSCCONTO1 FROM ANAGRAFICACF WHERE CODCONTO = CODCLIFOR) AS RAGSOCIALE\n\t\t\t, 1 as TESTATA, TOTIMPONIBILEEURO, Nota, NOTEALTRO, EXTRATESTEDOC.Nd_Web_Bloccato, BLOCCATO\n\t\t\t, isnull(nd_evasionetotale, 'N') as EvasioneTotale\n\t\t\t, ND_UTECREAZ\n\t\t\t, FlgInvioEmailCOrd\n\t\t\t, progressivo prg\n\t\t\t--, *\n\t\tFROM TESTEDOCUMENTI T1 INNER JOIN EXTRATESTEDOC ON PROGRESSIVO = IDTESTA\n\t\twhere ESERCIZIO=year(getdate()) and TIPODOC = 'OCW' and DATADOC >= @dadata and DATADOC <= @adata) as ord\n\t) as res\norder by  prg  desc",
    "com0002.02": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare\n\t  @dscok1 varchar(100) = 'ordine sbloccabile'\n\t, @dscok2 varchar(100) = 'ordine sbloccato'\n\t, @motivo1 varchar(100) = 'Ordine web inserito da cliente'\n\t, @motivo1ex varchar(100) = 'Ordine con campo Extratestedoc.Nota = CLI-'\n\t, @motivo2 varchar(100) = 'Ordine con righe omaggio'\n\t, @motivo3 varchar(100) = 'Ordine con check evasione totale attivo'\n\t, @motivo4 varchar(100) = 'Ordine con data consegna programmata (extratestedoc.DataAttivazioneOrd)'\n\t, @motivo5 varchar(100) = 'Ordine di tipo \"Prenota e ritira\"'\n\t, @motivo6 varchar(100) = 'Ordine con note aggiuntive (extratestedoc.NotaWeb)'\n\t, @motivo7 varchar(100) = 'Ordine con campo Extratestedoc.Nota compilato'\n\t, @motivo8 varchar(100) = 'Ordine con pagamento bloccante'\n\t, @motivo9 varchar(100) = 'Ordine con articoli non regolari o extramag.CalcAutDataConsegna = N'\n\t, @motivo9ex varchar(100) = 'Ordine con articoli non regolari o con extramag.CalcAutDataConsegna = N'\n\t, @motivo10 varchar(100) = 'Ordine con articoli con extramag.MagDisponibili <> MAG01'\n\t, @motivo11 varchar(100) = 'Ordine con articoli con extramag.tipolavorazione diverso da '''''\n\t, @motivo12 varchar(100) = 'Ordine con articoli con cilindri (relazioni articoli like ''PERS*'''\n\t, @motivo13 varchar(100) = 'Ordine con articoli aventi vendita a multipli'\n\t, @motivo14 varchar(100) = 'Ordine con articoli soggetti a promo'\n\t, @motivo15 varchar(100) = 'Ordine con articoli non disponibili'\n\t, @motivo16 varchar(100) = 'Ordine data consegna richiesta inferiore a disponibile';\nwith ord as\n\t(select ESERCIZIO, TIPODOC, NUMERODOC, CONVERT(VARCHAR,DATADOC,103) AS DATAAD\n\t\t\t, CODCLIFOR, RAGSOCIALE, TESTATA, CONVERT(FLOAT, TOTIMPONIBILEEURO) AS TOTIMPONIBILE, Nota, NOTEALTRO, Nd_Web_Bloccato, BLOCCATO\n\t\t\t, (CASE when Tipo like @motivo1 + '%' then '1) ' + @motivo1 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo1ex + '%' then '1) ' + @motivo1 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo2 + '%' then '2) ' + @motivo2 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo3 + '%' then '3) ' + @motivo3 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo4 + '%' then '4) ' + @motivo4 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo5 + '%' then '5) ' + @motivo5 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo6 + '%' then '6) ' + @motivo6 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo7 + '%' then '7) ' + @motivo7 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo8 + '%' then '8) ' + @motivo8 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo9 + '%' then '9) ' + @motivo9 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo9ex + '%' then '9) ' + @motivo9 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo10 + '%' then '10) ' + @motivo10 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo11 + '%' then '11) ' + @motivo11 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo12 + '%' then '12) ' + @motivo12 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo13 + '%' then '13) ' + @motivo13 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo14 + '%' then '14) ' + @motivo14 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo15 + '%' then '15) ' + @motivo15 else '' end)\n\t\t\t+ (CASE when Tipo like @motivo16 + '%' then '16) ' + @motivo16 else '' end)\n\t\t\t+ (CASE when Tipo like @dscok1 + '%' then '0) ' + @dscok2 else '' end)\n\t\t\t+ (CASE when Tipo like @dscok2 + '%' then '0) ' + @dscok2 else '' end)\n\t\t\t\tas Tipo\n\t\t\t, EvasioneTotale\n\t\t\t, ND_UTECREAZ\n\t\t\t, FlgInvioEmailCOrd\n\t\t\t, prg\n\t\t\t, InseritoDa = (case when charindex('-', Nota) >= 1 and charindex('-', Nota) <= 8 then\n\t\t\t\t\t\t\t(case when left(nota, charindex('-', Nota) - 1) = 'CLI' then\n\t\t\t\t\t\t\t\t'Cliente'\n\t\t\t\t\t\t\t else\n\t\t\t\t\t\t\t\t(case when left(nota,1) = 'A' then 'Agente' else 'Altro' end)\n\t\t\t\t\t\t\t end)\n\t\t\t\t\t\t  else\n\t\t\t\t\t\t\t'Altro'\n\t\t\t\t\t\t  end)\n\t\t\t--, TipoOrig\n\tfrom (SELECT ESERCIZIO, TIPODOC, NUMERODOC, DATADOC\n\t\t\t, right(notealtro,  len(notealtro ) - (CHARINDEX(' ', notealtro) + 22)) as TipoOrig\n\t\t\t, right(notealtro,  len(notealtro ) - (CHARINDEX(' ', notealtro) + 22)) as Tipo\n\t\t\t, CODCLIFOR, (SELECT DSCCONTO1 FROM ANAGRAFICACF WHERE CODCONTO = CODCLIFOR) AS RAGSOCIALE\n\t\t\t, 1 as TESTATA, TOTIMPONIBILEEURO, Nota, NOTEALTRO, EXTRATESTEDOC.Nd_Web_Bloccato, BLOCCATO\n\t\t\t, isnull(nd_evasionetotale, 'N') as EvasioneTotale\n\t\t\t, ND_UTECREAZ\n\t\t\t, FlgInvioEmailCOrd\n\t\t\t, progressivo prg\n\t\t\t--, *\n\t\tFROM TESTEDOCUMENTI T1 INNER JOIN EXTRATESTEDOC ON PROGRESSIVO = IDTESTA\n\t\twhere ESERCIZIO=year(getdate()) and TIPODOC = 'OCW' and DATADOC >= @dadata and DATADOC <= @adata) as ord\n\t)\n--select * from ord\n--order by  prg  desc\nselect o.CODCLIFOR as CodiceCliente, o.RAGSOCIALE as RagioneSociale, r.CODAGENTE1 + ' - ' + r.DSCAGENTE as Agente, isnull(ced.dbo.referente(o.codclifor),o.nd_utecreaz) as Referente, o.Tipo, count(o.TESTATA) as NrOrdini\nfrom ord o\n     inner join colfert..ANARISERVATICF r on o.codclifor = r.CODCONTO\ngroup by o.CODCLIFOR, o.RAGSOCIALE, r.CODAGENTE1, r.DSCAGENTE, isnull(ced.dbo.referente(o.codclifor),o.nd_utecreaz), o.tipo",
    "com0002.03": "select CodiceAgente, NomeAgente, NomeUtente, CodiceCliente, RagioneSociale, TipoDoc, Anno, Mese, CodPagamento, sum(TotRiga) as Venduto\nfrom Stats..ordinato\nwhere Anno = <anno> and CodPagamento = 'ant'\ngroup by CodiceAgente, NomeAgente, NomeUtente, CodiceCliente, RagioneSociale, TipoDoc, Anno, Mese, CodPagamento\norder by 1, 3, 4",
    "com0002.04": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect d.CodiceAgente + ' - ' + d.NomeAgente as Agente, d.CodiceCliente + ' - ' + d.RagioneSociale as Cliente, --d.ReferenteLegno, d.ReferenteAlluminio,\n  case when d.Settore = 'PVC - LEGNO' then d.ReferenteLegno else d.ReferenteAlluminio end as Referente,\n  d.NomeFornitore,d.articolo, d.Descrizione, d.Sconto, d.ScontoEsteso as ScontoDelDocumento, d.PrezzoUnitNetto --, d.TotRiga\n  ,isnull(r.SCONTO_UNICO,'') as ScontoCliente\n  --, d.Settore\n  --case when replace(r.SCONTO_UNICO,' ','') = replace(d.ScontoEsteso,' ','') then '*' else '' end as ScontoRiservato\nfrom Stats..ordinato d\n  left outer join colfert..gestioneprezzi p on d.Articolo = p.CODART and d.CodiceCliente = CODCLIFOR and GETDATE() between p.INIZIOVALIDITA and p.FINEVALIDITA\n  left outer join COLFERT..GESTIONEPREZZIRIGHE r on p.progressivo = r.RIFPROGRESSIVO\nwhere d.Sconto >= 63.2\n  and d.datadoc between @dadata and @adata\n  and d.CodiceFornitore like '%<cardcode>%'\n  and d.Settore = 'PVC - LEGNO'\norder by 1,2",
    "com0002.05": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect d.CodiceAgente + ' - ' + d.NomeAgente as Agente, d.CodiceCliente + ' - ' + d.RagioneSociale as Cliente, --d.ReferenteLegno, d.ReferenteAlluminio,\n  case when d.Settore = 'PVC - LEGNO' then d.ReferenteLegno else d.ReferenteAlluminio end as Referente,\n  d.NomeFornitore,d.articolo, d.Descrizione, d.Sconto, d.ScontoEsteso as ScontoDelDocumento, d.PrezzoUnitNetto --, d.TotRiga\n  ,isnull(r.SCONTO_UNICO,'') as ScontoCliente\n  --, d.Settore\n  --case when replace(r.SCONTO_UNICO,' ','') = replace(d.ScontoEsteso,' ','') then '*' else '' end as ScontoRiservato\nfrom Stats..ordinato d\n  left outer join colfert..gestioneprezzi p on d.Articolo = p.CODART and d.CodiceCliente = CODCLIFOR and GETDATE() between p.INIZIOVALIDITA and p.FINEVALIDITA\n  left outer join COLFERT..GESTIONEPREZZIRIGHE r on p.progressivo = r.RIFPROGRESSIVO\nwhere d.Sconto >= 63.2\n  and d.datadoc between @dadata and @adata\n  and d.CodiceFornitore like '%<cardcode>%'\n  and d.Settore = 'ALLUMINIO - FERRO'\norder by 1,2",
    "com0002.06": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect d.TipoDoc, d.NumeroDoc, d.DataDoc, d.Anno, d.CodiceCliente, d.RagioneSociale, d.DocChiuso, t.Bloccato, sum(d.TotRiga) as Importo, d.CodPagamento, d.Pagamento, d.NomeAgente, d.NomeUtente\nfrom stats..ordinato d inner join colfert..TESTEDOCUMENTI t on d.Progressivo = t.PROGRESSIVO\nwhere d.tipodoc in ('ocv','ocw') and d.CodPagamento = 'ANT'\nand d.datadoc between @dadata and @adata\ngroup by d.TipoDoc, d.NumeroDoc, d.DataDoc, d.Anno, d.CodiceCliente, d.RagioneSociale, d.CodPagamento, d.Pagamento, d.NomeAgente, d.NomeUtente, d.DocChiuso, t.Bloccato\norder by 3",
    "com0002.07": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect Anno, DataDoc, CodiceCliente, RagioneSociale, CodiceAgente, NomeAgente, TipoOrdine, TipoDoc, NumeroDoc,\n  Articolo, Descrizione, UM, PrezzoUnitNetto, Quantita, TotRiga, CodiceFornitore, NomeFornitore, TipoRiga, ScontoEsteso, cast(MargineTot as decimal(15,2)) as MargineTot\nfrom stats..consegnato\nwhere TipoOrdine = 'Invenduti'\n      and datadoc between @dadata and @adata\norder by progressivo, idriga",
    "com0002.08": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect d.TipoDoc, d.NumeroDoc, d.DataDoc, d.Anno, d.CodiceCliente, d.RagioneSociale, d.DocChiuso, t.Bloccato, d.NomeAgente, d.NomeUtente, d.CodiceArticolo, d.Descrizione, d.Quantita, d.TotRiga as TotaleRiga\nfrom stats..ordinato d inner join colfert..TESTEDOCUMENTI t on d.Progressivo = t.PROGRESSIVO\nwhere d.TipoOrdine = 'Prenota e ritira Locker'\nand d.datadoc between @dadata and @adata\norder by d.progressivo, d.idriga",
    "com0002.09": "WITH agg AS (\n    SELECT\n        d.ClasseUtente,\n        d.NomeUtente,\n        d.Mese,\n\t\td.TipoDoc,\n        COUNT(DISTINCT d.progressivo) AS NumeroTeste,\n        SUM(d.totriga)              AS Importo\n    FROM stats..ordinato d\n    WHERE d.anno = <anno>\n      AND d.tipodoc IN ('ocv','ocw')\n      AND d.ClasseUtente IN ('Legno PVC','Alluminio Ferro')\n    GROUP BY d.ClasseUtente, d.NomeUtente, d.Mese, d.TipoDoc\n)\nSELECT\n    ClasseUtente,\n    NomeUtente,\n\tTipoDoc,\n\n    -- NumeroTeste per mese\n    ISNULL(SUM(CASE WHEN Mese =  1 THEN NumeroTeste END), 0) AS NrTesteGen,\n    ISNULL(SUM(CASE WHEN Mese =  2 THEN NumeroTeste END), 0) AS NrTesteFeb,\n    ISNULL(SUM(CASE WHEN Mese =  3 THEN NumeroTeste END), 0) AS NrTesteMar,\n    ISNULL(SUM(CASE WHEN Mese =  4 THEN NumeroTeste END), 0) AS NrTesteApr,\n    ISNULL(SUM(CASE WHEN Mese =  5 THEN NumeroTeste END), 0) AS NrTesteMag,\n    ISNULL(SUM(CASE WHEN Mese =  6 THEN NumeroTeste END), 0) AS NrTesteGiu,\n    ISNULL(SUM(CASE WHEN Mese =  7 THEN NumeroTeste END), 0) AS NrTesteLug,\n    ISNULL(SUM(CASE WHEN Mese =  8 THEN NumeroTeste END), 0) AS NrTesteAgo,\n    ISNULL(SUM(CASE WHEN Mese =  9 THEN NumeroTeste END), 0) AS NrTesteSet,\n    ISNULL(SUM(CASE WHEN Mese = 10 THEN NumeroTeste END), 0) AS NrTesteOtt,\n    ISNULL(SUM(CASE WHEN Mese = 11 THEN NumeroTeste END), 0) AS NrTesteNov,\n    ISNULL(SUM(CASE WHEN Mese = 12 THEN NumeroTeste END), 0) AS NrTesteDic,\n    ISNULL(SUM(CASE WHEN Mese >  0 THEN NumeroTeste END), 0) AS NrTesteTot,\n\n    -- Importo per mese\n    cast(ISNULL(SUM(CASE WHEN Mese =  1 THEN Importo END), 0) as decimal(15,2)) AS ImportoGen,\n    cast(ISNULL(SUM(CASE WHEN Mese =  2 THEN Importo END), 0) as decimal(15,2)) AS ImportoFeb,\n    cast(ISNULL(SUM(CASE WHEN Mese =  3 THEN Importo END), 0) as decimal(15,2)) AS ImportoMar,\n    cast(ISNULL(SUM(CASE WHEN Mese =  4 THEN Importo END), 0) as decimal(15,2)) AS ImportoApr,\n    cast(ISNULL(SUM(CASE WHEN Mese =  5 THEN Importo END), 0) as decimal(15,2)) AS ImportoMag,\n    cast(ISNULL(SUM(CASE WHEN Mese =  6 THEN Importo END), 0) as decimal(15,2)) AS ImportoGiu,\n    cast(ISNULL(SUM(CASE WHEN Mese =  7 THEN Importo END), 0) as decimal(15,2)) AS ImportoLug,\n    cast(ISNULL(SUM(CASE WHEN Mese =  8 THEN Importo END), 0) as decimal(15,2)) AS ImportoAgo,\n    cast(ISNULL(SUM(CASE WHEN Mese =  9 THEN Importo END), 0) as decimal(15,2)) AS ImportoSet,\n    cast(ISNULL(SUM(CASE WHEN Mese = 10 THEN Importo END), 0) as decimal(15,2)) AS ImportoOtt,\n    cast(ISNULL(SUM(CASE WHEN Mese = 11 THEN Importo END), 0) as decimal(15,2)) AS ImportoNov,\n    cast(ISNULL(SUM(CASE WHEN Mese = 12 THEN Importo END), 0) as decimal(15,2)) AS ImportoDic,\n    cast(ISNULL(SUM(CASE WHEN Mese >  0 THEN Importo END), 0) as decimal(15,2)) AS ImportoTot\n    -- Totali riga\n    --ISNULL(SUM(NumeroTeste), 0) AS NT_Totale,\n    --ISNULL(SUM(Importo),     0) AS Imp_Totale\nFROM agg\nGROUP BY ClasseUtente, NomeUtente, TipoDoc\nORDER BY ClasseUtente, NomeUtente, TipoDoc",
    "com0003.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct Descrizione as Utente, Classe as ClasseUtente, isnull(a.agente,'') as CodAgente, isnull(g.DSCAGENTE,'') as Agente,\n  isnull(( select cast(sum(d.TotRiga) as float) from stats..consegnato d where d.NomeUtente = u.Descrizione and d.CodiceAgente = a.agente and d.DataDoc >= @dadata and d.DataDoc <= @adata),0) as ConsegnatoPeriodo,\n  isnull(( select round(avg(d.Sconto),2) from stats..consegnato d where d.NomeUtente = u.Descrizione and d.CodiceAgente = a.agente and d.DataDoc >= @dadata and d.DataDoc <= @adata and d.CodGruppoProvv = 240 ),0) as ScontoMedio,\n  isnull(( select count(distinct d.CodiceCliente) from stats..consegnato d where d.NomeUtente = u.Descrizione and d.CodiceAgente = a.agente and d.DataDoc >= @dadata and d.DataDoc <= @adata ),0) as NrCliPeriodo,\n  (select count(distinct d.CodiceCliente) from stats..consegnato d where d.NomeUtente = u.Descrizione and d.CodiceAgente = a.agente and d.DataDoc >= @dadata and d.DataDoc <= @adata and TipoDocOrd = 'OCW' and OrigineExtranet = 'cliente') nrClientiCheUsanoExtranet,\n  isnull(( select count(distinct d.CodiceFornitore) from stats..consegnato d where d.NomeUtente = u.Descrizione and d.CodiceAgente = a.agente and d.DataDoc >= @dadata and d.DataDoc <= @adata),0) as NrForPeriodo,\n  (select count(*) from colfert..testedocumenti t inner join colfert..extratestedoc x on t.progressivo = x.idtesta inner join colfert..RIGHEDOCUMENTI r on x.idtesta = r.idtesta inner join colfert..NDTabTecnici c on x.ND_UTECREAZ = c.CodUtente and t.codagente1 = a.agente where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and c.descrizione = u.Descrizione and t.TIPODOC in (select doc from stats..docs where tipo = 'preventivo') ) as NrRighePreventivo,\n  (select count(*) from stats..ordinato d where d.DATADOC >= @dadata and d.DATADOC <= @adata and d.NomeUtente = u.Descrizione and d.CodiceAgente = a.agente) as NrRigheOrdiniCliente ,\n  (select count(*) from centralino..cdr t where (to_name = u.Descrizione or from_name = u.Descrizione) and t.start >= @dadata and t.start <= @adata and t.dest_type in (2,3,4) ) as TotaleChiamate,\n  (select colfert.dbo.piSecondsToTime(isnull(sum(t.duration),0)) from centralino..cdr t where (to_name = u.Descrizione or from_name = u.Descrizione) and t.start >= @dadata and t.start <= @adata and t.dest_type in (2,3,4) ) as DurataChiamate\nfrom stats..tecnici u left outer join ced..referagenti a on u.Descrizione = a.utente left outer join colfert..ANAGRAFICAAGENTI g on a.agente = g.CODAGENTE\norder by 1,3",
    "com0004.01": "declare @agente varchar(7) = '<agente>';\ndeclare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect CodiceAgente, NomeAgente, CodiceCliente, RagioneSociale, Cdc, cast(sum(TotRiga) as decimal(12,2)) as ImportoPeriodo\nfrom stats..consegnato\nwhere codiceagente = @agente and datadoc between @dadata and @adata\ngroup by codicecliente, ragionesociale, codiceagente, nomeagente, cdc\norder by 3,5 desc",
    "com0004.02": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith ground as\n(\nselect d.Gruppo, d.CategoriaArticolo, d.CategoriaStatistica, d.CodiceFornitore, d.NomeFornitore, d.CategoriaFornitore, d.Aextra0 as TipoGestione, count(*) as QuanteRigheSconfezionate,\n(\nselect count(*)\n  from stats..ordinato o\n  where d.Gruppo = o.gruppo and d.CategoriaArticolo = o.CategoriaArticolo and d.CategoriaStatistica = o.categoriastatistica\n        and d.CodiceFornitore = o.CodiceFornitore and d.NomeFornitore = o.nomefornitore and d.CategoriaFornitore = o.categoriafornitore\n        and d.Aextra0 = o.aextra0 and o.datadoc between @dadata and @adata\n) as QtaTotaleRighe\nfrom stats..ordinato d\nwhere cast(d.Quantita as int) % cast(d.QtaPerConfezione as int) != 0\n  and d.datadoc between @dadata and @adata\n  and cast(d.QtaPerConfezione as int) > 0\ngroup by d.Gruppo, d.CategoriaArticolo, d.CategoriaStatistica, d.CodiceFornitore, d.NomeFornitore, d.CategoriaFornitore, d.Aextra0\n)\nselect Gruppo, CategoriaArticolo, CategoriaStatistica, CodiceFornitore, NomeFornitore, CategoriaFornitore, TipoGestione, QuanteRigheSconfezionate, QtaTotaleRighe - QuanteRigheSconfezionate as QuanteRigheAConfezione\nfrom ground\norder by 4,1",
    "com0004.03": "with ground as (\nselect d.CodiceAgente, d.NomeAgente, d.CodiceCliente, d.RagioneSociale,\n (select isnull(SUM(c.TotRiga),0)    from Stats..fatturato  c where c.CodiceCliente = d.CodiceCliente and c.anno = year(getdate()) - 1 and c.Mese in (1,2,3)) as ConsegnatoAnnoPrecedenteTrim1,\n (select isnull(SUM(c.TotRiga),0)    from Stats..fatturato  c where c.CodiceCliente = d.CodiceCliente and c.anno = year(getdate()) - 0 and c.Mese in (1,2,3)) as ConsegnatoAnnoCorrenteTrim1,\n (select COUNT(distinct DataDoc)     from Stats..consegnato c where c.CodiceCliente = d.CodiceCliente and c.anno = year(getdate()) - 1 and c.Mese in (1,2,3)) as NrConsegneAnnoPrecedenteTrim1,\n (select COUNT(distinct DataDoc)     from Stats..consegnato c where c.CodiceCliente = d.CodiceCliente and c.anno = year(getdate()) - 0 and c.Mese in (1,2,3)) as NrConsegneAnnoCorrenteTrim1,\n (select COUNT(distinct Progressivo) from Stats..ordinato   c where c.CodiceCliente = d.CodiceCliente and c.anno = year(getdate()) - 1 and c.Mese in (1,2,3)) as NrOrdiniAnnoPrecedenteTrim1,\n (select COUNT(distinct Progressivo) from Stats..ordinato   c where c.CodiceCliente = d.CodiceCliente and c.anno = year(getdate()) - 0 and c.Mese in (1,2,3)) as NrOrdiniAnnoCorrenteTrim1,\n (select isnull(SUM(c.MargineTot),0) from Stats..fatturato  c where c.CodiceCliente = d.CodiceCliente and c.anno = year(getdate()) - 1 and c.Mese in (1,2,3)) as MargineAnnoPrecedenteTrim1,\n (select isnull(SUM(c.MargineTot),0) from Stats..fatturato  c where c.CodiceCliente = d.CodiceCliente and c.anno = year(getdate()) - 0 and c.Mese in (1,2,3)) as MargineAnnoCorrenteTrim1\nfrom Stats..consegnato d\ngroup by d.CodiceAgente, d.NomeAgente, d.CodiceCliente, d.RagioneSociale\n)\nselect CodiceAgente, NomeAgente, CodiceCliente, RagioneSociale,\n  round(ConsegnatoAnnoPrecedenteTrim1,2) as ConsegnatoAnnoPrecedenteTrim1, round(ConsegnatoAnnoCorrenteTrim1,2) as ConsegnatoAnnoCorrenteTrim1, round(ConsegnatoAnnoCorrenteTrim1 - ConsegnatoAnnoPrecedenteTrim1,2) as DifferenzaConsegnato, case when ConsegnatoAnnoPrecedenteTrim1 = 0 then 0.0 else round((ConsegnatoAnnoCorrenteTrim1 - ConsegnatoAnnoPrecedenteTrim1) / ConsegnatoAnnoPrecedenteTrim1 * 100,2) end as DifferenzaPercentualeConsegnato,\n  NrConsegneAnnoPrecedenteTrim1, NrConsegneAnnoCorrenteTrim1,  round(NrConsegneAnnoCorrenteTrim1 - NrConsegneAnnoPrecedenteTrim1,2) as DifferenzaConsegnato, case when NrConsegneAnnoPrecedenteTrim1 = 0 then 0.0 else round((NrConsegneAnnoCorrenteTrim1 - NrConsegneAnnoPrecedenteTrim1) / NrConsegneAnnoPrecedenteTrim1 * 100,2) end as DifferenzaPercentualeNrConsegn2,\n  NrOrdiniAnnoPrecedenteTrim1  , NrOrdiniAnnoCorrenteTrim1,  round(NrOrdiniAnnoCorrenteTrim1 - NrOrdiniAnnoPrecedenteTrim1,2) as DifferenzaConsegnato, case when NrOrdiniAnnoPrecedenteTrim1 = 0 then 0.0 else round((NrOrdiniAnnoCorrenteTrim1 - NrOrdiniAnnoPrecedenteTrim1) / NrOrdiniAnnoPrecedenteTrim1 * 100,2) end as DifferenzaPercentualeNrOrdini,\n  round(MargineAnnoPrecedenteTrim1,2) as MargineAnnoPrecedenteTrim1, round(MargineAnnoCorrenteTrim1,2) as MargineAnnoCorrenteTrim1, round(MargineAnnoCorrenteTrim1 - MargineAnnoPrecedenteTrim1,2) as DifferenzaConsegnato, case when MargineAnnoPrecedenteTrim1 = 0 then 0.0 else round((MargineAnnoCorrenteTrim1 - MargineAnnoPrecedenteTrim1) / MargineAnnoPrecedenteTrim1 * 100,2) end as DifferenzaPercentualeMargine\nfrom ground\nwhere ConsegnatoAnnoPrecedenteTrim1 != 0 or ConsegnatoAnnoCorrenteTrim1 != 0\norder by 1,3",
    "com0004.04": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.DataDoc, d.CodiceCliente, d.RagioneSociale, d.Settore, d.CodiceAgente, d.NomeAgente, d.TipoOrdine, d.TipoDoc, d.NumeroDoc, d.NomeUtente, d.Articolo, d.Descrizione, d.UM, d.Quantita, d.PrezzoUnitLordo, d.ScontoEsteso, d.PrezzoUnitNetto, d.TotRiga, d.CodiceFornitore, d.NomeFornitore, d.CategoriaFornitore, d.TipoRiga, o.Descrizione\nfrom Stats..ordinato d\n  left outer join COLFERT..EXTRARIGHEDOC x on x.IDTESTA = d.Progressivo and x.IDRIGA = d.IdRiga\n  left outer join COLFERT..NDTabTipiOmaggio o on x.TipoOmaggio = o.Codice\nwhere DataDoc between @dadata and @adata and d.TipoRiga = 'Omaggio'",
    "com0004.05": "declare @parm varchar(100) = '<cardcode>'\nselect\n  t.PROGRESSIVO as Progressivo, t.CODCLIFOR as CodiceCliente, a.RagioneSociale, a.Settore, a.CodiceAgente, a.NomeAgente, t.CODGRUPPOPREZZIMAG as Gruppo,\n  t.CODART as Articolo, i.DescrizioneArticolo, CAST(t.finevalidita as date) as FineValidita,\n  CAST(l.PREZZOEURO as float) as Listino, r.SCONTO_UNICO as ScontoParticolare\nfrom colfert..gestioneprezzi t\n  inner join colfert..gestioneprezzirighe r on t.progressivo = r.rifprogressivo\n  left outer join stats..clis a on t.CODCLIFOR = a.Codice\n  left outer join Stats..Arts i on t.CODART = i.CodiceArticolo\n  left outer join COLFERT..LISTINIARTICOLI l on t.CODART = l.CODART and l.NRLISTINO = 21\nwhere\n(\n  cast(t.CODGRUPPOPREZZIMAG as varchar) = @parm\n  or i.CodiceFornitore = @parm\n  or cast(i.CodGruppoPrz as varchar) = @parm\n  or (t.CODGRUPPOPREZZIMAG in (select codice from TABRAGGRUPPAPREZZI p where left(p.note,7) = @parm) )\n) and t.FINEVALIDITA > GETDATE() and t.CODCLIFOR not like 'f%'\norder by 7 desc, 8 asc",
    "com0004.06": "select c.Codice, c.RagioneSociale, c.Settore, c.NomeAgente, c.ReferenteLegno, c.ReferenteAlluminio,\n  (select isnull(SUM(o.TotRiga),0) from Stats..consegne o where o.Anno = year(getdate())-1 and o.CodiceCliente = c.Codice) as ConsegnatoAnnoPrecedente,\n  (select isnull(SUM(o.TotRiga),0) from Stats..ordini o where o.Anno = year(getdate())-1 and o.CodiceCliente = c.Codice and o.TipoDoc = 'OCW' and o.origineextranet = 'cliente') as OrdinatoAutonomoClienteAnnoPrecedente,\n  (select count(distinct o.Progressivo) from Stats..ordini o where o.Anno = year(getdate())-1 and o.CodiceCliente = c.Codice and o.TipoDoc = 'OCW' and o.origineextranet = 'cliente') as NrOrdiniAutonomiClienteAnnoPrecedente,\n  (select isnull(SUM(o.TotRiga),0) from Stats..consegne o where o.Anno = year(getdate())-0 and o.CodiceCliente = c.Codice) as ConsegnatoAnnoCorrente,\n  (select isnull(SUM(o.TotRiga),0) from Stats..ordini o where o.Anno = year(getdate())-0 and o.CodiceCliente = c.Codice and o.TipoDoc = 'OCW' and o.origineextranet = 'cliente') as OrdinatoAutonomoClienteAnnoCorrente,\n  (select count(distinct o.Progressivo) from Stats..ordini o where o.Anno = year(getdate())-0 and o.CodiceCliente = c.Codice and o.TipoDoc = 'OCW' and o.origineextranet = 'cliente') as NrOrdiniAutonomiClienteAnnoCorrente\nfrom stats..clis c\nwhere c.codice in (select CodiceCliente from stats..consegne where anno >= YEAR(getDate())-1)\norder by 1",
    "com0004.07": "select CodiceAgente + ' - ' + NomeAgente as Agente, CodiceCliente + ' - ' + RagioneSociale as Cliente, Anno,\n  SUM(TotRiga) as Consegnato, sum(CostoUltimoTot) as Costo, sum(MargineTot) as Margine,\n  count(distinct cast(DataDoc as nvarchar) + vettore) as NrConsegne\nfrom Stats..consegnato\nwhere Anno in (year(getdate()), year(GETDATE())-1) and Mese < 7\ngroup by CodiceAgente + ' - ' + NomeAgente, CodiceCliente + ' - ' + RagioneSociale, Anno\norder by 1,2, 3",
    "com0006.01": "with source as (\nselect extra1 as Mag, Cdc,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect case when a.Magazzino = 'MAGVA' then 'MAGVA' else 'MAG01' end as extra1, a.cdc, case when a.Anno = year(getdate()) then 'AC' when a.Anno = year(getdate()) - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(totriga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1 and a.TipoRiga = 'Normale'\ngroup by a.Magazzino, a.cdc, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect Mag as Mag, Cdc as Settore,\n       cast(m11 as decimal(15,2)) as GennaioAC,\n       cast(m12 as decimal(15,2)) as FebbraioAC,\n       cast(m13 as decimal(15,2)) as MarzoAC,\n       cast(m14 as decimal(15,2)) as AprileAC,\n       cast(m15 as decimal(15,2)) as MaggioAC,\n       cast(m16 as decimal(15,2)) as GiugnoAC,\n       cast(m17 as decimal(15,2)) as LuglioAC,\n       cast(m18 as decimal(15,2)) as AgostoAC,\n       cast(m19 as decimal(15,2)) as SettembreAC,\n       cast(m1a as decimal(15,2)) as OttobreAC,\n       cast(m1b as decimal(15,2)) as NovembreAC,\n       cast(m1c as decimal(15,2)) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as decimal(15,2)) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as decimal(15,2)) as GennaioAP,\n       cast(m02 as decimal(15,2)) as FebbraioAP,\n       cast(m03 as decimal(15,2)) as MarzoAP,\n       cast(m04 as decimal(15,2)) as AprileAP,\n       cast(m05 as decimal(15,2)) as MaggioAP,\n       cast(m06 as decimal(15,2)) as GiugnoAP,\n       cast(m07 as decimal(15,2)) as LuglioAP,\n       cast(m08 as decimal(15,2)) as AgostoAP,\n       cast(m09 as decimal(15,2)) as SettembreAP,\n       cast(m0a as decimal(15,2)) as OttobreAP,\n       cast(m0b as decimal(15,2)) as NovembreAP,\n       cast(m0c as decimal(15,2)) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as decimal(15,2)) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as decimal(15,2)) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as decimal(15,2)) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as decimal(15,2)) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as decimal(15,2)) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as decimal(15,2)) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as decimal(15,2)) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as decimal(15,2)) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as decimal(15,2)) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as decimal(15,2)) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as decimal(15,2)) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as decimal(15,2)) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as decimal(15,2)) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as decimal(15,2)) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0006.02": "with source as (\nselect ClasseUtente, NomeUtente,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.ClasseUtente, a.NomeUtente, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(TotRiga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1 and a.TipoRiga = 'Normale'\ngroup by a.ClasseUtente, a.NomeUtente, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect ClasseUtente, NomeUtente,\n       cast(m11 as decimal(15,2)) as GennaioAC,\n       cast(m12 as decimal(15,2)) as FebbraioAC,\n       cast(m13 as decimal(15,2)) as MarzoAC,\n       cast(m14 as decimal(15,2)) as AprileAC,\n       cast(m15 as decimal(15,2)) as MaggioAC,\n       cast(m16 as decimal(15,2)) as GiugnoAC,\n       cast(m17 as decimal(15,2)) as LuglioAC,\n       cast(m18 as decimal(15,2)) as AgostoAC,\n       cast(m19 as decimal(15,2)) as SettembreAC,\n       cast(m1a as decimal(15,2)) as OttobreAC,\n       cast(m1b as decimal(15,2)) as NovembreAC,\n       cast(m1c as decimal(15,2)) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as decimal(15,2)) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as decimal(15,2)) as GennaioAP,\n       cast(m02 as decimal(15,2)) as FebbraioAP,\n       cast(m03 as decimal(15,2)) as MarzoAP,\n       cast(m04 as decimal(15,2)) as AprileAP,\n       cast(m05 as decimal(15,2)) as MaggioAP,\n       cast(m06 as decimal(15,2)) as GiugnoAP,\n       cast(m07 as decimal(15,2)) as LuglioAP,\n       cast(m08 as decimal(15,2)) as AgostoAP,\n       cast(m09 as decimal(15,2)) as SettembreAP,\n       cast(m0a as decimal(15,2)) as OttobreAP,\n       cast(m0b as decimal(15,2)) as NovembreAP,\n       cast(m0c as decimal(15,2)) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as decimal(15,2)) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as decimal(15,2)) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as decimal(15,2)) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as decimal(15,2)) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as decimal(15,2)) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as decimal(15,2)) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as decimal(15,2)) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as decimal(15,2)) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as decimal(15,2)) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as decimal(15,2)) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as decimal(15,2)) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as decimal(15,2)) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as decimal(15,2)) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as decimal(15,2)) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0006.03": "with source as (\nselect Settore, Cliente,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.Settore, a.CodiceCliente + ' - ' + a.RagioneSociale as Cliente, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(TotRiga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1 and a.TipoRiga = 'Normale'\ngroup by a.Settore, a.CodiceCliente + ' - ' + a.RagioneSociale, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect Settore, Cliente,\n       cast(m11 as decimal(15,2)) as GennaioAC,\n       cast(m12 as decimal(15,2)) as FebbraioAC,\n       cast(m13 as decimal(15,2)) as MarzoAC,\n       cast(m14 as decimal(15,2)) as AprileAC,\n       cast(m15 as decimal(15,2)) as MaggioAC,\n       cast(m16 as decimal(15,2)) as GiugnoAC,\n       cast(m17 as decimal(15,2)) as LuglioAC,\n       cast(m18 as decimal(15,2)) as AgostoAC,\n       cast(m19 as decimal(15,2)) as SettembreAC,\n       cast(m1a as decimal(15,2)) as OttobreAC,\n       cast(m1b as decimal(15,2)) as NovembreAC,\n       cast(m1c as decimal(15,2)) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as decimal(15,2)) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as decimal(15,2)) as GennaioAP,\n       cast(m02 as decimal(15,2)) as FebbraioAP,\n       cast(m03 as decimal(15,2)) as MarzoAP,\n       cast(m04 as decimal(15,2)) as AprileAP,\n       cast(m05 as decimal(15,2)) as MaggioAP,\n       cast(m06 as decimal(15,2)) as GiugnoAP,\n       cast(m07 as decimal(15,2)) as LuglioAP,\n       cast(m08 as decimal(15,2)) as AgostoAP,\n       cast(m09 as decimal(15,2)) as SettembreAP,\n       cast(m0a as decimal(15,2)) as OttobreAP,\n       cast(m0b as decimal(15,2)) as NovembreAP,\n       cast(m0c as decimal(15,2)) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as decimal(15,2)) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as decimal(15,2)) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as decimal(15,2)) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as decimal(15,2)) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as decimal(15,2)) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as decimal(15,2)) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as decimal(15,2)) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as decimal(15,2)) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as decimal(15,2)) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as decimal(15,2)) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as decimal(15,2)) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as decimal(15,2)) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as decimal(15,2)) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as decimal(15,2)) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0006.04": "with source as (\nselect Agente, Settore,\n  isnull([AP1],0) as m01, isnull([AP2],0) as m02, isnull([AP3],0) as m03, isnull([AP4],0) as m04, isnull([AP5],0) as m05, isnull([AP6],0) as m06, isnull([AP7],0) as m07, isnull([AP8],0) as m08, isnull([AP9],0) as m09, isnull([AP10],0) as m0a, isnull([AP11],0) as m0b, isnull([AP12],0) as m0c,\n  isnull([AC1],0) as m11, isnull([AC2],0) as m12, isnull([AC3],0) as m13, isnull([AC4],0) as m14, isnull([AC5],0) as m15, isnull([AC6],0) as m16, isnull([AC7],0) as m17, isnull([AC8],0) as m18, isnull([AC9],0) as m19, isnull([AC10],0) as m1a, isnull([AC11],0) as m1b, isnull([AC12],0) as m1c\nfrom (\nselect a.CodiceAgente + ' - ' + a.NomeAgente as Agente, a.CdC as Settore, case when a.Anno = <anno> then 'AC' when a.Anno = <anno> - 1 then 'AP' end + cast(a.Mese as nvarchar) as trasporto, sum(TotRiga) as impo\nfrom stats..consegnato a\nwhere a.Anno >= <anno> - 1 and a.TipoRiga = 'Normale'\ngroup by a.CodiceAgente + ' - ' + a.NomeAgente, a.CdC, a.Anno, a.Mese\n) as ground\nPIVOT ( sum(impo) for trasporto in ([AC1],[AC2],[AC3],[AC4],[AC5],[AC6],[AC7],[AC8],[AC9],[AC10],[AC11],[AC12],[AP1],[AP2],[AP3],[AP4],[AP5],[AP6],[AP7],[AP8],[AP9],[AP10],[AP11],[AP12]) ) as compo\n)\nselect Agente, Settore,\n       cast(m11 as decimal(15,2)) as GennaioAC,\n       cast(m12 as decimal(15,2)) as FebbraioAC,\n       cast(m13 as decimal(15,2)) as MarzoAC,\n       cast(m14 as decimal(15,2)) as AprileAC,\n       cast(m15 as decimal(15,2)) as MaggioAC,\n       cast(m16 as decimal(15,2)) as GiugnoAC,\n       cast(m17 as decimal(15,2)) as LuglioAC,\n       cast(m18 as decimal(15,2)) as AgostoAC,\n       cast(m19 as decimal(15,2)) as SettembreAC,\n       cast(m1a as decimal(15,2)) as OttobreAC,\n       cast(m1b as decimal(15,2)) as NovembreAC,\n       cast(m1c as decimal(15,2)) as DicembreAC,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  as decimal(15,2)) as AnnoCorrente,\n\t   '' as Sep,\n       cast(m01 as decimal(15,2)) as GennaioAP,\n       cast(m02 as decimal(15,2)) as FebbraioAP,\n       cast(m03 as decimal(15,2)) as MarzoAP,\n       cast(m04 as decimal(15,2)) as AprileAP,\n       cast(m05 as decimal(15,2)) as MaggioAP,\n       cast(m06 as decimal(15,2)) as GiugnoAP,\n       cast(m07 as decimal(15,2)) as LuglioAP,\n       cast(m08 as decimal(15,2)) as AgostoAP,\n       cast(m09 as decimal(15,2)) as SettembreAP,\n       cast(m0a as decimal(15,2)) as OttobreAP,\n       cast(m0b as decimal(15,2)) as NovembreAP,\n       cast(m0c as decimal(15,2)) as DicembreAP,\n       cast((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as decimal(15,2)) as AnnoPrecedente,\n\t   '' as Sep2,\n       cast(m11 - m01 as decimal(15,2)) as DiffGennaio   , cast(coalesce(round(((m11/nullif(m01,0))-1)*100,0),0) as int) as DiffGenPerc,\n       cast(m12 - m02 as decimal(15,2)) as DiffFebbraio  , cast(coalesce(round(((m12/nullif(m02,0))-1)*100,0),0) as int) as DiffFebPerc,\n       cast(m13 - m03 as decimal(15,2)) as DiffMarzo     , cast(coalesce(round(((m13/nullif(m03,0))-1)*100,0),0) as int) as DiffMarPerc,\n       cast(m14 - m04 as decimal(15,2)) as DiffAprile    , cast(coalesce(round(((m14/nullif(m04,0))-1)*100,0),0) as int) as DiffAprPerc,\n       cast(m15 - m05 as decimal(15,2)) as DiffMaggio    , cast(coalesce(round(((m15/nullif(m05,0))-1)*100,0),0) as int) as DiffMagPerc,\n       cast(m16 - m06 as decimal(15,2)) as DiffGiugno    , cast(coalesce(round(((m16/nullif(m06,0))-1)*100,0),0) as int) as DiffGiuPerc,\n       cast(m17 - m07 as decimal(15,2)) as DiffLuglio    , cast(coalesce(round(((m17/nullif(m07,0))-1)*100,0),0) as int) as DiffLugPerc,\n       cast(m18 - m08 as decimal(15,2)) as DiffAgosto    , cast(coalesce(round(((m18/nullif(m08,0))-1)*100,0),0) as int) as DiffAgoPerc,\n       cast(m19 - m09 as decimal(15,2)) as DiffSettembre , cast(coalesce(round(((m19/nullif(m09,0))-1)*100,0),0) as int) as DiffSetPerc,\n       cast(m1a - m0a as decimal(15,2)) as DiffOttobre   , cast(coalesce(round(((m1a/nullif(m0a,0))-1)*100,0),0) as int) as DiffOttPerc,\n       cast(m1b - m0b as decimal(15,2)) as DiffNovembre  , cast(coalesce(round(((m1b/nullif(m0b,0))-1)*100,0),0) as int) as DiffNovPerc,\n       cast(m1c - m0c as decimal(15,2)) as DiffDicembre  , cast(coalesce(round(((m1c/nullif(m0c,0))-1)*100,0),0) as int) as DiffDicPerc,\n       cast((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c)  - (m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c)  as decimal(15,2)) as DiffTotaleAnno, cast(coalesce(round((((m11+m12+m13+m14+m15+m16+m17+m18+m19+m1a+m1b+m1c) /nullif((m01+m02+m03+m04+m05+m06+m07+m08+m09+m0a+m0b+m0c),0) )-1)*100,0),0) as int) as DiffAnnoPerc\nfrom source\norder by 1,2",
    "com0005.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Anno, Mese, TipoDoc, NumeroDoc, DataDoc, CodiceCliente, RagioneSociale, CodiceAgente, NomeAgente,\n       isnull([Normale],0) + isnull([Omaggio],0) as Totale,\n       isnull([Omaggio],0) as Omaggio,\n\t   case when (isnull([Normale],0) + isnull([Omaggio],0)) != 0 then\n\t   round(isnull([Omaggio],0) / (isnull([Normale],0) + isnull([Omaggio],0)) * 100,2)\n\t   else 0 end as PercentualeOmaggio\nfrom (\nselect d.Anno, d.Mese, d.TipoDoc, d.NumeroDoc, d.DataDoc, d.CodiceCliente, d.RagioneSociale, d.CodiceAgente, d.NomeAgente, d.TipoRiga, sum(d.totriga) as Venduto\nfrom Stats..ordinato d\nwhere d.tipoordine = 'Speciale' and d.datadoc between @dadata and @adata\ngroup by d.Anno, d.Mese, d.TipoDoc, d.NumeroDoc, d.DataDoc, d.CodiceCliente, d.ragionesociale, d.codiceagente, d.nomeagente, d.tiporiga\n) as layer1\nPIVOT (\nsum(Venduto)\nfor TipoRiga in ([Normale],[Omaggio])\n) as layer2\norder by 4 desc",
    "com0005.02": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.Anno, d.TipoDoc, d.NumeroDoc, d.DataDoc, d.CodiceCliente, d.RagioneSociale, d.TipoRiga, d.Articolo, d.Descrizione, d.TotRiga, d.scontoesteso as Totale\nfrom Stats..ordinato d\nwhere d.tipoordine = 'Speciale' and d.datadoc between @dadata and @adata\norder by d.progressivo desc",
    "mag0001": "with firstlayer as(\nSELECT  mg.CodArt as Articolo, isnull(ar.desart,'') as Descrizione, isnull(ar.Pers_ABC_RS,'') as ClasseArt, cast(SUM(mg.GIACENZA * mg.QTA1UM) as float) as GiacenzaUb,CODDEPOSITO as Magazzino,CodUbicazione as Ubicazione, cast(max(mg.DataMov) as date) as UltimoMovimento,\n(select FORNPREFACQ + ' - ' + dscconto1 from colfert..ANAGRAFICAARTICOLIPROD inner join colfert..ANAGRAFICACF on FORNPREFACQ = codconto where CODICEART = mg.codart and Esercizio = year(Getdate())) as Fornitore,\n(select count(*) from temp..StatCons where InizioTrasporto >= (GETDATE()-365) and Articolo = mg.codart) as PickAC\nFROM colfert..STORICOMAG mg left outer join sismag..Articoli ar on mg.codart = ar.CODART left outer join colfert..ANAGRAFICAARTICOLIPROD pr on (mg.codart = pr.CODICEART and pr.Esercizio = GetDate()) left outer join anagraficacf fr on pr.FORNPREFACQ = fr.CODCONTO\nwhere mg.giacenza <> 0\ngroup by mg.codart, mg.CODDEPOSITO, mg.codubicazione, ar.desart, ar.Pers_ABC_RS, pr.FORNPREFACQ\nhaving SUM(mg.GIACENZA * mg.QTA1UM) <> 0\n)\nselect * ,\ncase when PickAC >= 62 then 'A' else case when PickAC >= 50 then 'B' else 'C' end end as NuovaClasse\nfrom firstlayer\norder by 5,6",
    "mag0002": "with magace as (\nSELECT  mg.CodArt as Articolo, isnull(ar.desart,'') as Descrizione, isnull(ar.Pers_ABC_RS,'') as ClasseArt, SUM(mg.GIACENZA * mg.QTA1UM) as GiacenzaUb,CODDEPOSITO as Magazzino,CodUbicazione as Ubicazione, max(mg.DataMov) as UltimoMovimento--, tc.Descrizione as Utente\nFROM colfert..STORICOMAG mg left outer join sismag..Articoli ar on mg.codart = ar.CODART left outer join colfert..NDTabTecnici tc on mg.UTENTEMODIFICA = tc.CodUtente\nwhere mg.giacenza <> 0 and CODDEPOSITO = 'ACEMA'\ngroup by mg.codart, mg.CODDEPOSITO, mg.codubicazione, ar.desart, ar.Pers_ABC_RS--, tc.Descrizione\nhaving SUM(mg.GIACENZA * mg.QTA1UM) <> 0\n) , magaceplus as (\nselect magace.Articolo, magace.Descrizione, magace.ClasseArt, magace.GiacenzaUb, magace.Magazzino, magace.Ubicazione, --cast(magace.UltimoMovimento as Date) as UltimoMovimento,\n--(select top 1 m2.UTENTEMODIFICA from colfert..STORICOMAG m2 where m2.codart = magace.Articolo and m2.CODDEPOSITO = 'ACEMA' and magace.UltimoMovimento = m2.DataMov) as UtenteUltMov,\n(select top 1 m2.DataMov from colfert..STORICOMAG m2 where m2.codart = magace.Articolo and m2.CODDEPOSITO = 'ACEMA' and quantitacarico > 0 order by m2.DataMov desc) as UltimoMovEntrata,\n(select top 1 m2.UTENTEMODIFICA from colfert..STORICOMAG m2 where m2.codart = magace.Articolo and m2.CODDEPOSITO = 'ACEMA' and quantitacarico > 0 order by m2.DataMov desc) as UtenteUltimoMovEntrata\nfrom magace\n) select *\nfrom magaceplus\nwhere UtenteUltimoMovEntrata like '%<user>%' and UltimoMovEntrata between '<fromdate>' and '<todate>'\norder by 7 desc,1",
    "mag0003": "select a.CODICE as Articolo, a.DESCRIZIONE as Descrizione, g.CodUbicazione as Ubicazione, dbo.pifloat(g.GiacenzaUb) as Giacenza,\nisnull((select Nd_UbiFISSA from colfert..UBICAZIONIARTICOLI u where u.CODICEART = a.codice and u.CODUBICAZIONE = 'K000001'),'') as 'Fissa in K000001',\nisnull((select Nd_UbiFISSA from colfert..UBICAZIONIARTICOLI u where u.CODICEART = a.codice and u.CODUBICAZIONE = 'K000002'),'') as 'Fissa in K000002'\nfrom colfert..ANAGRAFICAARTICOLI a\n     left outer join colfert..Nd_Ctrl_ControlloGiacUbicazione g on a.codice = g.CodArt\nwhere g.GiacenzaUb != 0 and g.CodUbicazione like 'k%'\norder by 3,1",
    "mag0004": "select u.Descrizione as Operatore, year(datadoc) as Anno, month(datadoc) as Mese, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce') and year(datadoc) = <anno> and month(datadoc) = <mese> and tipo = 'M'\ngroup by u.Descrizione, year(datadoc), month(datadoc)\norder by 1",
    "mag0005": "select a.codice, a.descrizione,\n(select dbo.piFloat(isnull(sum(s.QTA1UM),0)) from colfert..STORICOMAG s where a.codice = s.codart and s.Esercizio = <anno>) as QtaMovimentata,\n(select count(*) from colfert..STORICOMAG s where a.codice = s.codart and s.Esercizio = <anno>) as NumeroMovimenti,\ndbo.piFloat((select isnull(sum(g.Giacenzaub),0) from colfert..Nd_Ctrl_ControlloGiacUbicazione g where g.codart = a.CODICE)) as Giacenza,\nisnull((select min(g.CodUbicazione) from colfert..Nd_Ctrl_ControlloGiacUbicazione g where g.codart = a.CODICE and g.CodUbicazione <> '' and g.GiacenzaUb > 0),'') as UnaUbicazione\nfrom colfert..ANAGRAFICAARTICOLI a\norder by 1",
    "mag0006": "select distinct t.idtesta as Lista, c.deslista as Tipo, t.datalista as Data, case t.stato when 0 then 'In corso' when 1 then 'Confermata' when 2 then 'Conclusa' end as Stato ,\n\to.desope as Operatore, t.T_TRASPACURA as Trasporto, t.T_TIPOIMBALLO as Imabllo, t.T_VETTORE as Vettore,t.T_NCOLLI as Colli,\nisnull(STUFF( (SELECT ', ' + r.RIFDOCUMENTO FROM SISMAG..RIGHELISTA r where r.IDTESTA = t.IDTESTA FOR XML PATH ('')) , 1, 1, ''),'')  AS Documenti\nfrom SISMAG..TESTELISTA t\n     left outer join SISMAG..TIPOLISTA c on t.TIPOLISTA = c.codlista\n\t left outer join SISMAG..OPERATORI o on t.codope = o.codope\nwhere CONVERT(date, t.datamodifica) = CONVERT(date, getdate())\norder by 4 desc",
    "mag0007": "select distinct t.idtesta as Lista, c.deslista as Tipo, t.datalista as Data, case t.stato when 0 then 'In corso' when 1 then 'Confermata' when 2 then 'Conclusa' end as Stato ,\n\to.desope as Operatore, t.T_TRASPACURA as Trasporto, t.T_TIPOIMBALLO as Imabllo, t.T_VETTORE as Vettore,t.T_NCOLLI as Colli,\nisnull(STUFF( (SELECT ', ' + r.RIFDOCUMENTO FROM SISMAG..RIGHELISTA r where r.IDTESTA = t.IDTESTA FOR XML PATH ('')) , 1, 1, ''),'')  AS Documenti\nfrom SISMAG..TESTELISTA t\n     left outer join SISMAG..TIPOLISTA c on t.TIPOLISTA = c.codlista\n\t left outer join SISMAG..OPERATORI o on t.codope = o.codope\nwhere CONVERT(date, t.datamodifica) = CONVERT(date, getdate()) and t.stato < 2\norder by 4 desc",
    "mag0008": "select u.Descrizione as Operatore, year(datadoc) as Anno, month(datadoc) as Mese, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom TESTEDOCUMENTI t left outer join EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce') and datadoc >= '<fromdate>' and datadoc <= '<todate>' and (tipo = 'M' or u.CodUtente = 'cil')\ngroup by u.Descrizione, year(datadoc), month(datadoc)\norder by 1",
    "mag0009": "select u.Descrizione as Operatore, year(datadoc) as Anno, month(datadoc) as Mese, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom TESTEDOCUMENTI t left outer join EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in (<tipodoc>) and datadoc >= '<fromdate>' and datadoc <= '<todate>' and (tipo = 'M' or u.CodUtente = 'cil')\ngroup by u.Descrizione, year(datadoc), month(datadoc)\norder by 1",
    "mag0010": "select u.Descrizione as Operatore, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom TESTEDOCUMENTI t left outer join EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce') and datadoc >= '<fromdate>' and datadoc <= '<todate>' and (tipo = 'M' or u.CodUtente = 'cil')\ngroup by u.Descrizione\norder by 1",
    "mag0011": "select u.Descrizione as Operatore, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom TESTEDOCUMENTI t left outer join EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('TRA') and datadoc >= '<fromdate>' and datadoc <= '<todate>' and (tipo = 'M' or u.CodUtente = 'cil')\ngroup by u.Descrizione\norder by 1",
    "mag0012": "select u.Descrizione as Operatore, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe\nfrom TESTEDOCUMENTI t left outer join EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('RCA','RCB','RCD','RCN','RCS','RCV','RFD','RFL') and datadoc >= '<fromdate>' and datadoc <= '<todate>' and (tipo = 'M' or u.CodUtente = 'cil')\ngroup by u.Descrizione\norder by 1",
    "mag0013": "with start as (\nselect distinct year(datadoc) as Anno, month(datadoc) as Mese, u.Descrizione as Operatore, t.Tipodoc as tipodoc, Count(distinct t.progressivo) as Teste, Count(*) as Righe,\ncase when t.Tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce') then 'Picking' when t.Tipodoc in ('tra') then 'Acema' else 'Resi' end as Tipo\nfrom TESTEDOCUMENTI t left outer join EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce','TRA','RCA','RCB','RCD','RCN','RCS','RCV','RFD','RFL') and year(datadoc) = <anno>  and (tipo = 'M' or u.CodUtente = 'cil')\ngroup by u.Descrizione, year(datadoc), month(datadoc), t.Tipodoc\n)\nselect distinct a.Anno, a.Mese, a.Operatore,\n(select isnull(sum(Teste),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and tipo = 'Picking') as TestePicking,\n(select isnull(sum(Righe),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and tipo = 'Picking') as RighePicking,\n(select isnull(sum(Teste),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and tipo = 'Acema') as TesteAcema,\n(select isnull(sum(Righe),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and tipo = 'Acema') as RigheAcema,\n(select isnull(sum(Teste),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and tipo = 'Resi') as TesteResi,\n(select isnull(sum(Righe),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and tipo = 'Resi') as RigheResi\nfrom start a\norder by 1,2,3",
    "web0001": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect c.codicecliente as CodiceCliente, c.RagioneSociale as NomeCliente, c.settore as SettoreCliente, c.categoria as CategoriaCliente,\n(select count(d.progressivo) from stats..consegnato d where d.codicecliente = c.codicecliente  and d.DataDoc between dateadd(year,-1,@dadata) and dateadd(year,-1,@adata) ) as ContoConsegneAP,\n(select count(d.progressivo) from stats..consegnato d where d.codicecliente = c.codicecliente and d.DataDoc between @dadata and @adata) as ContoConsegneAC,\n(select cast(isnull(sum(d.totriga),0) as float) from stats..consegnato d where d.codicecliente = c.codicecliente and d.DataDoc between dateadd(year,-1,@dadata) and dateadd(year,-1,@adata) ) as ImportoConsegneAP,\n(select cast(isnull(sum(d.totriga),0) as float) from stats..consegnato d where d.codicecliente = c.codicecliente and d.DataDoc between @dadata and @adata) as ImportoConsegneAC,\n(select cast(min(d.datadoc) as date) from stats..consegnato d where d.codicecliente = c.codicecliente ) as ConsegnaPiuAntica\nfrom stats..consegnato c\nwhere c.codiceagente = 'A    50'\ngroup by c.codicecliente, c.RagioneSociale, c.settore, c.categoria\norder by 1",
    "web0002": "select a.CODICE, a.DESCRIZIONE, x.TipoGestione, isnull(colfert.dbo.ColGiacenza(a.codice),0) as Giacenza, colfert.dbo.ColCosto(a.CODICE) as Costo, cast(l.PREZZOEURO as float) as Listino,\n       (select isnull(SUM(c.totriga ),0) from stats..consegnato c where a.CODICE = c.Articolo and c.Anno = year(GetDate()) - 2) as Importo2AnniFa,\n       (select isnull(SUM(c.Quantita),0) from stats..consegnato c where a.CODICE = c.Articolo and c.Anno = year(GetDate()) - 2) as Quantita2AnniFa,\n       (select isnull(SUM(c.totriga ),0) from stats..consegnato c where a.CODICE = c.Articolo and c.Anno = year(GetDate()) - 1) as Importo1AnnoFa,\n       (select isnull(SUM(c.Quantita),0) from stats..consegnato c where a.CODICE = c.Articolo and c.Anno = year(GetDate()) - 1) as Quantita1AnnoFa,\n       (select isnull(SUM(c.totriga ),0) from stats..consegnato c where a.CODICE = c.Articolo and c.Anno = year(GetDate()) - 0) as ImportoQuestoAnno,\n       (select isnull(SUM(c.Quantita),0) from stats..consegnato c where a.CODICE = c.Articolo and c.Anno = YEAR(GETDATE()) - 0) as QuantitaQuestoAnno\nfrom colfert..ANAGRAFICAARTICOLI a\n     inner join colfert..ANAGRAFICAARTICOLIPROD p on a.CODICE = p.CODICEART and p.ESERCIZIO = YEAR(GETDATE())\n\t inner join colfert..EXTRAMAG x on a.CODICE = x.CODART\n\t inner join colfert..LISTINIARTICOLI l on a.CODICE = l.CODART and l.NRLISTINO = 21\nwhere p.FORNPREFACQ = 'F   552'\norder by 1",
    "web0003": "select CodiceCliente, RagioneSociale, isnull([2020],0) as Venduto2020, isnull([2021],0) as Venduto2021, isnull([2022],0) as Venduto2022, isnull([2023],0) as Venduto2023, isnull([2024],0) as Venduto2024, isnull([2025],0) as Venduto2025,\n       isnull([2026],0) as Venduto2026, isnull([2027],0) as Venduto2027, isnull([2028],0) as Venduto2028, isnull([2029],0) as Venduto2029, isnull([2030],0) as Venduto2030\nfrom (\nselect d.CodiceCliente, d.RagioneSociale, d.Anno, sum(d.TotRiga) as Venduto\nfrom stats..consegnato d\nwhere anno >= 2020 and d.CodiceFornitore = 'F   552'\ngroup by d.CodiceCliente, d.RagioneSociale, d.Anno\n) as pippa\nPIVOT (\nsum(Venduto)\nfor Anno in ([2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030])\n) as Pippo2\norder by 1",
    "web0004": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect NomeUtente, Cdc as Settore, round(sum(TotRiga),2) as OrdinatoPderiodo\nfrom stats..ordinato\nwhere NomeUtente ='Susi Kurzen'\n  and DataDoc between @dadata and @adata\ngroup by NomeUtente, Cdc\norder by 2",
    "web0005": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.CodiceFornitore, d.NomeFornitore, d.NomeUtente, d.Cdc as Settore, round(sum(d.TotRiga),2) as ConsegnatoPderiodo,\n  (select round(isnull(sum(a.TotRiga),0),2) from stats..acquistato a where a.CodiceCliente =  'F   552' and a.DataDoc between @dadata and @adata) as AcquistatoPeriodo\nfrom stats..consegnato d\nwhere d.CodiceFornitore = 'F   552' and d.DataDoc between @dadata and @adata\ngroup by d.CodiceFornitore, d.NomeFornitore, d.NomeUtente, d.Cdc\norder by 1,2",
    "web0006": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.Progressivo, d.TipoDoc, d.NumeroDoc, d.CodiceCliente, d.RagioneSociale, d.DataDoc, d.NomeUtente, d.TipoOrdine, d.CodiceAgente, d.NomeAgente, d.Articolo, d.Descrizione,\n       d.PrezzoUnitLordo as Lordo, d.Sconto, d.ScontoEsteso, d.PrezzoUnitNetto, d.TotRiga, round(d.CostoUltimoTot,2) as CostoRelativo, round(d.MargineTot,2) as Margine\nfrom stats..ordinato d\nwhere TipoDoc = 'OCE'\nand DataDoc between @dadata and @adata\norder by 1",
    "web0007": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente as Agente, round(Legno,2) as LegnoPvc, round(Alluminio,2) as AlluminioFerro, round(Prodotto,2) as ProdottoFinito, round(Utensileria,2) as Utensileria, round(Complementi,2) as Complementi,\n  case when totale = 0 then 0 else round(Legno/totale * 100,2)       end as PercLegno,\n  case when totale = 0 then 0 else round(Alluminio/totale * 100,2)   end as PercAlluminio,\n  case when totale = 0 then 0 else round(Prodotto/totale * 100,2)    end as PercProdotto,\n  case when totale = 0 then 0 else round(Utensileria/totale * 100,2) end as PercUtensileria,\n  case when totale = 0 then 0 else round(Complementi/totale * 100,2) end as PercComplementi\nfrom\n(\n\tselect Utente,\n\t\t   isnull([LEGNO/PVC],0) as Legno,isnull([ALLUMINIO - FERRO],0) as Alluminio,isnull([PROD. FINITO],0) as Prodotto,isnull([UTENSILERIA],0) as Utensileria,isnull([COMPLEMENTI],0) as Complementi,\n\t\t   isnull([ALTRO],0) + isnull([Nessun Settore],0) + isnull([YCO],0) + isnull([LEGNO/PVC],0) + isnull([ALLUMINIO - FERRO],0) + isnull([PROD. FINITO],0) + isnull([UTENSILERIA],0) + isnull([COMPLEMENTI],0) as Totale\n\tfrom\n\t(\n\t\tselect d.codiceagente as Utente, d.CategoriaFornitore, (select isnull(sum(c.TotRiga),0) from stats..consegnato c where d.codiceagente = 'A    50' and c.CategoriaFornitore = d.CategoriaFornitore and c.DataDoc >= @dadata and c.DataDoc <= @adata ) as Importo\n\t\tfrom Stats..consegnato2 d\n\t\twhere d.codiceagente = 'A    50' --and d.TipoOrdine != 'Prenota e ritira' and d.SedeUtente = 'tv' and d.UtenteNegozio not in ('2 Luca Deppieri','')\n\t\tgroup by CategoriaFornitore, d.codiceagente\n\t) as layer1\n\tPIVOT\n\t(\n\t\tsum(Importo)\n\t\tfor CategoriaFornitore in ([UTENSILERIA],[LEGNO/PVC],[PROD. FINITO],[COMPLEMENTI],[ALTRO],[Nessun Settore],[ALLUMINIO - FERRO],[YCO])\n\t) as layer2\n) as layer3\norder by 1",
    "mar0001": "declare @anno int;\nset @anno = <anno>;\nwith sums as (\nselect\na.LOCALITA,x.CODAGENTE1, s.DSCAGENTE, isnull(ec.NomePersonaViaggio,'') as Nome, isnull(ec.CognomePersonaViaggio,'') as Cognome,\nb.CODCLI, a.DSCCONTO1, a.PROVINCIA, a.TELEFONO, case when isnull(ec.note1,'') != '' then ec.note1 else a.TELEX end as Telex,\n--cast(b.valore as float) as XBudget, cast(b.NOTE as float) as Budget2,\ncase when b.NOTE = '' then cast(b.valore as float) else iif(cast(b.valore as float) < cast(b.NOTE as float), cast(b.valore as float), cast(b.NOTE as float)) end as Budget,\ncase when b.NOTE = '' then cast(0 as float) else iif(cast(b.valore as float) < cast(b.NOTE as float), cast(b.NOTE as float), cast(b.valore as float)) end as Budget2,\nisnull((select sum(r.TOTNETTORIGAEURO * t.SEGNO) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where replace(replace(replace(t.CODCLIFOR,'C 25437','C 32074'),'C  2945','C 31822'),'C  5025','C 31615') = a.CODCONTO and r.TipoRiga in ('N','V','S') and t.Esercizio = @anno and t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce')),0) +\nisnull(( select sum(r.TOTNETTORIGAEURO * t.SEGNO) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where replace(replace(replace(t.CODCLIFOR,'C 25437','C 32074'),'C  2945','C 31822'),'C  5025','C 31615') = a.CODCONTO and r.TipoRiga in ('N','V','S') and t.Esercizio = 2019 and t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce') and dbo.piGetOrderProg(t.progressivo, r.idriga) between 1825246 and 2112526 ),0) as Consegnato,\nisnull((select sum(r.TOTNETTORIGAEURO * t.SEGNO / r.QTAGEST * r.QTAGESTRES) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where replace(replace(replace(t.CODCLIFOR,'C 25437','C 32074'),'C  2945','C 31822'),'C  5025','C 31615') = a.CODCONTO and r.TipoRiga in ('N','V','S') and t.Esercizio = @anno and t.tipodoc in (select codice from colfert..PARAMETRIDOC where tipo + clifor = 'OC') and r.rigachiusa = 0),0) as OrdinatoAperto\nfrom colfert..ANAGRAFICACF a inner join colfert..ND_Budget_ClientePeriodo b on b.CODCLI = a.CODCONTO and year(b.DataFine) = @anno\n\tleft outer join colfert..ANAGRAFICARISERVATICF  x  on (a.CODCONTO = x.CODCONTO and x.Esercizio = year(GetDate()))\n\tleft outer join colfert..ANAGRAFICAAGENTI       s  on x.CODAGENTE1 = s.CODAGENTE\n\tleft outer join ced..ExtraCFCed ec on a.CODCONTO = ec.codclifor\n)\nselect\n       CODAGENTE1 as CodAgente, DSCAGENTE as NomeAgente,\n       codcli as CodiceCliente, DSCCONTO1 as RagioneSociale, Nome as NomePersona, Cognome as CognomePersona, Provincia as Provincia, LOCALITA as Localita, 'T ' + Telefono as Telefono, TELEX as Email, Budget as Budget1, Budget2 as Budget2,\n       Consegnato as Consegnato, OrdinatoAperto as OrdinatoAperto,\n\t   Consegnato + OrdinatoAperto - Budget as Diff1,\n\t   Consegnato + OrdinatoAperto - cast(Budget2 as float) as Diff2,\n\t   floor(((Consegnato + OrdinatoAperto - Budget) / budget)*100) as DiffPerc1,\n\t   floor(case when cast(Budget2 as float) != 0 then ((Consegnato + OrdinatoAperto - cast(Budget2 as float)) / cast(Budget2 as float)) * 100 else 0 end) as DiffPerc2,\n\t   case\n\t        when codcli in ('C  3330 ','C 22268','C 25689','C 20161','C 31694','C 18734','C 25378','C 31066','C 31343','C 28776','C 25028','C  6103','C   834','C 18832','C 21645','C 21597','C  1104','C 21759','C  1018','C  1076','C  3052','C  3737','C 22104','C 24160','C 26891') then 'depennati' else\n\t        case when (floor(((Consegnato + OrdinatoAperto - Budget ) / budget )*100) > 0 ) then '*' else\n\t        iif(Budget2 > 0, case when (floor(((Consegnato + OrdinatoAperto - Budget2) / Budget2)*100) > 0 ) then '**' else '' end, '')\n\t   end end as Vincitori\n--\t   ,*\nfrom sums\norder by 1,3",
    "mar0002": "select x.CODAGENTE1 as Agente, a.CODCONTO as CodiceCliente, a.DSCCONTO1 as RagioneSociale, a.INDIRIZZO as Indirizzo, a.LOCALITA as Localita, a.CAP as CAP, a.PROVINCIA as Provincia, p.COGNOME as Cognome, p.NOME as Nome,\ncase p.TITOLO when 0 then '' when 3 then 'Dott.' when 4 then 'Dott.ssa' when 5 then 'Geom.' when 10 then 'Sig.' when 11 then 'Sig.na' when 12 then 'Sig.ra' when 13 then 'Sigg.' end as 'Titolo',\np.EMAIL as Email,\ncast(isnull((select sum(c.nettoriga) from temp..StatCons c where c.CodiceCliente = a.codconto and c.Esercizio = (year(GetDate())-1) ),0) as float) as FattAP,\ncast(isnull((select sum(c.nettoriga) from temp..StatCons c where c.CodiceCliente = a.codconto and c.Esercizio = (year(GetDate())-0) ),0) as float) as FattAC\nfrom anagraficacf a inner join colfert..TABELLAPERSONALE p on a.CODCONTO = p.RIFCODCONTO left outer join colfert..ANAGRAFICARISERVATICF  x  on (a.CODCONTO = x.CODCONTO and x.Esercizio = year(GetDate()))\nwhere codruolo in (19,64) and CODAGENTE1 != 'A    99' and a.CODCONTO like 'c%'\norder by 2",
    "mar0003": "select x.CODAGENTE1 as Agente, a.CODCONTO as CodiceCliente, a.DSCCONTO1 as RagioneSociale, a.INDIRIZZO as Indirizzo, a.LOCALITA as Localita, a.CAP as CAP, a.PROVINCIA as Provincia, p.COGNOME as Cognome, p.NOME as Nome,\ncase p.TITOLO when 0 then '' when 3 then 'Dott.' when 4 then 'Dott.ssa' when 5 then 'Geom.' when 10 then 'Sig.' when 11 then 'Sig.na' when 12 then 'Sig.ra' when 13 then 'Sigg.' end as 'Titolo',\np.EMAIL as Email,\n(select cast(isnull(sum(c.TOTIMPONIBILEEURO * c.SEGNO),0) as float) from colfert..TESTEDOCUMENTI c where c.CODCLIFOR = a.CODCONTO and c.TIPODOC in ('NFD','FAF','FAI','NFA','NFI') and c.Esercizio = (year(GetDate())-1)) as FattAP,\n(select cast(isnull(sum(c.TOTIMPONIBILEEURO * c.SEGNO),0) as float) from colfert..TESTEDOCUMENTI c where c.CODCLIFOR = a.CODCONTO and c.TIPODOC in ('NFD','FAF','FAI','NFA','NFI') and c.Esercizio = (year(GetDate())-0)) as FattAC\nfrom colfert..anagraficacf a inner join colfert..TABELLAPERSONALE p on a.CODCONTO = p.RIFCODCONTO left outer join colfert..ANAGRAFICARISERVATICF  x  on (a.CODCONTO = x.CODCONTO and x.Esercizio = year(GetDate()))\nwhere codruolo in (19,64) and CODAGENTE1 != 'A    99' and a.CODCONTO like 'f%'\norder by 2",
    "mar0004": "select x.CODAGENTE1 as Agente, a.CODCONTO as CodiceCliente, a.DSCCONTO1 as RagioneSociale, a.INDIRIZZO as Indirizzo, a.LOCALITA as Localita, a.CAP as CAP, a.PROVINCIA as Provincia,\ncast(isnull((select sum(c.nettoriga) from temp..StatCons c where c.CodiceCliente = a.codconto and c.Esercizio = (year(GetDate())-1) ),0) as float) as FattAP,\ncast(isnull((select sum(c.nettoriga) from temp..StatCons c where c.CodiceCliente = a.codconto and c.Esercizio = (year(GetDate())-0) ),0) as float) as FattAC\nfrom colfert..anagraficacf a left outer join colfert..ANAGRAFICARISERVATICF  x  on (a.CODCONTO = x.CODCONTO and x.Esercizio = year(GetDate()))\nwhere a.CODCONTO like 'c%' and x.CODAGENTE1 != 'A    99'\norder by 2",
    "mar0005": "Declare @anno int = <anno>;\nwith start as (\nselect rr.CODAGENTE1 + ' - ' + isnull((select gg.DSCAGENTE from colfert..ANAGRAFICAAGENTI gg where gg.CODAGENTE = rr.CODAGENTE1),'') as Agente, aa.CODCONTO + ' - ' + aa.DSCCONTO1 as Cliente\n, (select isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where DATADOC >= DATEFROMPARTS( @anno - 1, 1, 1) and DATADOC <= DATEFROMPARTS( @anno - 1, 3,31) and t.BLOCCATO = 0 and t.TIPODOC like 'O%' and t.CODCLIFOR like 'C%' and t.CODCLIFOR = aa.CODCONTO) as Ordinato1TrimAnnoPrec\n, (select isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where DATADOC >= DATEFROMPARTS( @anno - 1, 4, 1) and DATADOC <= DATEFROMPARTS( @anno - 1, 6,30) and t.BLOCCATO = 0 and t.TIPODOC like 'O%' and t.CODCLIFOR like 'C%' and t.CODCLIFOR = aa.CODCONTO) as Ordinato2TrimAnnoPrec\n, (select isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where DATADOC >= DATEFROMPARTS( @anno - 1, 7, 1) and DATADOC <= DATEFROMPARTS( @anno - 1, 9,30) and t.BLOCCATO = 0 and t.TIPODOC like 'O%' and t.CODCLIFOR like 'C%' and t.CODCLIFOR = aa.CODCONTO) as Ordinato3TrimAnnoPrec\n, (select isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where DATADOC >= DATEFROMPARTS( @anno - 1,10, 1) and DATADOC <= DATEFROMPARTS( @anno - 1,12,31) and t.BLOCCATO = 0 and t.TIPODOC like 'O%' and t.CODCLIFOR like 'C%' and t.CODCLIFOR = aa.CODCONTO) as Ordinato4TrimAnnoPrec\n, (select isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where DATADOC >= DATEFROMPARTS( @anno - 0, 1, 1) and DATADOC <= DATEFROMPARTS( @anno - 0, 3,31) and t.BLOCCATO = 0 and t.TIPODOC like 'O%' and t.CODCLIFOR like 'C%' and t.CODCLIFOR = aa.CODCONTO) as Ordinato1TrimAnno\n, (select isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where DATADOC >= DATEFROMPARTS( @anno - 0, 4, 1) and DATADOC <= DATEFROMPARTS( @anno - 0, 6,30) and t.BLOCCATO = 0 and t.TIPODOC like 'O%' and t.CODCLIFOR like 'C%' and t.CODCLIFOR = aa.CODCONTO) as Ordinato2TrimAnno\n, (select isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where DATADOC >= DATEFROMPARTS( @anno - 0, 7, 1) and DATADOC <= DATEFROMPARTS( @anno - 0, 9,30) and t.BLOCCATO = 0 and t.TIPODOC like 'O%' and t.CODCLIFOR like 'C%' and t.CODCLIFOR = aa.CODCONTO) as Ordinato3TrimAnno\n, (select isnull(cast(sum(r.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where DATADOC >= DATEFROMPARTS( @anno - 0,10, 1) and DATADOC <= DATEFROMPARTS( @anno - 0,12,31) and t.BLOCCATO = 0 and t.TIPODOC like 'O%' and t.CODCLIFOR like 'C%' and t.CODCLIFOR = aa.CODCONTO) as Ordinato4TrimAnno\nfrom colfert..ANAGRAFICACF aa inner join colfert..ANAGRAFICARISERVATICF rr on (aa.CODCONTO = rr.CODCONTO and rr.ESERCIZIO in (@anno-1, @anno))\nwhere aa.TIPOCONTO = 'C'\n)\nselect distinct *\nfrom start\nwhere Agente != ' - '\nand (Ordinato1TrimAnnoPrec + Ordinato2TrimAnnoPrec + Ordinato3TrimAnnoPrec + Ordinato4TrimAnnoPrec > 2000 or Ordinato1TrimAnno + Ordinato2TrimAnno + Ordinato3TrimAnno + Ordinato4TrimAnno > 2000)\norder by 1,2",
    "mar0006": "drop table temp..Punti2019;\nselect * into temp..Punti2019 from ND_FIERA_VistaPunti_2019;\nselect distinct p.AreaManager, am.DSCAGENTE as NomeAreamanager, p.CodAgente1 as CodAgente, ag.DSCAGENTE as NomeAgente, p.CodCliente, p.RagioneSociale,\n       (select isnull(sum(cast(Obbiettivo          as float)),0) from temp..Punti2019 p2 where p.codcliente = p2.codcliente and Periodo = 2) as ObiettivoPer2,\n       (select isnull(sum(cast(OrdinatoProgressivo as float)),0) from temp..Punti2019 p2 where p.codcliente = p2.codcliente and Periodo = 2) as OrdinatoPer2,\n       (select isnull(sum(cast(OrdinatoDelta_Arrot as float)),0) from temp..Punti2019 p2 where p.codcliente = p2.codcliente and Periodo = 2) as DeltaPer2,\n       (select isnull(sum(cast(Smile               as float)),0) from temp..Punti2019 p2 where p.codcliente = p2.codcliente and Periodo = 2) as SmilePer2,\n       (select isnull(sum(cast(Obbiettivo          as float)),0) from temp..Punti2019 p3 where p.codcliente = p3.codcliente and Periodo = 3) as ObiettivoPer3,\n       (select isnull(sum(cast(OrdinatoProgressivo as float)),0) from temp..Punti2019 p3 where p.codcliente = p3.codcliente and Periodo = 3) as OrdinatoPer3,\n       (select isnull(sum(cast(OrdinatoDelta_Arrot as float)),0) from temp..Punti2019 p3 where p.codcliente = p3.codcliente and Periodo = 3) as DeltaPer3,\n       (select isnull(sum(cast(Smile               as float)),0) from temp..Punti2019 p3 where p.codcliente = p3.codcliente and Periodo = 3) as SmilePer3,\n       (select isnull(sum(cast(Obbiettivo          as float)),0) from temp..Punti2019 p4 where p.codcliente = p4.codcliente and Periodo = 4) as ObiettivoPer4,\n       (select isnull(sum(cast(OrdinatoProgressivo as float)),0) from temp..Punti2019 p4 where p.codcliente = p4.codcliente and Periodo = 4) as OrdinatoPer4,\n       (select isnull(sum(cast(OrdinatoDelta_Arrot as float)),0) from temp..Punti2019 p4 where p.codcliente = p4.codcliente and Periodo = 4) as DeltaPer4,\n       (select isnull(sum(cast(Smile               as float)),0) from temp..Punti2019 p4 where p.codcliente = p4.codcliente and Periodo = 4) as SmilePer4,\n\t   case when isnull((select top 1 pf.CODCONTO                          from Nd_Fiera_TabClientiPresenti pf where esercizio = 2019 and pf.codconto = p.CodCliente),'') = '' then '' else 'si' end as InFiera,\n       (select isnull(sum(cast(Smile               as float)),0) from temp..Punti2019 p2 where p.codcliente = p2.codcliente ) as SmileTot\nfrom temp..Punti2019 p\n     inner join colfert..ANAGRAFICAAGENTI ag on p.CodAgente1  = ag.CODAGENTE\n     inner join colfert..ANAGRAFICAAGENTI am on p.AreaManager = am.CODAGENTE\norder by codcliente",
    "mar0007": "select * from colfert.dbo.COL_Punti2022",
    "age0001": "declare @forn nvarchar(20);\nset @forn = '<cardcode>';\nselect distinct c.CodiceCliente,NomeCliente,CodiceAgente,NomeAgente,CategoriaCliente,\nisnull(cast((select sum(f.NettoRiga) from temp..StatCons f where f.AnnoTrasporto = year(GetDate())-1 and f.CodiceCliente = c.CodiceCliente and f.CodiceFornitore = @forn) as float),0) as ConsAP,\nisnull(cast((select sum(f.NettoRiga) from temp..StatCons f where f.AnnoTrasporto = year(GetDate())-0 and f.CodiceCliente = c.CodiceCliente and f.CodiceFornitore = @forn) as float),0) as ConsAC,\na.INDIRIZZO,a.CAP,a.LOCALITA,a.PROVINCIA,a.TELEFONO,a.FAX,a.TELEX\nfrom temp..StatCons c inner join colfert..anagraficacf a on c.CodiceCliente = a.CODCONTO\nwhere c.CodiceFornitore = @forn\norder by 1",
    "age0002": "select distinct c.CodiceCliente,NomeCliente,CodiceAgente,NomeAgente,CategoriaCliente,\nisnull(cast((select sum(f.NettoRiga) from temp..StatCons f where f.AnnoTrasporto = year(GetDate())-1 and f.CodiceCliente = c.CodiceCliente) as float),0) as ConsAP,\nisnull(cast((select sum(f.NettoRiga) from temp..StatCons f where f.AnnoTrasporto = year(GetDate())-0 and f.CodiceCliente = c.CodiceCliente) as float),0) as ConsAC,\na.INDIRIZZO,a.CAP,a.LOCALITA,a.PROVINCIA,a.TELEFONO,a.FAX,a.TELEX\nfrom temp..StatCons c inner join colfert..anagraficacf a on c.CodiceCliente = a.CODCONTO\nwhere CodiceFornitore = 'F     3'\norder by 1",
    "age0003": "With Contati as (\nselect distinct c.CodiceAgente, c.CodiceCliente, c.NomeCliente,\nisnull(cast((select sum(f.NettoRiga) from temp..StatCons f where f.AnnoTrasporto = <anno> and f.MeseTrasporto = <mese> and f.CodiceCliente = c.CodiceCliente ) as float),0) as Cons,\nisnull(cast((select count(distinct f.InizioTrasporto) from temp..StatCons f where f.AnnoTrasporto = <anno> and f.MeseTrasporto = <mese> and f.CodiceCliente = c.CodiceCliente and f.DocTipo in ('DCB','DCV','FCA','FCE','SCB')) as float),0) as NrConsegne\nfrom temp..StatCons c\n) select * from Contati where NrConsegne > 0\norder by 1,2",
    "age0004": "select t.CODCLIFOR as CodiceCliente, a.DSCCONTO1 as RagioneSociale, r.TIPODOC as TipoDocumento, r.NUMERODOC as NumeroDocumento, t.DATADOC as dataDocumento, r.TipoRiga as TipoRiga, r.CODART as CodiceArticolo, r.DESCRIZIONEART as Descrizione, r.UMGEST as UM, r.QTAGEST as Quantita, t.CODAGENTE1 as CodAgente, s.DSCAgente as Agente, r.TOTNETTORIGAEURO as ImponibileRiga, o.Descrizione as TipoOrdine\nfrom colfert..TESTEDOCUMENTI T\n     inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n\t left outer join colfert..EXTRATESTEDOC x on t.PROGRESSIVO = x.IDTESTA\n\t inner join colfert..ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\n\t left outer join colfert..NDTabTipiOrdine o on x.TipoOrdine = o.Codice\n\t left outer join colfert..NDTabTecnici u on x.ND_UTECREAZ = u.CodUtente\n     left outer join colfert..ANAGRAFICARISERVATICF  y  on (t.CODCLIFOR = y.CODCONTO and y.Esercizio = year(GetDate()))\n     left outer join colfert..ANAGRAFICAAGENTI       s  on y.CODAGENTE1 = s.CODAGENTE\nwhere x.TipoOrdine in (11,5,7,8)\n      and r.TIPORIGA in ('N','O')\n\t  and t.DATADOC between '<fromdate>' and '<todate>'\n\t  and r.TIPODOC in ('OCB','OCV','OCW')\n\t  and r.codart != ''\norder by 5, 10, 2, 4, 3",
    "age0005": "declare @forn nvarchar(20);\nset @forn = '<cardcode>';\nselect distinct c.CodiceCliente,NomeCliente,CodiceAgente,NomeAgente,CategoriaCliente,\nisnull(cast((select sum(f.NettoRiga) from temp..StatCons f where f.InizioTrasporto >= dateadd(year,-2,'<fromdate>') and f.InizioTrasporto <= dateadd(year,-2,'<todate>') and f.CodiceCliente = c.CodiceCliente and f.CodiceFornitore = @forn) as float),0) as Periodo2AnniPrima,\nisnull(cast((select sum(f.NettoRiga) from temp..StatCons f where f.InizioTrasporto >= dateadd(year,-1,'<fromdate>') and f.InizioTrasporto <= dateadd(year,-1,'<todate>') and f.CodiceCliente = c.CodiceCliente and f.CodiceFornitore = @forn) as float),0) as PeriodoPrecedente,\nisnull(cast((select sum(f.NettoRiga) from temp..StatCons f where f.InizioTrasporto >= dateadd(year,-0,'<fromdate>') and f.InizioTrasporto <= dateadd(year,-0,'<todate>') and f.CodiceCliente = c.CodiceCliente and f.CodiceFornitore = @forn) as float),0) as PeriodoCorrente,\na.INDIRIZZO,a.CAP,a.LOCALITA,a.PROVINCIA,a.TELEFONO,a.FAX,a.TELEX\nfrom temp..StatCons c inner join colfert..anagraficacf a on c.CodiceCliente = a.CODCONTO\nwhere c.CodiceFornitore = @forn\norder by 1",
    "age0006": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Anno, Cdc, NomeUtente, CodiceAgente, NomeAgente, CodiceCliente, RagioneSociale, TipoOrdine, TipoDoc, NumeroDoc, DataDoc, month(datadoc) as Mese,\n  TipoRiga, Articolo, Descrizione, UM, Quantita, PrezzoUnitLordo, ScontoEsteso, PrezzoUnitNetto, TotRiga,\n  CodiceFornitore, NomeFornitore, CategoriaFornitore,\n  CostoUltimoUnit, CostoUltimoTot, MargineUnit, MargineTot\nfrom stats..consegnato d inner join colfert..extramag x on d.codicearticolo = x.codart\nwhere x.CodSpecialistaCtrlAccessi = 'AA' and d.datadoc between @dadata and @adata",
    "age0007": "declare @dadata DateTime   = '<fromdate>';\ndeclare @adata  DateTime   = '<todate>';\nselect Anno, DataDoc, CodiceCliente, RagioneSociale, CodiceAgente, NomeAgente, TipoOrdine, TipoDoc, NumeroDoc,\n  Articolo, Descrizione, UM, PrezzoUnitNetto, Quantita, TotRiga, CodiceFornitore, NomeFornitore, TipoRiga\nfrom stats..consegnato\nwhere TipoOrdine = 'Accessi automatici'\n      and datadoc between @dadata and @adata\norder by progressivo, idriga",
    "all0001": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'ALLUMINIO - FERRO' and Period = 'Month'\norder by 1",
    "all0002": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'ALLUMINIO - FERRO' and Period = 'Year'\norder by 1",
    "all0003": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'ALLUMINIO - FERRO' and Period = 'Month<mese>'\norder by 1",
    "all0004": "with ground as (\nselect d.codicefornitore, d.nomefornitore\nfrom stats..consegnato d\nwhere anno > 2023-5 and CategoriaFornitore = 'ALLUMINIO - FERRO'\ngroup by d.codicefornitore, d.nomefornitore\n)\nselect g.CodiceFornitore, g.NomeFornitore,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 0) as ScontoMedioAnnoCorrente,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 1) as ScontoMedioUnAnnofa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 2) as ScontoMedioDueAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 3) as ScontoMedioTreAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 4) as ScontoMedioQuattroAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 5) as ScontoMedioCinqueAnniFa\nfrom ground g\norder by 1",
    "leg0001": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'LEGNO/PVC' and Period = 'Month'\norder by 1",
    "leg0002": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'LEGNO/PVC' and Period = 'Year'\norder by 1",
    "leg0003": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'LEGNO/PVC' and Period = 'Month<mese>'\norder by 1",
    "leg0004": "with ground as (\nselect d.codicefornitore, d.nomefornitore\nfrom stats..consegnato d\nwhere anno > 2023-5 and CategoriaFornitore = 'LEGNO/PVC'\ngroup by d.codicefornitore, d.nomefornitore\n)\nselect g.CodiceFornitore, g.NomeFornitore,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 0) as ScontoMedioAnnoCorrente,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 1) as ScontoMedioUnAnnofa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 2) as ScontoMedioDueAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 3) as ScontoMedioTreAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 4) as ScontoMedioQuattroAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 5) as ScontoMedioCinqueAnniFa\nfrom ground g\norder by 1",
    "pro0001": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'PROD. FINITO' and Period = 'Month'\norder by 1",
    "pro0002": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'PROD. FINITO' and Period = 'Year'\norder by 1",
    "pro0003": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct a.CodiceAgente + ' - ' + a.NomeAgente as Agente,\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   616') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F   616',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F     1') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F     1',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   404') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F   404',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F  7516') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F  7516',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   406') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F   406',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   978') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F   978',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   446') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F   446',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   448') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F   448',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   267') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F   267',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F  7512') and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata),0)) as float) as 'F  7512'\nfrom temp..StatCons a\norder by 1",
    "pro0002xxx": "select distinct a.CodiceAgente + ' - ' + a.NomeAgente as Agente,\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   616') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F   616',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F     1') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F     1',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   404') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F   404',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F  7516') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F  7516',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   406') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F   406',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   978') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F   978',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   446') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F   446',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   448') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F   448',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F   267') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F   267',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CodiceAgente = a.CodiceAgente and b.CodiceFornitore = ('F  7512') and b.AnnoTrasporto = <anno> - 0),0)) as float) as 'F  7512'\nfrom temp..StatCons a\norder by 1",
    "pro0004": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect isnull(a.CodiceAgente,'') + ' - ' + isnull(a.NomeAgente,'') as Agente, isnull(a.CodiceFornitore,'') + ' - ' + isnull(a.NomeFornitore,'') as Fornitore, isnull(cast(sum(NettoRiga) as float),0) as Imponibile\nfrom temp..StatCons a\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata and a.CodiceFornitore not in ('F   101','F   868')\ngroup by isnull(a.CodiceAgente,'') + ' - ' + isnull(a.NomeAgente,''), isnull(a.CodiceFornitore,'') + ' - ' + isnull(a.NomeFornitore,'')\nunion\nselect isnull(a.CodiceAgente,'') + ' - ' + isnull(a.NomeAgente,'') as Agente, isnull(a.CodiceFornitore,'') + ' - ' + isnull(a.NomeFornitore,'') as Fornitore, isnull(cast(sum(NettoRiga) as float),0) as Imponibile\nfrom temp..StatCons a\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata and a.CodiceFornitore in ('F   101','F   868') and a.Categoria4 in ('AUTOM','VETRO')\ngroup by isnull(a.CodiceAgente,'') + ' - ' + isnull(a.NomeAgente,''), isnull(a.CodiceFornitore,'') + ' - ' + isnull(a.NomeFornitore,'')\norder by 1,2",
    "pro0005": "-- descrizione = Spedito per utente, agente e per fornitore da data a data\n-- filtri = <fromdate>, <todate>\n-- types = sssa\n--filtro1 = data, InizioTrasporto, data, d, data o range di date in cui applicare la statistica\ndeclare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect a.NomeUtente, isnull(a.CodiceAgente,'') + ' - ' + isnull(a.NomeAgente,'') as Agente, isnull(a.CodiceFornitore,'') + ' - ' + isnull(a.NomeFornitore,'') as Fornitore, isnull(cast(sum(NettoRiga) as float),0) as Imponibile\nfrom temp..StatCons a\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata and a.CodiceFornitore not in ('F     1','F   101','F   331','F   409','F   868') and CategoriaFornitore = 'PROD. FINITO'\ngroup by isnull(a.CodiceAgente,'') + ' - ' + isnull(a.NomeAgente,''), isnull(a.CodiceFornitore,'') + ' - ' + isnull(a.NomeFornitore,''),a.NomeUtente\nunion\nselect a.NomeUtente, isnull(a.CodiceAgente,'') + ' - ' + isnull(a.NomeAgente,'') as Agente, isnull(a.CodiceFornitore,'') + ' - ' + isnull(a.NomeFornitore,'') as Fornitore, isnull(cast(sum(NettoRiga) as float),0) as Imponibile\nfrom temp..StatCons a\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata and a.CodiceFornitore in ('F     1','F   101','F   331','F   409','F   868') and a.Categoria4 in ('AUTOM','VETRO')\ngroup by isnull(a.CodiceAgente,'') + ' - ' + isnull(a.NomeAgente,''), isnull(a.CodiceFornitore,'') + ' - ' + isnull(a.NomeFornitore,''),a.NomeUtente\norder by 1,2",
    "pro0006": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct a.CodiceFornitore, a.NomeFornitore ,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CodiceFornitore = a.CodiceFornitore and b.TipoArticolo  = 'Generico') as Generico,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CodiceFornitore = a.CodiceFornitore and b.TipoArticolo != 'Generico') as NonGenerico\nfrom temp..StatCons a\nwhere CategoriaFornitore = 'PROD. FINITO'\nand a.InizioTrasporto >= @dadata and a.InizioTrasporto <= @adata\nunion\nselect distinct a.CodiceFornitore, a.NomeFornitore ,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CodiceFornitore = a.CodiceFornitore and b.TipoArticolo  = 'Generico') as Generico,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CodiceFornitore = a.CodiceFornitore and b.TipoArticolo != 'Generico') as NonGenerico\nfrom temp..StatCons a\nwhere CodiceFornitore in ('F     1','F   101','F   331','F   409','F   868') and Categoria4 in ('AUTOM','VETRO')\nand a.InizioTrasporto >= @dadata and a.InizioTrasporto <= @adata\norder by 1",
    "pro0007": "select distinct a.CodiceAgente, a.NomeAgente, a.CodiceCliente, a.NomeCliente, a.SettoreCliente,\ncase when a.CodiceCliente in ('C   115', 'C  1237', 'C 25398', 'C 25310', 'C 32276', 'C 22780', 'C  2590', 'C  2274', 'C 31524', 'C 17872', 'C 31206', 'C  3047', 'C 23343', 'C 24062', 'C   530', 'C 22056', 'C 19964', 'C  3113', 'C 10705', 'C  2130', 'C 24174', 'C  5774', 'C 31553', 'C 24481', 'C 21335', 'C 20658', 'C 16469', 'C  2519', 'C  1385', 'C 18676', 'C 22886', 'C 21093', 'C  2236', 'C 25045', 'C  2730', 'C   682', 'C  2263', 'C  2535', 'C   396', 'C  2045', 'C   894', 'C 20080', 'C  5221', 'C  3074', 'C 30111', 'C 25338', 'C 27271', 'C 13326', 'C 19732', 'C 21670', 'C  1018', 'C  2589', 'C 20087', 'C 18747', 'C  9113', 'C 27348', 'C 25902', 'C 12634', 'C 25862', 'C 17882', 'C 25636', 'C 18206', 'C 17527', 'C  1389', 'C  9170', 'C  3113', 'C 28975', 'C 20773', 'C 30099', 'C 19734', 'C  2234')\n     then 'S' else 'N' end as WaterproofPoint,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-0> and b.cdc = 'waterproof') as Cons<anno-0>,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-1> and b.cdc = 'waterproof') as Cons<anno-1>,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-2> and b.cdc = 'waterproof') as Cons<anno-2>,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-3> and b.cdc = 'waterproof') as Cons<anno-3>,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-4> and b.cdc = 'waterproof') as Cons<anno-4>,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-5> and b.cdc = 'waterproof') as Cons<anno-5>,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-0> and b.cdc = 'waterproof' and b.Articolo = '446J12768') as NrMotori<anno-0>,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-1> and b.cdc = 'waterproof' and b.Articolo = '446J12768') as NrMotori<anno-1>,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-2> and b.cdc = 'waterproof' and b.Articolo = '446J12768') as NrMotori<anno-2>,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-3> and b.cdc = 'waterproof' and b.Articolo = '446J12768') as NrMotori<anno-3>,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-4> and b.cdc = 'waterproof' and b.Articolo = '446J12768') as NrMotori<anno-4>,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = <anno-5> and b.cdc = 'waterproof' and b.Articolo = '446J12768') as NrMotori<anno-5>\nfrom temp..StatCons a\nwhere a.cdc = 'waterproof' or CodiceCliente in ('C 30099','C 19734','C 20773','C  1389','C 20312','C  3113','C 28975','C 20050','C  2234','C 23301')\norder by 3,1",
    "pro0008": "select distinct a.CodiceAgente, a.NomeAgente, a.CodiceCliente, a.NomeCliente, a.SettoreCliente,\ncase when a.CodiceCliente in ('C   115', 'C  1237', 'C 25398', 'C 25310', 'C 32276', 'C 22780', 'C  2590', 'C  2274', 'C 31524', 'C 17872', 'C 31206', 'C  3047', 'C 23343', 'C 24062', 'C   530', 'C 22056', 'C 19964', 'C  3113', 'C 10705', 'C  2130', 'C 24174', 'C  5774', 'C 31553', 'C 24481', 'C 21335', 'C 20658', 'C 16469', 'C  2519', 'C  1385', 'C 18676', 'C 22886', 'C 21093', 'C  2236', 'C 25045', 'C  2730', 'C   682', 'C  2263', 'C  2535', 'C   396', 'C  2045', 'C   894', 'C 20080', 'C  5221', 'C  3074', 'C 30111', 'C 25338', 'C 27271', 'C 13326', 'C 19732', 'C 21670', 'C  1018', 'C  2589', 'C 20087', 'C 18747', 'C  9113', 'C 27348', 'C 25902', 'C 12634', 'C 25862', 'C 17882', 'C 25636', 'C 18206', 'C 17527', 'C  1389', 'C  9170', 'C  3113', 'C 28975', 'C 20773', 'C 30099', 'C 19734', 'C  2234')\n     then 'S' else 'N' end as WaterproofPoint,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2020 and b.Extra1 = 'waterproof') as Cons20,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2019 and b.Extra1 = 'waterproof') as Cons19,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2018 and b.Extra1 = 'waterproof') as Cons18,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2017 and b.Extra1 = 'waterproof') as Cons17,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2016 and b.Extra1 = 'waterproof') as Cons16,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2015 and b.Extra1 = 'waterproof') as Cons15,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2020 and b.Extra1 = 'waterproof' and b.Articolo = '446J12768') as NrMotori20,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2019 and b.Extra1 = 'waterproof' and b.Articolo = '446J12768') as NrMotori19,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2018 and b.Extra1 = 'waterproof' and b.Articolo = '446J12768') as NrMotori18,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2017 and b.Extra1 = 'waterproof' and b.Articolo = '446J12768') as NrMotori17,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2016 and b.Extra1 = 'waterproof' and b.Articolo = '446J12768') as NrMotori16,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2015 and b.Extra1 = 'waterproof' and b.Articolo = '446J12768') as NrMotori15\nfrom temp..StatCons a\nwhere a.Extra1 = 'waterproof' or CodiceCliente in ('C 30099','C 19734','C 20773','C  1389','C 20312','C  3113','C 28975','C 20050','C  2234','C 23301')\norder by 3,1",
    "pro0009": "select distinct a.CodiceAgente, a.NomeAgente, a.CodiceCliente, a.NomeCliente, a.SettoreCliente,\ncase when a.CodiceCliente in ('C   115', 'C  1237', 'C 25398', 'C 25310', 'C 32276', 'C 22780', 'C  2590', 'C  2274', 'C 31524', 'C 17872', 'C 31206', 'C  3047', 'C 23343', 'C 24062', 'C   530', 'C 22056', 'C 19964', 'C  3113', 'C 10705', 'C  2130', 'C 24174', 'C  5774', 'C 31553', 'C 24481', 'C 21335', 'C 20658', 'C 16469', 'C  2519', 'C  1385', 'C 18676', 'C 22886', 'C 21093', 'C  2236', 'C 25045', 'C  2730', 'C   682', 'C  2263', 'C  2535', 'C   396', 'C  2045', 'C   894', 'C 20080', 'C  5221', 'C  3074', 'C 30111', 'C 25338', 'C 27271', 'C 13326', 'C 19732', 'C 21670', 'C  1018', 'C  2589', 'C 20087', 'C 18747', 'C  9113', 'C 27348', 'C 25902', 'C 12634', 'C 25862', 'C 17882', 'C 25636', 'C 18206', 'C 17527', 'C  1389', 'C  9170', 'C  3113', 'C 28975', 'C 20773', 'C 30099', 'C 19734', 'C  2234')\n     then 'S' else 'N' end as WaterproofPoint,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2020 and b.Extra2 = 'waterproof') as Cons20,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2019 and b.Extra2 = 'waterproof') as Cons19,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2018 and b.Extra2 = 'waterproof') as Cons18,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2017 and b.Extra2 = 'waterproof') as Cons17,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2016 and b.Extra2 = 'waterproof') as Cons16,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2015 and b.Extra2 = 'waterproof') as Cons15,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2020 and b.Extra2 = 'waterproof' and b.Articolo = '446J12768') as NrMotori20,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2019 and b.Extra2 = 'waterproof' and b.Articolo = '446J12768') as NrMotori19,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2018 and b.Extra2 = 'waterproof' and b.Articolo = '446J12768') as NrMotori18,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2017 and b.Extra2 = 'waterproof' and b.Articolo = '446J12768') as NrMotori17,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2016 and b.Extra2 = 'waterproof' and b.Articolo = '446J12768') as NrMotori16,\n(select isnull(cast(sum(b.Quantita ) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.AnnoTrasporto = 2015 and b.Extra2 = 'waterproof' and b.Articolo = '446J12768') as NrMotori15\nfrom temp..StatCons a\nwhere a.Extra2 = 'waterproof' or CodiceCliente in ('C 30099','C 19734','C 20773','C  1389','C 20312','C  3113','C 28975','C 20050','C  2234','C 23301')\norder by 3,1",
    "pro0010": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith arranged as(\nselect Operatore, isnull([ocv] ,0) as TesteOCV, isnull([ocw] ,0) as TesteOCW, isnull([ocd] ,0) as TesteOCD, isnull([pre] ,0) as TestePRE, isnull([prw] ,0) as TestePRW,\n                  isnull([ocvx],0) as RigheOCV, isnull([ocwx],0) as RigheOCW, isnull([ocdx],0) as RigheOCD, isnull([prex],0) as RighePRE, isnull([prwx],0) as RighePRW,\n                  isnull([ocvy],0) as ImporOCV, isnull([ocwy],0) as ImporOCW, isnull([ocdy],0) as ImporOCD, isnull([prey],0) as ImporPRE, isnull([prwy],0) as ImporPRW\nfrom\n(\nselect u.Descrizione as Operatore, t.Tipodoc as tipodoc, t.Tipodoc + 'x' as tipodocx, t.Tipodoc + 'y' as tipodocy, Count(distinct t.progressivo) as Teste, Count(*) as Righe, SUM(r.TOTNETTORIGAEURO) as Importo\nfrom TESTEDOCUMENTI t\n     left outer join EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\n     left outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\n     inner join RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\n     left outer join STORICOMAG s on s.IDTESTA = t.PROGRESSIVO and r.IDRIGA = s.RIGADOC\n\t left outer join ced..Ubicazioni l on s.CODUBICAZIONE = l.ubicazione\nwhere t.tipodoc in ('ocv', 'ocw', 'ocd','pre','prw')\n      and u.CodUtente in (select codice from temp..Tecnici where classe in ('Prodotto Finito'))\n      and datadoc >= @dadata and datadoc <= @adata\ngroup by u.Descrizione, t.Tipodoc\n) as ground\nPivot(\nsum(Teste)\nfor tipodoc in ([ocv], [ocw], [ocd],[pre],[prw])\n) as Final\nPivot(\nsum(Righe)\nfor Tipodocx in ([ocvx], [ocwx], [ocdx],[prex],[prwx])\n) as Final2\nPivot(\nsum(Importo)\nfor Tipodocy in ([ocvy], [ocwy], [ocdy],[prey],[prwy])\n) as Final3\n)\nselect Operatore,  sum(TesteOCV) as TesteOCV, sum(TesteOCW) as TesteOCW, sum(TesteOCD) as TesteOCD, sum(TestePRE) as TestePRE, sum(TestePRW) as TestePRW,\n       sum(RigheOCV) as RigheOCV, sum(RigheOCW) as RigheOCW, sum(RigheOCD) as RigheOCD, sum(RighePRE) as RighePRE, sum(RighePRW) as RighePRW,\n       sum(ImporOCV) as ImporOCV, sum(ImporOCW) as ImporOCW, sum(ImporOCD) as ImporOCD, sum(ImporPRE) as ImporPRE, sum(ImporPRW) as ImporPRW\nfrom arranged\ngroup by operatore\norder by 1",
    "pro0011": "select t.ESERCIZIO as Esercizio, t.TIPODOC as TipoDoc, t.NUMERODOC as NumeroDoc, cast(t.DATADOC as date) as DataDoc, t.CODCLIFOR as CodiceCliente, a.DSCCONTO1 as RagioneSociale, a.NomeAgente, u.Descrizione as Utente, r.CODART as Articolo, r.DESCRIZIONEART as Descrizione,\n       cast(isnull(x.DataConsegna,r.Dataconsegna) as date) as DataConsegna, cast(r.QTAPREZZO as float) as QuantitàRiga, cast(r.QTAPREZZORES as float) as QuantitàResidua, cast(r.TOTNETTORIGAEURO as float) as Imponibile, p.NomeFornitore, datediff(day,isnull(x.DataConsegna,r.Dataconsegna), GETDATE()) as GiorniRitardo\nfrom TESTEDOCUMENTI t\n     inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n\t inner join EXTRATESTEDOC x on t.PROGRESSIVO =  x.IDTESTA\n\t left outer join NDTabTecnici u on x.ND_UTECREAZ = u.CodUtente\n\t left outer join ANAARTICOLIPROD p on r.CODART = p.CODICEART\n\t inner join Col_Soggetti a on t.CODCLIFOR = a.CODCONTO\nwhere x.ND_UTECREAZ in (select codice from temp..Tecnici where classe in ('Prodotto Finito'))\nand t.DOCCHIUSO = 0 and r.RIGACHIUSA = 0 and t.TIPODOC like 'oc%' and r.TIPORIGA = 'N'\nand isnull(x.DataConsegna,r.Dataconsegna) < cast(GETDATE() as date)\norder by t.PROGRESSIVO",
    "pro0012": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect t.ESERCIZIO as Esercizio, g.DSCAGENTE as NomeAgente, u.Descrizione as Utente, t.TIPODOC as TipoDoc, t.NUMERODOC as NumeroDoc, t.CODCLIFOR as CodiceCliente, q.DSCCONTO1 as RagioneSociale, r.CODART as Articolo, r.DESCRIZIONEART as Descrizione, c.Descrizione as Causa, a.Descrizione as Attribuzione, cast(r.QTA1MAG as float) As Quantità, cast(r.TOTNETTORIGAEURO as float) as Importo\nfrom TESTEDOCUMENTI t\n     inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n\t inner join EXTRARIGHEDOC x on t.PROGRESSIVO = x.IDTESTA and r.IDRIGA = x.IDRIGA\n\t inner join ND_Resi_TabCauseReso c on x.CausaReso = c.Codice inner join ND_Resi_TabAttribuzioneReso a on x.AttribuzioneReso = a.Codice\n\t inner join ANAGRAFICACF q on t.CODCLIFOR = q.CODCONTO\n\t inner join EXTRATESTEDOC w on t.PROGRESSIVO = w.IDTESTA\n\t left outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\n\t left outer join ANAGRAFICAAGENTI g on t.CODAGENTE1 = g.CODAGENTE\n\t where t.ESERCIZIO >= 2018 and t.tipodoc in ('ACB','ACR','ACV') -- rcb contro riparazione\n      and w.ND_UTECREAZ in (select codice from temp..Tecnici where classe in ('Prodotto Finito'))\n\t  --and t.DOCCHIUSO = 0 and r.RIGACHIUSA = 0\n\t  and t.DataDoc between @dadata and @adata",
    "pro0013": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith ground as\n(\nselect t.ESERCIZIO as Esercizio, g.DSCAGENTE as NomeAgente, u.Descrizione as Utente, t.TIPODOC as TipoDoc, t.NUMERODOC as NumeroDoc, t.CODCLIFOR as CodiceCliente, q.DSCCONTO1 as RagioneSociale, r.CODART as Articolo, r.DESCRIZIONEART as Descrizione, c.Descrizione as Causa, a.Descrizione as Attribuzione, cast(r.QTA1MAG as float) As Quantità, cast(r.TOTNETTORIGAEURO as float) as Importo\nfrom TESTEDOCUMENTI t\n     inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n\t inner join EXTRARIGHEDOC x on t.PROGRESSIVO = x.IDTESTA and r.IDRIGA = x.IDRIGA\n\t inner join ND_Resi_TabCauseReso c on x.CausaReso = c.Codice inner join ND_Resi_TabAttribuzioneReso a on x.AttribuzioneReso = a.Codice\n\t inner join ANAGRAFICACF q on t.CODCLIFOR = q.CODCONTO\n\t inner join EXTRATESTEDOC w on t.PROGRESSIVO = w.IDTESTA\n\t left outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\n\t left outer join ANAGRAFICAAGENTI g on t.CODAGENTE1 = g.CODAGENTE\n\t where t.ESERCIZIO >= 2018 and t.tipodoc in ('ACB','ACR','ACV') -- rcb contro riparazione\n      and w.ND_UTECREAZ in (select codice from temp..Tecnici where classe in ('Prodotto Finito'))\n\t  and t.DATADOC >= @dadata and t.DATADOC <= @adata\n)\nselect Utente, NomeAgente, COUNT(*) as Quantità\nfrom ground\ngroup by Utente, NomeAgente\norder by 1",
    "pro0014": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @forn   varchar(7) = '<cardcode>';\nselect ocv.IDTESTA as testaocv, cast(ocv.ESERCIZIO as nvarchar) + ' ' + ocv.TIPODOC + ' ' + cast(ocv.NUMERODOC as nvarchar) as OCV,\n       ofa.IDTESTA as testaofa, cast(ofa.ESERCIZIO as nvarchar) + ' ' + ofa.TIPODOC + ' ' + cast(ofa.NUMERODOC as nvarchar) as OFA,\n       dcv.IDTESTA as testadcv, cast(dcv.ESERCIZIO as nvarchar) + ' ' + dcv.TIPODOC + ' ' + cast(dcv.NUMERODOC as nvarchar) as DCV,\n       dfa.IDTESTA as testadfa, cast(dfa.ESERCIZIO as nvarchar) + ' ' + dfa.TIPODOC + ' ' + cast(dfa.NUMERODOC as nvarchar) as DFA,\n--       ofa.IDTESTA as testaofa, ofa.TIPODOC, dcv.IDTESTA as testadcv, dcv.TIPODOC, dfa.IDTESTA as testadfa, dfa.TIPODOC,\n       ocv.CODART as Articolo, ocv.DESCRIZIONEART as descrizione, p.NomeFornitore, cast(dtc.DATAINIZIOTRASP as date) as DataConsegnaCliente, cast(dtf.DATADOC as date) as dataConsegnaFornitore,\n\t   cast(dcv.QTAPREZZO as float) as Quantità, cast(dcv.TOTNETTORIGAEURO as float) as Imponibile,\n\t   DATEDIFF(day, dtf.DATADOC, dtc.DATAINIZIOTRASP) as GiorniPermanenzaInMagColfert\nfrom RIGHEDOCUMENTI ofa\n     inner join RIGHEDOCUMENTI ocv on ofa.IDTESTARP = ocv.IDTESTA and ofa.IDRIGARP = ocv.IDRIGA\n     inner join RIGHEDOCUMENTI dcv on dcv.IDTESTARP = ocv.IDTESTA and dcv.IDRIGARP = ocv.IDRIGA and dcv.TIPODOC in ('dcv','fca')\n     inner join RIGHEDOCUMENTI dfa on dfa.IDTESTARP = ofa.IDTESTA and dfa.IDRIGARP = ofa.IDRIGA and dfa.TIPODOC in ('dfa')\n\t left outer join ANAARTICOLIPROD p on ocv.CODART = p.CODICEART\n\t inner join TESTEDOCUMENTI dtc on dcv.IDTESTA = dtc.PROGRESSIVO\n\t inner join TESTEDOCUMENTI dtf on dfa.IDTESTA = dtf.PROGRESSIVO\n\t inner join ANARISERVATICF r on p.FORNPREFACQ = r.CODCONTO\nwhere dtc.DATADOC >= @dadata and dtc.DATADOC <= @adata\nand ofa.TIPODOC like 'Of%' and ocv.TIPODOC like 'oc%' and r.CODSETTORE = 202 and p.FORNPREFACQ = @forn",
    "pro0015": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @forn   varchar(7) = '<cardcode>';\nwith ground as(\nselect ocv.IDTESTA as testaocv, cast(ocv.ESERCIZIO as nvarchar) + ' ' + ocv.TIPODOC + ' ' + cast(ocv.NUMERODOC as nvarchar) as OCV,\n       ofa.IDTESTA as testaofa, cast(ofa.ESERCIZIO as nvarchar) + ' ' + ofa.TIPODOC + ' ' + cast(ofa.NUMERODOC as nvarchar) as OFA,\n       dcv.IDTESTA as testadcv, cast(dcv.ESERCIZIO as nvarchar) + ' ' + dcv.TIPODOC + ' ' + cast(dcv.NUMERODOC as nvarchar) as DCV,\n       dfa.IDTESTA as testadfa, cast(dfa.ESERCIZIO as nvarchar) + ' ' + dfa.TIPODOC + ' ' + cast(dfa.NUMERODOC as nvarchar) as DFA,\n--       ofa.IDTESTA as testaofa, ofa.TIPODOC, dcv.IDTESTA as testadcv, dcv.TIPODOC, dfa.IDTESTA as testadfa, dfa.TIPODOC,\n       ocv.CODART as Articolo, ocv.DESCRIZIONEART as descrizione, p.NomeFornitore, cast(dtc.DATAINIZIOTRASP as date) as DataConsegnaCliente, cast(dtf.DATADOC as date) as dataConsegnaFornitore,\n\t   cast(dcv.QTAPREZZO as float) as Quantità, cast(dcv.TOTNETTORIGAEURO as float) as Imponibile,\n\t   DATEDIFF(day, dtf.DATADOC, dtc.DATAINIZIOTRASP) as GiorniPermanenzaInMagColfert\nfrom RIGHEDOCUMENTI ofa\n     inner join RIGHEDOCUMENTI ocv on ofa.IDTESTARP = ocv.IDTESTA and ofa.IDRIGARP = ocv.IDRIGA\n     inner join RIGHEDOCUMENTI dcv on dcv.IDTESTARP = ocv.IDTESTA and dcv.IDRIGARP = ocv.IDRIGA and dcv.TIPODOC in ('dcv','fca')\n     inner join RIGHEDOCUMENTI dfa on dfa.IDTESTARP = ofa.IDTESTA and dfa.IDRIGARP = ofa.IDRIGA and dfa.TIPODOC in ('dfa')\n\t left outer join ANAARTICOLIPROD p on ocv.CODART = p.CODICEART\n\t inner join TESTEDOCUMENTI dtc on dcv.IDTESTA = dtc.PROGRESSIVO\n\t inner join TESTEDOCUMENTI dtf on dfa.IDTESTA = dtf.PROGRESSIVO\n\t inner join ANARISERVATICF r on p.FORNPREFACQ = r.CODCONTO\nwhere dtc.DATADOC >= @dadata and dtc.DATADOC <= @adata\nand ofa.TIPODOC like 'Of%' and ocv.TIPODOC like 'oc%' and r.CODSETTORE = 202 and p.FORNPREFACQ = @forn\n)\nselect NomeFornitore, GiorniPermanenzaInMagColfert, COUNT(*) as NrRigheCoinvolte, SUM(Imponibile) as ImponibileRelativo\nfrom ground\ngroup by NomeFornitore, GiorniPermanenzaInMagColfert\norder by nomefornitore, GiorniPermanenzaInMagColfert",
    "pro0016": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @forn   varchar(7) = '<cardcode>';\nwith ground as (\nselect t.Descrizione as Utente, c.Mese as Mese, cast(cast(sum(c.TotRiga) as decimal(15,2)) as float) as Venduto, 0 as Ordinato\nfrom stats..consegnato c left outer join stats..Tecnici t on c.CreatoreOrd = t.Codice\nwhere c.DataDoc >= @dadata and c.DataDoc <= @adata\nand t.classe in ('Prodotto Finito')\nand c.CodiceFornitore = @forn\ngroup by t.Descrizione, c.Mese\n\nunion\nselect u.Descrizione, MONTH(t.DATADOC), 0, cast(SUM(r.QTA1MAGRES * r.PREZZOUNITNETTOEURO) as float)\nfrom TESTEDOCUMENTI t\n     inner join EXTRATESTEDOC x on t.PROGRESSIVO = x.IDTESTA\n\t inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n\t inner join stats..Tecnici u on x.ND_UTECREAZ = u.Codice\n\t inner join colfert..ANAGRAFICAARTICOLIPROD p on r.CODART = p.CODICEART and p.ESERCIZIO = YEAR(GETDATE())\nwhere t.esercizio >= <anno>\n      and t.TIPODOC like 'oc%'\n      and u.classe in ('Prodotto Finito')\n\t  and r.RIGACHIUSA = 0\n\t  and p.FORNPREFACQ = @forn\ngroup by u.Descrizione, MONTH(t.DATADOC)\n)\nselect distinct g.Utente,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 1) as VendutoGennaio,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 2) as VendutoFebbraio,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 3) as VendutoMarzo,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 4) as VendutoAprile,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 5) as VendutoMaggio,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 6) as VendutoGiugno,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 7) as VendutoLuglio,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 8) as VendutoAgosto,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 9) as VendutoSettembre,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 10) as VendutoOttobre,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 11) as VendutoNovembre,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 12) as VendutoDicembre,\n       (select isnull(SUM(Ordinato),0) from ground v where g.utente = v.utente ) as OrdinatoAperto\nfrom ground g\norder by 1",
    "pro0017": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect 'Colfert' as Azienda, NomeUtente, DataDoc as InizioTrasporto, CodiceAgente, NomeAgente, CodiceCliente, RagioneSociale as NomeCliente, TipoDoc, NumeroDoc, Articolo, Descrizione, DescExtra as Estesa,\n       NomeFornitore, PrezzoUnitLordo, ScontoEsteso, PrezzoUnitNetto, Quantita, TotRiga as NettoRiga, CostoUltimoUnit, CostoUltimoTot\nfrom stats..consegnato\nwhere CategoriaFornitore = 'PROD. FINITO' and DataDoc between @dadata and @adata\norder by DataDoc",
    "pro0018": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith ground as (\nselect t.Descrizione as Utente, c.Mese as Mese, cast(cast(sum(c.TotRiga) as decimal(15,2)) as float) as Venduto, 0 as Ordinato\nfrom stats..consegnato c left outer join TEMP..Tecnici t on c.CreatoreOrd = t.Codice\nwhere c.DataDoc >= @dadata and c.DataDoc <= @adata\nand t.classe in ('Prodotto Finito')\ngroup by t.Descrizione, c.Mese\nunion\nselect u.Descrizione, MONTH(t.DATADOC), 0, cast(SUM(r.QTA1MAGRES * r.PREZZOUNITNETTOEURO) as float)\nfrom TESTEDOCUMENTI t\n     inner join EXTRATESTEDOC x on t.PROGRESSIVO = x.IDTESTA\n\t inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n\t inner join TEMP..Tecnici u on x.ND_UTECREAZ = u.Codice\n\t inner join colfert..ANAGRAFICAARTICOLIPROD p on r.CODART = p.CODICEART and p.ESERCIZIO = YEAR(GETDATE())\nwhere t.esercizio >= <anno>\n      and t.TIPODOC like 'oc%'\n      and u.classe in ('Prodotto Finito')\n\t  and r.RIGACHIUSA = 0\ngroup by u.Descrizione, MONTH(t.DATADOC)\n)\nselect distinct g.Utente,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 1) as VendutoGennaio,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 2) as VendutoFebbraio,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 3) as VendutoMarzo,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 4) as VendutoAprile,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 5) as VendutoMaggio,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 6) as VendutoGiugno,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 7) as VendutoLuglio,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 8) as VendutoAgosto,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 9) as VendutoSettembre,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 10) as VendutoOttobre,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 11) as VendutoNovembre,\n       (select isnull(SUM(Venduto ),0) from ground v where g.utente = v.utente and v.Mese = 12) as VendutoDicembre,\n       (select isnull(SUM(Ordinato),0) from ground v where g.utente = v.utente ) as OrdinatoAperto\nfrom ground g\norder by 1",
    "pro0019": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @forn   varchar(7) = '<cardcode>';\nselect\n  t1.ESERCIZIO, t1.TIPODOC, t1.NUMERODOC, t1.CODCLIFOR, r1.CODART, r1.DESCRIZIONEART, r1.UMGEST, cast(r1.QTAGEST as float) as Quantita, cast(t1.DATADOC as date) as DataBolla, t2.TIPODOC,\n  t2.NUMERODOC, cast(t2.DATADOC as date) as DataOrdine, cast(r2.DATACONSEGNA as date) as DataConsegnaOrdine, cast(r1.TOTNETTORIGA as float) as NettoRiga,\n  DATEDIFF(day, cast(t1.DATADOC as date), cast(r2.DATACONSEGNA as date)) as Ritardo\nfrom\n  testedocumenti t1\n  inner join RIGHEDOCUMENTI r1 on t1.PROGRESSIVO = r1.IDTESTA\n  inner join TESTEDOCUMENTI t2 on r1.idtestarp = t2.progressivo\n  inner join RIGHEDOCUMENTI r2 on r1.idtestarp = r2.IDTESTA and r1.IDRIGARP = r2.IDRIGA\nwhere\n      t1.TIPODOC like 'df%'\n  and r1.CODART in (select codiceart from ANAGRAFICAARTICOLIPROD where esercizio = year(getdate()) and fornprefacq = @forn)\n  and t1.DATADOC >= @dadata and t1.DATADOC <= @adata",
    "pro0020": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith arranged as(\nselect Operatore, Fornitore, isnull([ocv] ,0) as TesteOCV, isnull([ocw] ,0) as TesteOCW, isnull([ocd] ,0) as TesteOCD, isnull([pre] ,0) as TestePRE, isnull([prw] ,0) as TestePRW,\n                  isnull([ocvx],0) as RigheOCV, isnull([ocwx],0) as RigheOCW, isnull([ocdx],0) as RigheOCD, isnull([prex],0) as RighePRE, isnull([prwx],0) as RighePRW,\n                  isnull([ocvy],0) as ImporOCV, isnull([ocwy],0) as ImporOCW, isnull([ocdy],0) as ImporOCD, isnull([prey],0) as ImporPRE, isnull([prwy],0) as ImporPRW\nfrom\n(\nselect u.Descrizione as Operatore, f.CODCONTO + ' - ' + f.DSCCONTO1 as Fornitore, t.Tipodoc as tipodoc, t.Tipodoc + 'x' as tipodocx, t.Tipodoc + 'y' as tipodocy, Count(distinct t.progressivo) as Teste, Count(*) as Righe, SUM(r.TOTNETTORIGAEURO) as Importo\nfrom colfert..TESTEDOCUMENTI t\n     left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\n     left outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\n     inner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\n     left outer join colfert..STORICOMAG s on s.IDTESTA = t.PROGRESSIVO and r.IDRIGA = s.RIGADOC\n\t left outer join colfert..ANAGRAFICAARTICOLIPROD p on r.CODART = p.codiceart and p.ESERCIZIO = year(getdate())\n\t left outer join colfert..anagraficacf f on p.FORNPREFACQ = f.CODCONTO\n\t left outer join ced..Ubicazioni l on s.CODUBICAZIONE = l.ubicazione\nwhere t.tipodoc in ('ocv', 'ocw', 'ocd','pre','prw')\n      and u.CodUtente in (select codice from temp..Tecnici where classe in ('Prodotto Finito'))\n      and datadoc >= @dadata and datadoc <= @adata\ngroup by u.Descrizione, t.Tipodoc, f.CODCONTO + ' - ' + f.DSCCONTO1\n) as ground\nPivot(\nsum(Teste)\nfor tipodoc in ([ocv], [ocw], [ocd],[pre],[prw])\n) as Final\nPivot(\nsum(Righe)\nfor Tipodocx in ([ocvx], [ocwx], [ocdx],[prex],[prwx])\n) as Final2\nPivot(\nsum(Importo)\nfor Tipodocy in ([ocvy], [ocwy], [ocdy],[prey],[prwy])\n) as Final3\n)\nselect Operatore, Fornitore, sum(TesteOCV) as TesteOCV, sum(TesteOCW) as TesteOCW, sum(TesteOCD) as TesteOCD, sum(TestePRE) as TestePRE, sum(TestePRW) as TestePRW,\n       sum(RigheOCV) as RigheOCV, sum(RigheOCW) as RigheOCW, sum(RigheOCD) as RigheOCD, sum(RighePRE) as RighePRE, sum(RighePRW) as RighePRW,\n       sum(ImporOCV) as ImporOCV, sum(ImporOCW) as ImporOCW, sum(ImporOCD) as ImporOCD, sum(ImporPRE) as ImporPRE, sum(ImporPRW) as ImporPRW\nfrom arranged\ngroup by operatore, Fornitore\norder by 1,2",
    "pro0021": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect tp.Descrizione as TipoOrdine, t.TipoDoc, t.NumeroDoc, cast(t.datadoc as Date) as DataDoc, u.Descrizione as Utente, t.CODCLIFOR as CodiceCliente, a.DSCCONTO1 as RagioneSociale,\n  r.codart as CodiceArticolo, stats.dbo.piClean(r.DESCRIZIONEART) as Descrizione, f.codconto as CodFornitore, f.DSCCONTO1 as Fornitore,\n  cast(r.TOTNETTORIGAEURO as float) as Imponibile\nfrom testedocumenti t\n  inner join EXTRATESTEDOC x on t.PROGRESSIVO = x.IDTESTA\n  inner join NDTabTipiOrdine tp on x.tipoordine = tp.Codice\n  inner join NDTabTecnici u on x.ND_UTECREAZ = u.CodUtente\n  inner join ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\n  inner join RIGHEDOCUMENTI r on t.progressivo = r.IDTESTA\n  left outer join ANAGRAFICAARTICOLIPROD pro on r.codart = pro.CODICEART and pro.ESERCIZIO = year(getdate())\n  left outer join ANAGRAFICACF f on pro.FORNPREFACQ = f.CODCONTO\nwhere x.TipoOrdine in (21,22,23,24) and t.tipodoc like 'oc%'\n  and t.datadoc between @dadata and @adata\norder by t.progressivo",
    "pro0022": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect cast(r.dataconsegna as date) as DataConsegna, s.codconto + ' - ' + a.DSCCONTO1 as Fornitore, cast(sum(r.QTA1MAGRES * r.PREZZOUNITNETTOEURO) as float) as ImportoResiduo,\n  count(distinct r.idtesta) as NrOrdini,\n  (select count(*) from colfert..righedocumenti q where q.rigachiusa = 0 and q.tipodoc like 'oc%' and q.codart in (select w.codart from colfert..righedocumenti w where w.idtesta = r.idtesta)) as NrClientiInAttesa\nfrom colfert..testedocumenti t\n  inner join colfert..righedocumenti r on t.progressivo = r.IDTESTA\n  inner join colfert..anagraficariservaticf s on t.codclifor = s.codconto and s.esercizio = 2022\n  inner join colfert..anagraficacf a on t.codclifor = a.codconto\nwhere r.dataconsegna between @dadata and @adata\n  and r.rigachiusa = 0\n  and t.tipodoc like 'of%'\n  and s.codsettore = 202\ngroup by cast(r.dataconsegna as date), s.codconto, a.DSCCONTO1, r.idtesta\nhaving sum(r.QTA1MAGRES * r.PREZZOUNITNETTOEURO) > 0\norder by 1",
    "pro0023": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.NomeUtente, d.TipoDoc, d.NumeroDoc, d.CodiceAgente, d.NomeAgente, d.CodiceCliente, d.RagioneSociale, d.DocChiuso, d.DataDoc, d.CodiceFornitore, d.NomeFornitore, cast(sum(d.TotRiga) as decimal(12,2)) as ImponibilePreventivo, d.DExtra0 as Destino,\n(select t.numerodoc from colfert..testedocumenti t where t.progressivo = cast(d.DExtra1 as int) ) as NumeroChiusura,\n(select cast(t.datadoc as date) from colfert..testedocumenti t where t.progressivo = cast(d.DExtra1 as int) ) as DataChiusura,\n(select cast(sum(r.totriga) as decimal(12,2)) from stats..ordinato r where r.progressivo = cast(d.DExtra1 as int) and d.CodiceFornitore = r.CodiceFornitore ) as ImponibileChiusura\nfrom stats..Preventivato d\nwhere d.datadoc between @dadata and @adata\ngroup by d.TipoDoc, d.NumeroDoc, d.CodiceCliente, d.DocChiuso, d.DataDoc, d.CodiceFornitore, d.NomeFornitore, d.DExtra0, d.DExtra1, d.NomeUtente, d.RagioneSociale, d.CodiceAgente, d.NomeAgente\norder by 2,3",
    "pro0024": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect TipoDoc, NumeroDoc, CodiceCliente, DataDoc, Cdc, NomeUtente, TipoOrdine, Pagamento, TipoRiga, Articolo, Descrizione, DescExtra, UM, Quantita, PrezzoUnitLordo, ScontoEsteso, PrezzoUnitNetto, TotRiga, CostoUltimoUnit, CostoUltimoTot, MargineUnit, MargineTot, RagioneSociale, Sede, CodiceAgente, NomeAgente, Gruppo, CategoriaArticolo, CategoriaStatistica, CodiceFornitore, NomeFornitore\nfrom stats..consegnato\nwhere TipoOrdine = 'Ermetec'\nand datadoc between @dadata and @adata\norder by 1",
    "pro0025": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect d.Magazzino, d.DataDoc, d.NomeUtente, d.Codice, d.RagioneSociale, d.CodiceFornitore, d.NomeFornitore, d.TipoDoc + ' ' + CAST(d.numerodoc as nvarchar) as Documento, COUNT(distinct d.progressivo) as NRBolle, cast(SUM(d.TotRiga) as decimal(12,2)) as Venduto,\n (select count(distinct t.progressivo) from COLFERT..TESTEDOCUMENTI t where t.datadoc >= @dadata and t.datadoc <= @adata and t.codclifor = d.codicefornitore and t.tipodoc = 'dfa') as NRDfaPeriodo,\n (select count(distinct t.progressivo) from COLFERT..TESTEDOCUMENTI t where t.datadoc = d.datadoc and t.codclifor = d.codicefornitore and t.tipodoc = 'dfa') as NRDfaGiorno\nfrom Stats..consegnato d\nwhere d.CategoriaFornitore = 'PROD. FINITO' and d.Anno = year(@dadata) and d.datadoc >= @dadata and d.datadoc <= @adata\ngroup by d.Magazzino, d.DataDoc, d.NomeUtente, d.Codice, d.RagioneSociale, d.CodiceFornitore, d.NomeFornitore, d.TipoDoc, d.NumeroDoc",
    "pro0026": "select\n  CodiceFornitore, NomeFornitore,\n  ConsegnatoAnnoCorrente, ConsegnatoAnnoPrecedente, ConsegnatoAnnoTV, ConsegnatoAnnoVA, ConsegnatoAnnoPrecedente_TV, ConsegnatoAnnoPrecedente_VA, Consegnato2AnniFa, Consegnato2AnniFa_TV, Consegnato2AnniFa_VA, Consegnato3AnniFa, Consegnato3AnniFa_TV, Consegnato3AnniFa_VA, Consegnato4AnniFa, Consegnato4AnniFa_TV, Consegnato4AnniFa_VA, Consegnato5AnniFa, Consegnato5AnniFa_TV, Consegnato5AnniFa_VA,\n  cast(ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente as decimal(12,2)) as Incremento_AnnoCorrenteVsAnnoPrecedente,\n  case when ConsegnatoAnnoPrecedente = 0 then 0 else cast((ConsegnatoAnnoCorrente - ConsegnatoAnnoPrecedente) / ConsegnatoAnnoPrecedente * 100 as decimal(12,2)) end as Incremento_AnnoCorrenteVsAnnoPrecedentePerc,\n  CostoVendutoAnnoCorrente, CostoVendutoAnnoPrecedente, CostoVendutoAnnoCorrente_TV, CostoVendutoAnnoCorrente_VA, CostoVendutoAnnoPrecedente_TV, CostoVendutoAnnoPrecedente_VA, CostoVenduto2AnniFa_TV, CostoVenduto2AnniFa_VA, CostoVenduto3AnniFa_TV, CostoVenduto3AnniFa_VA, CostoVenduto4AnniFa_TV, CostoVenduto4AnniFa_VA, CostoVenduto5AnniFa_TV, CostoVenduto5AnniFa_VA,\n  cast(CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente as decimal(12,2)) as IncrementoCosto_AnnoCorrenteVsAnnoPrecedente,\n  case when CostoVendutoAnnoPrecedente = 0 then 0 else cast((CostoVendutoAnnoCorrente - CostoVendutoAnnoPrecedente) / CostoVendutoAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoCosto_AnnoCorrenteVsAnnoPrecedentePerc,\n  RicevimentiAnnoCorrente, RicevimentiAnnoPrecedente, Ricevimenti2AnniFa, Ricevimenti3AnniFa, Ricevimenti4AnniFa, Ricevimenti5AnniFa,\n  cast(RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente as decimal(12,2)) as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedente,\n  case when RicevimentiAnnoPrecedente = 0 then 0 else cast((RicevimentiAnnoCorrente - RicevimentiAnnoPrecedente) / RicevimentiAnnoPrecedente * 100 as decimal(12,2)) end as IncrementoRicevimenti_AnnoCorrenteVsAnnoPrecedentePerc,\n  MargineAnnoCorrente, MargineAnnoPrecedente, Margine2AnniFa, Margine3AnniFa, Margine4AnniFa, Margine5AnniFa,\n  cast(MargineAnnoCorrente - MargineAnnoPrecedente as decimal(12,2)) as IncrementoMargine_AnnoCorrenteVsAnnoPrecedente\nfrom stats..AnalisiFornitoriLev2\nwhere CategoriaFornitore = 'PROD. FINITO' and Period = 'Month<mese>'\norder by 1",
    "pro0027": "with ground as (\nselect d.codicefornitore, d.nomefornitore\nfrom stats..consegnato d\nwhere anno > 2023-5 and CategoriaFornitore = 'PROD. FINITO'\ngroup by d.codicefornitore, d.nomefornitore\n)\nselect g.CodiceFornitore, g.NomeFornitore,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 0) as ScontoMedioAnnoCorrente,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 1) as ScontoMedioUnAnnofa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 2) as ScontoMedioDueAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 3) as ScontoMedioTreAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 4) as ScontoMedioQuattroAnniFa,\n (select case when sum(c.quantita * c.PrezzoUnitLordo) > 0 then 100 - round(sum(c.TotRiga) / sum(c.PrezzoUnitLordo * c.Quantita) * 100,1) else 0 end from stats..consegnato c where c.CodiceFornitore = g.codicefornitore\tand c.anno = year(getdate()) - 5) as ScontoMedioCinqueAnniFa\nfrom ground g\norder by 1",
    "pro0028": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect t.Esercizio, t.TipoDoc, t.NumeroDoc, cast(t.DATADOC as date) as DataDoc, t.DOCCHIUSO as Chiuso, t.CODCLIFOR as CodiceCliente, a.DSCCONTO1 as RagioneSociale, t.NUMRIFDOC as Riferimento,\n  t.CODAGENTE1 as CodiceAgente, s.DSCAGENTE as Agente, u.Descrizione as UtenteCreazione, o.Descrizione as TipoOrdine, y.TracciaNonConf as CodiceNonConformità,\n  r.TIPORIGA as TipoRiga, r.CODART as Articolo, stats.dbo.piclean(r.DESCRIZIONEART) as Descrizione, stats.dbo.piclean(y.DescrizioneEstesa) as DescrizioneEstesa, r.UMGEST as UM,\n  cast(r.QTAGEST as float) as Qta, cast(r.QTAGESTRES as float) as QtaRes, cast(r.PREZZOUNITLORDOEURO as float) as LordoUnitario, r.SCONTIESTESI as Sconto, cast(r.PREZZOUNITNETTO as float) as NettoUnitario, cast(r.TOTNETTORIGAEURO as float) as TotaleRiga,\n  isnull(CR.Descrizione,'') AS CausaReso, isnull(ar.Descrizione,'') as AttribuzioneReso, isnull(p.FORNPREFACQ,'') as CodiceFornitore, isnull(f.DSCCONTO1,'') as NomeFornitore\nfrom\n  TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.PROGRESSIVO = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join colfert..EXTRARIGHEDOC y on t.progressivo = y.IDTESTA and r.IDRIGA = y.IDRIGA\n  inner join colfert..ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\n  left outer join COLFERT..NDTabTipiOrdine o on x.TipoOrdine = o.Codice\n  left outer join COLFERT..NDTabTecnici u on x.ND_UTECREAZ = u.CodUtente\n  left outer join COLFERT..ANAGRAFICAAGENTI s on t.CODAGENTE1 = s.CODAGENTE\n  left outer join ND_Resi_TabCauseReso        cr on y.CausaReso = cr.Codice\n  left outer join ND_Resi_TabAttribuzioneReso ar ON Y.AttribuzioneReso = AR.Codice\n  left outer join ANAGRAFICAARTICOLIPROD p on r.codart = p.codiceart and p.esercizio = year(getdate())\n  left outer join anagraficacf f on p.FORNPREFACQ = f.CODCONTO\nwhere t.TIPODOC in ('CNC','OCR') and t.datadoc between @dadata and @adata\norder by y.TracciaNonConf, t.PROGRESSIVO",
    "xpro0028": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect t.Esercizio, t.TipoDoc, t.NumeroDoc, cast(t.DATADOC as date) as DataDoc, t.DOCCHIUSO as Chiuso, t.CODCLIFOR as CodiceCliente, a.DSCCONTO1 as RagioneSociale, t.NUMRIFDOC as Riferimento,\n  t.CODAGENTE1 as CodiceAgente, s.DSCAGENTE as Agente, u.Descrizione as UtenteCreazione, o.Descrizione as TipoOrdine, y.TracciaNonConf as CodiceNonConformità,\n  r.TIPORIGA as TipoRiga, r.CODART as Articolo, stats.dbo.piclean(r.DESCRIZIONEART) as Descrizione, stats.dbo.piclean(y.DescrizioneEstesa) as DescrizioneEstesa, r.UMGEST as UM,\n  cast(r.QTAGEST as float) as Qta, cast(r.QTAGESTRES as float) as QtaRes, cast(r.PREZZOUNITLORDOEURO as float) as LordoUnitario, r.SCONTIESTESI as Sconto, cast(r.PREZZOUNITNETTO as float) as NettoUnitario, cast(r.TOTNETTORIGAEURO as float) as TotaleRiga\nfrom\n  TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.PROGRESSIVO = x.IDTESTA\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join colfert..EXTRARIGHEDOC y on t.progressivo = y.IDTESTA and r.IDRIGA = y.IDRIGA\n  inner join colfert..ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\n  left outer join COLFERT..NDTabTipiOrdine o on x.TipoOrdine = o.Codice\n  left outer join COLFERT..NDTabTecnici u on x.ND_UTECREAZ = u.CodUtente\n  left outer join COLFERT..ANAGRAFICAAGENTI s on t.CODAGENTE1 = s.CODAGENTE\n  left outer join colfert..extrarighedoc y2 on y.TracciaNonConf = y2.TracciaNonConf\n  left outer join colfert..testedocumenti t2 on y2.idtesta = t2.progressivo\nwhere t2.TIPODOC = 'CNC' and t2.datadoc between @dadata and @adata\norder by y.TracciaNonConf, t.PROGRESSIVO",
    "pro0029": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect 'Colfert' as Azienda, NomeUtente, DataDoc as InizioTrasporto, CodiceAgente, NomeAgente, CodiceCliente, RagioneSociale as NomeCliente, TipoDoc, NumeroDoc, Articolo, Descrizione, DescExtra as Estesa,\n       NomeFornitore, PrezzoUnitLordo, ScontoEsteso, PrezzoUnitNetto, Quantita, TotRiga as NettoRiga, CostoUltimoUnit, CostoUltimoTot\nfrom stats..ordinato\nwhere CategoriaFornitore = 'PROD. FINITO' and DataDoc between @dadata and @adata\norder by DataDoc",
    "acq0001": "select u.Note as ClasseUtente, u.Descrizione as Utente, t.CODCLIFOR + ' - ' + c.DSCCONTO1 as Fornitore, case when em.Generico = 'S' then 'Generico' else case em.TipoGestione when 'D' then 'Discontinuo' when 'E' then 'Non ordinabile' when 'M' then 'Manuale' when 'R' then 'Regolare' else 'Non classificato' end end as TipoArticolo\n  , cast(sum(r.QTAGEST) as float) as Quantità, cast(sum(r.TOTNETTORIGA * t.SEGNO) as float) as Importo\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA\n  inner join colfert..PARAMETRIDOC p on t.TIPODOC = p.CODICE\n  inner join colfert..ANAGRAFICACF c on t.CODCLIFOR = c.CODCONTO\n  inner join colfert..EXTRATESTEDOC et ON et.IDTESTA = t.PROGRESSIVO\n  inner join colfert..EXTRARIGHEDOC er ON er.IDTESTA = r.IDTESTA AND er.IDRIGA = r.IDRIGA\n  inner join colfert..NDTabTecnici u on et.ND_UTECREAZ = u.CodUtente\n  left outer join colfert..EXTRAMAG em on r.CODART = em.CODART\nwhere p.tipo = 'O' and p.CLIFOR = 'F' and t.ESERCIZIO = <anno> and r.TOTNETTORIGA > 0\ngroup by u.Note, u.Descrizione, t.CODCLIFOR + ' - ' + c.DSCCONTO1, case when em.Generico = 'S' then 'Generico' else case em.TipoGestione when 'D' then 'Discontinuo' when 'E' then 'Non ordinabile' when 'M' then 'Manuale' when 'R' then 'Regolare' else 'Non classificato' end end\norder by 1,2,3,4",
    "acq0002": "select  'Vendite' as Listino, isnull(gp.CODCLIFOR,'') as CodiceCliente, isnull(a.DSCCONTO1,'') as NomeCliente, isnull(a.Settore,'') as Settore, isnull(a.CodiceAgente,'') as CodiceAgente, isnull(a.NomeAgente,'') as NomeAgente, cast(gp.CODGRUPPOPREZZIMAG as nvarchar) + ' - ' + gm.DESCRIZIONE as GruppoMagazzino, isnull(gp.codart,'') as Articolo, isnull(i.DESCRIZIONE,'') as Descrizione, cast(gr.QTAMINIMA as float) as QtaMinima, cast(gr.PREZZO_MAGGEURO as float) as Prezzo, gr.SCONTO_UNICO as Sconto\nfrom  colfert..GESTIONEPREZZI gp left outer join colfert..GESTIONEPREZZIRIGHE gr on gp.PROGRESSIVO = gr.RIFPROGRESSIVO\n      left outer join colfert..Col_Soggetti a on gp.CODCLIFOR = a.CODCONTO\n\t  left outer join colfert..ANAGRAFICAARTICOLI i on gp.codart = i.CODICE\n\t  left outer join colfert..TABRAGGRUPPAPREZZI gm on gp.CODGRUPPOPREZZIMAG = gm.CODICE\nwhere gp.FINEVALIDITA = '20901231' and gr.NRLISTINO = 21\norder by 2",
    "acq0003": "select  'Acquisti' as Listino, gp.CODCLIFOR as CodiceFornitore, a.DSCCONTO1 as NomeFornitore, cast(gp.CODGRUPPOPREZZIMAG as nvarchar) + ' - ' + gm.DESCRIZIONE as GruppoMagazzino, gp.codart as Articolo, i.DESCRIZIONE as Descrizione, cast(gr.QTAMINIMA as float) as QtaMinima, cast(gr.PREZZO_MAGGEURO as float) as Prezzo, gr.SCONTO_UNICO as Sconto\nfrom  colfert..GESTIONEPREZZI gp left outer join colfert..GESTIONEPREZZIRIGHE gr on gp.PROGRESSIVO = gr.RIFPROGRESSIVO\n      left outer join colfert..anagraficacf a on gp.CODCLIFOR = a.CODCONTO\n\t  left outer join colfert..ANAGRAFICAARTICOLI i on gp.codart = i.CODICE\n\t  left outer join colfert..TABRAGGRUPPAPREZZI gm on gp.CODGRUPPOPREZZIMAG = gm.CODICE\nwhere gp.FINEVALIDITA = '20901231' and gr.NRLISTINO = 11\norder by 2",
    "acq0004.pre": "truncate table ced..giactemp\ninsert into ced..giactemp select s.CODART, a.DESCRIZIONE, '', '', 'INI', 0, 0, '20011231', SUM(s.GIACENZA * s.QTA1UM), 0 from colfert..STORICOMAG s inner join colfert..ANAGRAFICAARTICOLI a on s.codart = a.CODICE inner join colfert..extramag x on a.codice = x.codart where s.codart not like '%#%' and s.CODDEPOSITO = 'MAG01' and x.Generico = 'N' group by s.CODART, s.CODDEPOSITO, a.DESCRIZIONE order by s.CODART\ninsert into ced..giactemp select s.codart, isnull(a.descrizione,''), isnull(s.CODCLIFOR,''), isnull(c.DSCCONTO1,''), s.TIPODOC, s.NUMERODOC, s.ESERCIZIO, s.DATADISP, (s.ORDINATO * s.QTA1UM) - (s.IMPEGNATO * s.QTA1UM), 0 from colfert..STORICOMAG s inner join colfert..ANAGRAFICAARTICOLI a on s.codart = a.CODICE inner join colfert..extramag x on a.codice = x.codart inner join colfert..anagraficacf c on s.CODCLIFOR = c.CODCONTO where (s.ORDINATO != 0 or s.impegnato != 0) and s.codart is not null and s.CODDEPOSITO = 'MAG01' and x.Generico = 'N' order by s.PROGRESSIVO\nupdate g set g.datamov = g.datamov - p.TAPPRONTACQ from ced..giactemp g inner join colfert..anagraficaarticoliprod p on g.codart = p.CODICEART and p.ESERCIZIO = year(getdate()) where g.doctype != 'ini'\nWITH CTE_Saldo AS ( SELECT codice, codart, datamov, quantita, SUM(quantita) OVER (PARTITION BY codart ORDER BY codart,datamov,codice ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS saldo FROM ced..giactemp ) UPDATE ced..giactemp SET saldo = CTE_Saldo.saldo FROM CTE_Saldo WHERE ced..giactemp.codice = CTE_Saldo.codice",
    "acq0004": "select * from ced..giactemp where saldo < 0 and datamov >= getdate() and codart not like '%#%' order by 1",
    "acq0005": "declare @adata  DateTime = '<todate>';\nSELECT isnull(v.FornPrefAcq,'') + ' - ' + isnull(a.DSCCONTO1,'') as FornitorePref, cast(cf.CODICE as nvarchar) + ' - ' + cf.DESCRIZIONE as CategoriaFornitore,\n       v.CodArt, v.Descrizione,\n\t   (select top 1 z.riferimento from RELAZIONICFV z where z.articolo = v.codart and z.codclifor = v.FornPrefAcq and z.Nd_Attivo = 1) as CodFornitore,\n\t   v.TipoGestione,\n--\t   cast(v.Gruppo as nvarchar) + ' - ' + g.DESCRIZIONE as Gruppo, cast(v.Categoria as nvarchar) + ' - ' + c.DESCRIZIONE as Categoria, cast(v.CodCategoriaStat as nvarchar) + ' - ' + s.DESCRIZIONE as CategoriaStat,\n       x.ClasseABC,\n--       r.CODAGENTE1 as CodiceBuyer,\n       aa.dscagente as DescrBuyer,\n       v.GiacAttuale - v.Impegnato as GiacenzaTeorica,\n       v.GiacAttuale,\n--\t   v.GiacIniziale, v.Carico,\n\t   v.Scarico, v.Ordinato,\n\t   (select top 1 cast(x.datadoc as date) from testedocumenti x inner join righedocumenti y on x.progressivo = y.idtesta where y.RIGACHIUSA = 0 and y.CODART = v.CodArt and x.TipoDoc in('OFA','OFT','OFB') order by x.DATADOC asc) as DataInvioOrdine,\n\t   (select top 1 cast(y.DATACONSEGNA as date) from testedocumenti x inner join righedocumenti y on x.progressivo = y.idtesta where y.RIGACHIUSA = 0 and y.CODART = v.CodArt and x.TipoDoc in('OFA','OFT','OFB') order by x.DATADOC asc) as DataConsegnaFornitore,\n\t   v.Impegnato,\n--\t   v.GiacAttuale+Ordinato-Impegnato As Disponibile,\n       v.CostoUltimo, v.DataCostoUltimo,\n--\t   isnull(v.CostoMedio,0) as CostoMedio, v.Listino11,\n\t   v.Vendite as VenditeAM,\n--     v.VenditeMese, v.VenditeMese1, v.VenditeMese2, v.VenditeMese3, v.VenditeMese4, v.VenditeMese5, v.VenditeMese6, v.VenditeMese7, v.VenditeMese8, v.VenditeMese9, v.VenditeMese10, v.VenditeMese11, v.VenditeMese12,\n     (select isnull(sum(q.totriga * SIGN(q.totriga)),0) from stats..consegnato q where q.Articolo = v.codart and q.DataDoc >= GetDate()-365) as ValoreDelVendutoAM,\n     (select isnull(sum(q.totriga * SIGN(q.totriga)),0) from stats..bolleacquistato q where q.Articolo = v.codart and q.datadoc  >= GetDate()-365 ) as ImportoAcquistatoAM,\n     (select isnull(sum(q.Quantita * SIGN(q.totriga)),0) from stats..bolleacquistato q where q.Articolo = v.codart and q.datadoc >= GetDate()-365 ) as QuantitaAcquistatoAM,\n\t v.GiacAttuale * v.CostoUltimo as ValoreMagazzino,\n     (select count(t.progressivo) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.progressivo = r.IDTESTA where t.DATADOC >= GetDate()-365 and t.tipodoc like 'O%' and t.CODCLIFOR like 'C%' and r.CODART = v.CODART ) as RigheOrdiniAnnualiAM,\n\t ir.GiacenzaMedia, ir.IndiceRotazione,\n\t isnull(gad.mag01,0) + isnull(gad.magva,0) as GiacenzaAllaData,\n\t isnull(gad.mag01,0) as GiacenzaAllaDataMAG01,\n\t isnull(gad.magva,0) as GiacenzaAllaDataMAGVA,\n     (select isnull(sum(q.totriga),0) from stats..bolleacquistato q where q.Articolo = v.codart and q.Anno = year(getDate()) and q.datadoc <= @adata and q.TipoRiga != 'Omaggio' ) as ImportoAcquistatoAllaData,\n     (select isnull(sum(q.Quantita * SIGN(q.totriga)),0) from stats..bolleacquistato q where q.Articolo = v.codart and q.Anno = year(getDate()) and q.datadoc <= @adata ) as QuantitaAcquistatoAllaData,\n     (select isnull(sum(q.totriga * SIGN(q.totriga)),0) from stats..consegnato q where q.Articolo = v.codart and q.DataDoc <= @adata and Anno = year(@adata)) as ImportoDelVendutoAllaData,\n     (select isnull(sum(q.Quantita * SIGN(q.totriga)),0) from stats..consegnato q where q.Articolo = v.codart and q.DataDoc <= @adata and Anno = year(@adata)) as QuantitaDelVendutoAllaData,\n\t (select isnull(cast(SUM(sm.GIACENZA * sm.QTA1UM) as float),0) as Scarico from colfert..storicomag sm where CODART = v.CodArt and ESERCIZIO = YEAR(getdate()) and DATAMOV <= @adata and CODDEPOSITO = 'mag01' and CODCAUSALE not in (235,236, 950, 998, 999) and GIACENZA = -1 and CODCLIFOR like 'c%') as ScaricoMag01AllaData,\n\t (select isnull(cast(SUM(sm.GIACENZA * sm.QTA1UM) as float),0) as Scarico from colfert..storicomag sm where CODART = v.CodArt and ESERCIZIO = YEAR(getdate()) and DATAMOV <= @adata and CODDEPOSITO = 'magva' and CODCAUSALE not in (235,236, 950, 998, 999) and GIACENZA = -1 and CODCLIFOR like 'c%') as ScaricoMagVAAllaData\nFROM CED..Nd_Vis_GiacenzaImmediataStoricoVendutoDef v\n--     left outer join colfert..TABGRUPPI g on v.Gruppo = g.CODICE\n--     left outer join colfert..TABCATEGORIE c on v.Categoria = c.CODICE\n--     left outer join colfert..TABCATEGORIESTAT s on v.CodCategoriaStat = s.CODICE\n     left outer join colfert..EXTRAMAG x on v.CODART = x.CODART\n   left outer join colfert..anagraficacf a on v.FornPrefAcq = a.CODCONTO\n   left outer join colfert..ANAGRAFICARISERVATICF r on v.FornPrefAcq = r.CODCONTO and r.ESERCIZIO = year(getDate())\n   left outer join colfert..ANAGRAFICAAGENTI aa on r.codagente1 = aa.CODAGENTE\n   left outer join colfert..TABSETTORI cf on r.CODSETTORE = cf.CODICE\n   inner join stats..indicerotazione ir on v.CODART = ir.articolo\n   left outer join colfert..GiacenzeAllaData(@adata) gad on v.codart = gad.CodiceArticolo\nWHERE (v.FornPrefAcq != '' ) and not(v.TipoGestione = 'D' and v.GiacAttuale = 0 and v.Impegnato = 0) and aa.dscagente != 'Buyer - YCO' and aa.dscagente != 'Buyer - Andrea Borsato' and x.Generico = 'N'\n--WHERE (v.FornPrefAcq != '' )\n--WHERE (FornPrefAcq = '<cardcode>' )\nORDER BY 1,2",
    "acq0006": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @dadata2 DateTime = @dadata;\ndeclare @adata2  DateTime = @adata;\ndeclare @forn   varchar(7) = '<cardcode>';\nset @dadata2 = DATEADD(YEAR,-1,@dadata);\nset @adata2 = DATEADD(YEAR,-1,@adata);\nwith pippo as(\nselect isnull(CodiceAgente + ' - ' + NomeAgente,'') as Agente, CodiceCliente + ' - ' + NomeCliente as Cliente, CodiceFornitore + ' - ' + NomeFornitore as Fornitore,--, isnull(cast(sum(NettoRiga) as float),0) as Venduto, isnull(cast(sum(CostoUltimoTot) as float),0) as Costo\n(select isnull(cast(sum(NettoRiga) as float),0)      from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.CodiceFornitore = a.CodiceFornitore and b.CodiceAgente = a.CodiceAgente and b.InizioTrasporto >= @dadata  and b.InizioTrasporto <= @adata ) as VendutoPeriodo,\n(select isnull(cast(sum(CostoUltimoTot) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.CodiceFornitore = a.CodiceFornitore and b.CodiceAgente = a.CodiceAgente and b.InizioTrasporto >= @dadata  and b.InizioTrasporto <= @adata ) as CostoPeriodo,\n(select isnull(cast(sum(NettoRiga) as float),0)      from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.CodiceFornitore = a.CodiceFornitore and b.CodiceAgente = a.CodiceAgente and b.InizioTrasporto >= @dadata2 and b.InizioTrasporto <= @adata2) as VendutoPeriodoPrecedente,\n(select isnull(cast(sum(CostoUltimoTot) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.CodiceFornitore = a.CodiceFornitore and b.CodiceAgente = a.CodiceAgente and b.InizioTrasporto >= @dadata2 and b.InizioTrasporto <= @adata2) as CostoPeriodoPrecedente\nfrom temp..StatCons a\nwhere a.InizioTrasporto >= @dadata2 and a.InizioTrasporto <= @adata and a.CodiceFornitore = @forn\ngroup by CodiceCliente, CodiceCliente + ' - ' + NomeCliente, CodiceFornitore,  CodiceFornitore + ' - ' + NomeFornitore, CodiceAgente + ' - ' + NomeAgente, CodiceAgente\n)\nselect * from pippo where VendutoPeriodo != 0 or CostoPeriodo != 0 or VendutoPeriodoPrecedente != 0 or CostoPeriodoPrecedente != 0\norder by 1,2",
    "acq0007": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @dadata2 DateTime = @dadata;\ndeclare @adata2  DateTime = @adata;\ndeclare @forn   varchar(7) = '<cardcode>';\nset @dadata2 = DATEADD(YEAR,-1,@dadata);\nset @adata2 = DATEADD(YEAR,-1,@adata);\nwith pippo as(\nselect isnull(CodiceAgente + ' - ' + NomeAgente,'') as Agente, CodiceCliente + ' - ' + NomeCliente as Cliente, CodiceFornitore + ' - ' + NomeFornitore as Fornitore,--, isnull(cast(sum(NettoRiga) as float),0) as Venduto, isnull(cast(sum(CostoUltimoTot) as float),0) as Costo\n(select isnull(cast(sum(NettoRiga) as float),0)      from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.CodiceFornitore = a.CodiceFornitore and b.CodiceAgente = a.CodiceAgente and b.InizioTrasporto >= @dadata  and b.InizioTrasporto <= @adata ) as VendutoPeriodo,\n(select isnull(cast(sum(CostoUltimoTot) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.CodiceFornitore = a.CodiceFornitore and b.CodiceAgente = a.CodiceAgente and b.InizioTrasporto >= @dadata  and b.InizioTrasporto <= @adata ) as CostoPeriodo,\n(select isnull(cast(sum(NettoRiga) as float),0)      from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.CodiceFornitore = a.CodiceFornitore and b.CodiceAgente = a.CodiceAgente and b.InizioTrasporto >= @dadata2 and b.InizioTrasporto <= @adata2) as VendutoPeriodoPrecedente,\n(select isnull(cast(sum(CostoUltimoTot) as float),0) from temp..StatCons b where b.CodiceCliente = a.CodiceCliente and b.CodiceFornitore = a.CodiceFornitore and b.CodiceAgente = a.CodiceAgente and b.InizioTrasporto >= @dadata2 and b.InizioTrasporto <= @adata2) as CostoPeriodoPrecedente\nfrom temp..StatCons a\nwhere a.InizioTrasporto >= @dadata2 and a.InizioTrasporto <= @adata and a.CodiceCliente = @forn\ngroup by CodiceCliente, CodiceCliente + ' - ' + NomeCliente, CodiceFornitore,  CodiceFornitore + ' - ' + NomeFornitore, CodiceAgente + ' - ' + NomeAgente, CodiceAgente\n)\nselect * from pippo where VendutoPeriodo != 0 or CostoPeriodo != 0 or VendutoPeriodoPrecedente != 0 or CostoPeriodoPrecedente != 0\norder by 1,2",
    "acq0008": "select a.CodiceArticolo, dbo.piClean(a.DescrizioneArticolo) as DescrizioneArticolo, a.Gruppo, a.CategoriaArticolo, a.CategoriaStatistica, a.NomeFornitore, a.NomeBuyer, a.TipoGestioneTV, a.TipoGestioneVA, a.Generico,\n   isnull(colfert.dbo.ColGiacenza(a.codicearticolo),0) as GiacenzaTv, isnull(colfert.dbo.ColGiacenzaVA(a.codicearticolo),0) as GiacenzaVA,\n   (select isnull(sum(totriga),0) from stats..consegnato d where d.Articolo = a.CodiceArticolo and d.DataDoc >= getdate()-365 ) as VendutoAnnoMobile,\n   cast(l11.PREZZO as float) as LordoListino , cast(l11.Nd_PrezzoNettoCalc as float) as PrezzoNettoCalc, cast(l11.Nd_PrezzoNetto as float) as PrezzoNettoMaggiorato,\n\t(select top 1 cast(isnull(r.PREZZO_MAGGEURO,0) as float) from GESTIONEPREZZI t inner join GESTIONEPREZZIRIGHE r on t.PROGRESSIVO = r.RIFPROGRESSIVO where t.codart = a.CodiceArticolo and t.CODCLIFOR like 'F%' and getdate() between t.INIZIOVALIDITA and t.FINEVALIDITA order by r.datamodifica desc) as NettoPP,\n   l11.Nd_ScontoUnico as ScontoListino,\n\t(select top 1 r.SCONTO_UNICO from GESTIONEPREZZI t inner join GESTIONEPREZZIRIGHE r on t.PROGRESSIVO = r.RIFPROGRESSIVO where t.codart = a.CodiceArticolo and t.CODCLIFOR like 'F%' and getdate() between t.INIZIOVALIDITA and t.FINEVALIDITA order by r.datamodifica desc) as ScontoPP,\n   cast(l11.Nd_PrcRicarico as float) as Ricarico, l11.Nd_CalcolaPrezzo as TipoCalcolo,\n   cast(l21.PREZZOEURO as float) as LordoVendita, cast(isnull(l49.PREZZO,0) as float) as PrezzoMedio,\n   (select isnull(sum(Quantita),0) from stats..consegnato d where d.Articolo = a.CodiceArticolo and d.DataDoc >= getdate()-365 ) as QuantitaVendutaAnnoMobile,\n   (select isnull(sum(TotRiga),0) from stats..acquistato d where d.Articolo = a.CodiceArticolo and d.DataDoc >= getdate()-365 ) as AcquistatoAnnoMobile\nfrom stats..arts a\n  inner join colfert..LISTINIARTICOLI l11 on a.CodiceArticolo = l11.CODART and l11.nrlistino = 11\n  inner join colfert..LISTINIARTICOLI l21 on a.CodiceArticolo = l21.CODART and l21.nrlistino = 21\n  left outer join colfert..LISTINIARTICOLI l49 on a.CodiceArticolo = l49.CODART and l49.nrlistino = 4900\nwhere CodiceArticolo not like '%#%' and IsGenericoContatore = 0\norder by 1",
    "acq0009": "select CodiceArticolo, DescrizioneArticolo, Gruppo, CategoriaArticolo, CodiceFornitore, NomeFornitore, CategoriaFornitore, NomeBuyer, TipoGestioneTV, TipoGestioneVA, QtaPerConfezione, Lordo, AExtra0 as TipoGestione, AExtra1 as UM,\n  (select isnull(sum(Quantita),0) from Stats..consegnato d where d.datadoc >= GETDATE()-365 and d.articolo = a.codicearticolo and d.Sede = 'Treviso') as ConsegnatoTV_AnnoMobile,\n  (select isnull(sum(Quantita),0) from Stats..consegnato d where d.datadoc >= GETDATE()-365 and d.articolo = a.codicearticolo and d.Sede = 'Varese') as ConsegnatoVA_AnnoMobile,\n  isnull(gtv.Giacenza,0) as GiacenzaTV,\n  isnull(gtv.Impegnato,0) as ImpegnatoTV,\n  isnull(gva.Giacenza,0) as GiacenzaVA,\n  isnull(gva.Impegnato,0) as ImpegnatoVA\nfrom Stats..Arts a\n  left outer join stats..giacenze gtv on a.CodiceArticolo = gtv.Articolo and gtv.Magazzino = 'MAG01'\n  left outer join stats..giacenze gva on a.CodiceArticolo = gva.Articolo and gva.Magazzino = 'MAGVA'\nwhere CodiceArticolo not in (select articolo from Stats..consegnato where Magazzino in ('MAG01','Acema','MAGVA') and DataDoc >= GETDATE()-365)\n      and isnull(gtv.Giacenza,0) + isnull(gva.Giacenza,0) > 0\n\t  and a.CategoriaFornitore in ('ALLUMINIO - FERRO','COMPLEMENTI','LEGNO/PVC','UTENSILERIA')\n\t  and CodiceArticolo not in (select codice from colfert..anagraficaarticoli where nd_datainserimento >= getdate()-365)\norder by 1",
    "acq0010": "select a.CodiceFornitore + ' - ' + a.NomeFornitore as Fornitore,\n  round(sum(g1.MAG01 * l.PREZZOEURO),2) as ValoreInizioAnno, round(sum(g2.mag01 * l.PREZZOEURO),2) as ValoreAdesso,\n  round(- sum(g1.MAG01 * l.PREZZOEURO) + sum(g2.mag01 * l.PREZZOEURO),2) as Differenza,\n  round(case when sum(g1.MAG01 * l.PREZZOEURO) = 0 then 0 else (- sum(g1.MAG01 * l.PREZZOEURO) + sum(g2.mag01 * l.PREZZOEURO)) / sum(g1.MAG01 * l.PREZZOEURO) * 100 end,2) as DifferenzaPerc\nfrom Stats..Arts a\n  inner join colfert..GiacenzeAllaData('20230101') g1 on a.CodiceArticolo = g1.CodiceArticolo\n  inner join colfert..GiacenzeAllaData(getdate()) g2 on a.CodiceArticolo = g2.CodiceArticolo\n  inner join COLFERT..LISTINIARTICOLI l on a.CodiceArticolo = l.CODART AND l.NRLISTINO = 3008\ngroup by a.CodiceFornitore, a.NomeFornitore\norder by 1",
    "acq0011": "select a.CodiceFornitore, a.RagioneSociale, a.CategoriaFornitore, a.Anno, a.TipoDoc, a.NumeroDoc, a.DataDoc, MONTH(a.DataDoc) as Mese, a.Buyer, a.Articolo, a.Quantita, a.DataConfermata,\n  b.TIPODOC + ' ' + CAST(b.numerodoc as varchar) + ' del ' + CAST(b.esercizio as varchar)  as DFA,\n  b.datadoc as DataDFA,\n  b.datarifdoc as DataBollaForn,\n  datediff(d, a.DataConfermata, b.datarifdoc) as DiffDataConfermataEBollaForn,\n  datediff(d, b.datarifdoc, b.datadoc) as DiffDFAeBollaForn,\n  datediff(d, a.DataConfermata, a.DataDoc) as [DiffDataConfermataEDataDoc(TempoConfermatoSpedizione)],\n  datediff(d, b.datarifdoc, a.DataDoc) as DiffDatabollaeDataDoc\nfrom (\n\tselect a.progressivo, a.idriga, a.CodiceCliente as CodiceFornitore, a.RagioneSociale, a.CategoriaFornitore, a.Anno, a.TipoDoc, a.NumeroDoc, a.DataDoc, a.NomeBuyer as Buyer, a.Articolo, a.Quantita,\n\t  cast(r.DATACONSEGNA as date) as DataConsegna, cast(r.DATACONSEGNARICHIESTA as date) as DataConfermata, datediff(d, r.DATACONSEGNARICHIESTA, r.DATACONSEGNA) as DifferenzaGiorni,\n\t  (select top 1 idtesta  from colfert..righedocumenti where idtestarp = a.progressivo and idrigarp = a.idriga) as ProgDFA\n\tfrom stats..acquistato a\n\t  inner join colfert..RIGHEDOCUMENTI r on a.progressivo = r.idtesta and a.idriga = r.idriga\n\t  inner join colfert..testedocumenti t on a.progressivo = t.progressivo\n\twhere a.anno = <anno>\n) a\n  inner join colfert..testedocumenti b on a.progdfa = b.progressivo\nwhere datediff(d, a.DataConfermata, b.datarifdoc) > 0\norder by a.progressivo, a.idriga",
    "acq0012": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Anno, NomeUtente, CodiceCliente, RagioneSociale, TipoOrdine, TipoDoc, NumeroDoc, DataDoc, month(DataDoc) as Mese,\n  TipoRiga, Articolo, Descrizione, UM, Quantita, PrezzoUnitLordo, ScontoEsteso, PrezzoUnitNetto, TotRiga,\n  cast(isnull(x.ScontoExtra,0) as float) as scontoExtra,\n  PrezzoUnitNetto / (1+(isnull(x.ScontoExtra,0)/100)) as PrezzoUnitarioSenzaScontoExtra,\n  TotRiga / (1+(isnull(x.ScontoExtra,0)/100)) as TotaleRigaSenzaScontoExtra,\n  (TotRiga / (1+(isnull(x.ScontoExtra,0)/100))) - TotRiga as DeltaScontoNoSconto\nfrom stats..acquistato d inner join colfert..extrarighedoc x on d.progressivo = x.idtesta and d.idriga = x.idriga\nwhere d.datadoc between @dadata and @adata --and x.scontoextra != 0",
    "acq0013": "declare @anno int = '<anno>';\ndeclare @fornitore nvarchar(20) = '<cardcode>';\nselect Anno, Mese, CodiceCliente, RagioneSociale, Settore, CodiceAgente, NomeAgente, CodiceFornitore, NomeFornitore, CategoriaFornitore, sum(TotRiga) as Importo, sum(CostoUltimoTot) as CostoRelativo, sum(MargineTot) as MargineRelativo\nfrom stats..consegnato c\nwhere anno = @anno and codicefornitore = @fornitore\ngroup by Anno, Mese, CodiceCliente, RagioneSociale, Settore, CodiceAgente, NomeAgente, CodiceFornitore, NomeFornitore, CategoriaFornitore\norder by 1,2,3",
    "acq0014": "declare @anno int = '<anno>';\ndeclare @fornitore nvarchar(20) = '<cardcode>';\nselect Anno, Mese, CodiceCliente, RagioneSociale, Settore, CodiceAgente, NomeAgente, CodiceFornitore, NomeFornitore, CategoriaFornitore, sum(TotRiga) as Importo, sum(CostoUltimoTot) as CostoRelativo, sum(MargineTot) as MargineRelativo\nfrom stats..ordinato c\nwhere anno = @anno and codicefornitore = @fornitore\ngroup by Anno, Mese, CodiceCliente, RagioneSociale, Settore, CodiceAgente, NomeAgente, CodiceFornitore, NomeFornitore, CategoriaFornitore\norder by 1,2,3",
    "acq0015": "select a.CodiceFornitore, a.RagioneSociale, a.CategoriaFornitore, a.Anno, a.TipoDoc, a.NumeroDoc, a.DataDoc, MONTH(a.DataDoc) as Mese, a.NomeBuyer, a.Articolo, a.Descrizione, a.Quantita, cast(r.DATACONSEGNARICHIESTA as date) as DataConfermata, cast(r.DataConsegna as date) as DataConsegna,\n       datediff(d, r.DataConsegna, r.DATACONSEGNARICHIESTA) as DiffDataConsEDataConf\nfrom stats..acquistato a\n  inner join colfert..RIGHEDOCUMENTI r on a.progressivo = r.idtesta and a.idriga = r.idriga\n  inner join colfert..testedocumenti t on a.progressivo = t.progressivo\nwhere r.RIGACHIUSA = 0\norder by 15 asc",
    "acq0016": "select CodiceArticolo, DescrizioneArticolo, a.Gruppo, CategoriaArticolo, CodiceFornitore, NomeFornitore, CategoriaFornitore, NomeBuyer, TipoGestioneTV, TipoGestioneVA, QtaPerConfezione,\n       Lordo as ListinoColfert, Costo, AExtra0 as TipoGestione, AExtra1 as UM, a.NonTrasferibile, a.FlagMagazzinoPreferenziale as ForzaMagazzino, i.CODDEPOSITO as Magazzino,\n  (select isnull(sum(Quantita),0) from Stats..consegnato d where d.datadoc >= GETDATE()-365 and d.articolo = a.codicearticolo and d.Sede = 'Varese') as ConsegnatoClientiVA_AM_DaTV,\n  isnull(gtv.Giacenza,0) as GiacenzaTV,\n  isnull(gtv.Impegnato,0) as ImpegnatoTV\nfrom Stats..Artext a\ninner join colfert..ANAGRAFICAARTICOLI i on a.CodiceArticolo = i.CODICE\n  left outer join stats..giacenze gtv on a.CodiceArticolo = gtv.Articolo and gtv.Magazzino = 'MAG01'\nwhere CodiceArticolo not in (select articolo from Stats..consegnato where Magazzino in ('MAGVA','acemaVA','mag50') and DataDoc >= GETDATE()-365)\n      and isnull(gtv.Giacenza,0) > 0\n\t  and a.CategoriaFornitore in ('ALLUMINIO - FERRO','COMPLEMENTI','LEGNO/PVC','UTENSILERIA')\n\t  and CodiceArticolo not in (select codice from colfert..anagraficaarticoli where nd_datainserimento >= getdate()-365)\norder by 1",
    "acq0017": "select CodiceArticolo, DescrizioneArticolo, a.Gruppo, CategoriaArticolo, CodiceFornitore, NomeFornitore, CategoriaFornitore, NomeBuyer, TipoGestioneTV, TipoGestioneVA, QtaPerConfezione,\n       Lordo as ListinoColfert, Costo, AExtra0 as TipoGestione, AExtra1 as UM, a.NonTrasferibile, a.FlagMagazzinoPreferenziale as ForzaMagazzino, i.CODDEPOSITO as Magazzino,\n  (select isnull(sum(Quantita),0) from Stats..consegnato d where d.datadoc >= GETDATE()-365 and d.articolo = a.codicearticolo and d.Sede = 'Treviso') as ConsegnatoClientiTV_AMDaVA,\n  isnull(gva.Giacenza,0) as GiacenzaVA,\n  isnull(gva.Impegnato,0) as ImpegnatoVA\nfrom Stats..Artext a\ninner join colfert..ANAGRAFICAARTICOLI i on a.CodiceArticolo = i.CODICE\n  left outer join stats..giacenze gva on a.CodiceArticolo = gva.Articolo and gva.Magazzino = 'MAGVA'\nwhere CodiceArticolo not in (select articolo from Stats..consegnato where Magazzino in ('mag01','acema','mag50') and DataDoc >= GETDATE()-365)\n      and isnull(gva.Giacenza,0) > 0\n\t  and a.CategoriaFornitore in ('ALLUMINIO - FERRO','COMPLEMENTI','LEGNO/PVC','UTENSILERIA')\n\t  and CodiceArticolo not in (select codice from colfert..anagraficaarticoli where nd_datainserimento >= getdate()-365)\norder by 1",
    "amm0001": "select a.CODCONTO, a.DSCCONTO1, x.InvioFatPostaElettr\nfrom colfert..ANAGRAFICACF a inner join colfert..extraclienti x on a.codconto = x.codconto\nwhere a.CODCONTO in\n(select t.codclifor from colfert..testedocumenti t where t.tipodoc in ('dcb','dcv','rcd','dcd','rca') and year(t.DATAINIZIOTRASP) = <anno> and month(t.DATAINIZIOTRASP) = <mese>)\nand x.InvioFatPostaElettr = 'N' order by 1",
    "amm0002": "with base as (\nselect a.codice as Articolo, a.DESCRIZIONE as Descrizione, a.DESCRESTESA as Estesa, p.FORNPREFACQ as CodFornitore, f.DSCCONTO1 as Fornitore, n.DESCRIZIONE as Nazione, a.NOMENCLCOMBINATA1 as NomencAnagrafica,\n(\n    select top 1 l.NOMENCLCOMBINATA from colfert..RIGHEDOCUMENTI l where l.codart = a.codice and l.esercizio = 2018\n    and l.idtesta =\n\t(\n\t    select top 1 max(r.idtesta) from colfert..righedocumenti r inner join colfert..testedocumenti t on r.idtesta = t.PROGRESSIVO inner join colfert..PARAMETRIDOC p on t.tipodoc = p.codice\n\t    where r.codart = a.codice and r.ESERCIZIO = 2018 and p.tipo = 'f' and p.clifor = 'f'\n    )\n) as NomencDocumento\nfrom colfert..ANAGRAFICAARTICOLI a\n     left outer join colfert..ANAGRAFICAARTICOLIPROD p on (a.CODICE = p.CODICEART and p.ESERCIZIO = 2018)\n\t left outer join colfert..anagraficacf f on p.FORNPREFACQ = f.CODCONTO\n\t left outer join colfert..TABNAZIONI n on f.CODNAZIONE = n.CODICE\n) select * from base where NomencDocumento is not null and NomencDocumento != '' and NomencAnagrafica != NomencDocumento\norder by 1",
    "amm0003": "update n\nset statoreport=7\nFROM COLFERTWEB.[TEMP_METODO].[dbo].[ND_IMPORT_REPORT] n\nJOIN COLFERT.DBO.TESTEDOCUMENTI T ON IDGESTIONALE=T.PROGRESSIVO\nWHERE N.STATOREPORT=1 AND T.DATADOC<= '<todate>' and left(tipodoc,2)='dc'",
    "amm0004": "select c.CodiceCliente, c.NomeCliente,\n(select PARTITAIVA from colfert..ANAGRAFICACF a where c.CodiceCliente = a.CODCONTO) as PartitaIva,\ncast(sum(c.NettoRiga) as float) as Fatt12mesi,\n(select cast(isnull(sum(s.IMPORTOSCEURO),0) as float) from colfert..TABSCADENZE s where s.CODCLIFOR = c.CodiceCliente and esito = 1\t\t\t\t\t\t\t   ) +\n(select cast(isnull(sum(s.IMPORTOSCEURO),0) as float) from colfert..TABSCADENZE s where s.CODCLIFOR = c.CodiceCliente and esito = 0 and DATASCADENZA >= GETDATE() ) as AScadere,\n(select cast(isnull(sum(s.IMPORTOSCEURO),0) as float) from colfert..TABSCADENZE s where s.CODCLIFOR = c.CodiceCliente and esito = 3\t\t\t\t\t\t\t   ) +\n(select cast(isnull(sum(s.IMPORTOSCEURO),0) as float) from colfert..TABSCADENZE s where s.CODCLIFOR = c.CodiceCliente and esito = 0 and DATASCADENZA <  GETDATE() ) as Scaduto,\n(select cast(FIDOEURO as float) from colfert..ANAGRAFICARISERVATICF where CODCONTO = c.CodiceCliente and esercizio = year(getdate()) ) as Fido,\n(select cast(FIDOASSICURATO as float) from colfert..EXTRACLIENTI where CODCONTO = c.CodiceCliente) as FidoAssicurato\nfrom temp..StatCons c\nwhere c.InizioTrasporto >= DATEADD(year,-1,Getdate())\ngroup by c.CodiceCliente, c.NomeCliente\norder by 1",
    "amm0005": "select p.codice as Codice, p.descrizione as Descrizione,\n(select top 1 cast(DATADOC as date) from colfert..TESTEDOCUMENTI t where t.codpagamento = p.codice order by datadoc desc) as DataDocumento,\n(select top 1 tipodoc from colfert..TESTEDOCUMENTI t where t.codpagamento = p.codice order by datadoc desc) as TipoDocumento,\n(select top 1 numerodoc from colfert..TESTEDOCUMENTI t where t.codpagamento = p.codice order by datadoc desc) as NumeroDocumento\nfrom colfert..TABPAGAMENTI p\norder by 1",
    "amm0006": "select a.CODCONTO, a.DSCCONTO1, x.GradeAttuale, cast(x.GradeDate as date) as DataGrade\nfrom colfert..anagraficacf a inner join colfert..EXTRACLIENTI x on a.CODCONTO = x.CODCONTO\nwhere GradeAttuale != ''\norder by 1",
    "amm0007": "select tipodoc as TipoDocumento, numerodoc as Numero, cast(datadoc as date) as DataDocumento, CODCLIFOR as Cliente, CODAGENTE1 as Agente, cast(TOTIMPONIBILEEURO as float) as Imponibile\nfrom colfert..TESTEDOCUMENTI t\n--where TIPODOC in ('fcv','nca','fca','fc2','fce','fai','nfi','pca')\nwhere tipodoc in (select codice from colfert..PARAMETRIDOC where (tipo = 'F' or tipo = 'N') and clifor = 'C')\nand datadoc >= '<fromdate>' and datadoc <= '<todate>' and SPLITPAYMENT = 1\norder by 1,2",
    "amm0008": "with cippa as (\nselect t.TIPODOC as TipoDoc, t.numerodoc as NumeroDoc, cast(t.DATADOC as date) as DataDoc, cast(t.DATAINIZIOTRASP as date) as DataTrasp, t.CODCLIFOR as CodCliFor, a.DSCCONTO1 as RagSoc,\nt.Annotazioni as Annotazioni, t.CODAGENTE1 + '-' + s.DSCAGENTE as Agente,\nr.CODART as Articolo, r.DESCRIZIONEART as Descrizione, cast(r.QTAGEST as float) as Quantita, r.UMGEST as UM, cast(r.PREZZOUNITNETTOEURO as float) as PrezzoUn,  cast(r.TOTNETTORIGAEURO as float) as TotaleRiga,\nisnull(cr.Descrizione,'') as CausaReso, isnull(ar.Descrizione,'') as Attribuzione, y.DescrizioneEstesa as Estesa,\nr.IDTESTARP as OrigProg,\nr.IDRIGARP as OrigRow,\n(select dbo.piGetOrderProg(t.progressivo, r.idriga))    as OrdineProg,\n(select dbo.piGetOrderRow (t.progressivo, r.idriga))    as OrdineRow,\n(select dbo.piGetDeliveryProg(t.progressivo, r.idriga)) as DdtProg,\n(select dbo.piGetDeliveryRow(t.progressivo, r.idriga))  as DdtRow,\n(select dbo.piGetOrder(t.progressivo, r.idriga))    as Ordine,\n(select dbo.piGetDelivery(t.progressivo, r.idriga)) as Ddt,\n(select top 1 dr.IDTESTA from RIGHEDOCUMENTI dr where dr.IDTESTARP = t.PROGRESSIVO and dr.IDRIGARP = r.idriga order by dr.IDTESTA desc) as DestProg,\n(select top 1 dr.IDRIGA  from RIGHEDOCUMENTI dr where dr.IDTESTARP = t.PROGRESSIVO and dr.IDRIGARP = r.idriga order by dr.IDTESTA desc) as DestRow\n\nfrom TESTEDOCUMENTI t\n\t      inner join COLFERT..EXTRATESTEDOC                x on t.PROGRESSIVO = x.IDTESTA\n\t      inner join COLFERT..RIGHEDOCUMENTI               r on t.progressivo = r.Idtesta\n\t      inner join COLFERT..EXTRARIGHEDOC                y on (t.PROGRESSIVO = y.IDTESTA and r.IDRIGA = y.IDRIGA)\n          inner join COLFERT..ANAGRAFICACF                 a on t.CODCLIFOR = a.CODCONTO\n\t left outer join COLFERT..ND_Resi_TabCauseReso        cr on y.CausaReso = cr.Codice\n\t left outer join COLFERT..ND_Resi_TabAttribuzioneReso ar on y.AttribuzioneReso = ar.Codice\n\t left outer join COLFERT..ANAGRAFICAAGENTI             s on t.CODAGENTE1 = s.CODAGENTE\nWHERE  t.tipodoc in ('ACB','ACR','ACS','ACV') and t.esercizio = <anno> and r.TIPORIGA  = 'N'\n)\nselect TipoDoc,NumeroDoc,DataDoc,DataTrasp,CodCliFor,RagSoc,Annotazioni,Agente,Articolo,Descrizione,Quantita,UM,PrezzoUn,TotaleRiga,CausaReso,Attribuzione,Estesa,\n\ndbo.piTecnico((select w.ND_UTECREAZ       from colfert..extratestedoc  w where w.IDTESTA     = cippa.OrigProg                             )) as OrigCreatore,\n(select w.TIPODOC                         from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.OrigProg                             )  as OrigTipo,\n(select w.NUMERODOC                       from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.OrigProg                             )  as OrigNumero,\n(select cast(w.DATADOC as date)           from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.OrigProg                             )  as OrigData,\n(select cast(w.TOTNETTORIGAEURO as float) from colfert..RIGHEDOCUMENTI w where w.IDTESTA     = cippa.OrigProg and w.idriga = cippa.OrigRow)  as OrigTotale,\n(select cast(w.QTAGEST as float)          from colfert..RIGHEDOCUMENTI w where w.IDTESTA     = cippa.OrigProg and w.idriga = cippa.OrigRow)  as OrigQuantita,\n\ndbo.piTecnico((select w.ND_UTECREAZ       from colfert..extratestedoc  w where w.IDTESTA     = cippa.OrdineProg                               )) as OrdineCreatore,\n(select w.TIPODOC                         from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.OrdineProg                               )  as OrdineTipo,\n(select w.NUMERODOC                       from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.OrdineProg                               )  as OrdineNumero,\n(select cast(w.DATADOC as date)           from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.OrdineProg                               )  as OrdineData,\n(select cast(w.TOTNETTORIGAEURO as float) from colfert..RIGHEDOCUMENTI w where w.IDTESTA     = cippa.OrdineProg and w.idriga = cippa.OrdineRow)  as OrdineTotale,\n(select cast(w.QTAGEST as float)          from colfert..RIGHEDOCUMENTI w where w.IDTESTA     = cippa.OrdineProg and w.idriga = cippa.OrdineRow)  as OrdineQuantita,\n\ndbo.piTecnico((select w.ND_UTECREAZ       from colfert..extratestedoc  w where w.IDTESTA     = cippa.DdtProg                            )) as DdtCreatore,\n(select w.TIPODOC                         from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.DdtProg                            )  as DdtTipo,\n(select w.NUMERODOC                       from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.DdtProg                            )  as DdtNumero,\n(select cast(w.DATADOC as date)           from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.DdtProg                            )  as DdtData,\n(select cast(w.TOTNETTORIGAEURO as float) from colfert..RIGHEDOCUMENTI w where w.IDTESTA     = cippa.DdtProg and w.idriga = cippa.DdtRow)  as DdtTotale,\n(select cast(w.QTAGEST as float)          from colfert..RIGHEDOCUMENTI w where w.IDTESTA     = cippa.DdtProg and w.idriga = cippa.DdtRow)  as DdtQuantita,\n\ndbo.piTecnico((select w.ND_UTECREAZ       from colfert..extratestedoc  w where w.IDTESTA     = cippa.DestProg                             )) as DestCreatore,\n(select w.TIPODOC                         from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.DestProg                             )  as DestTipo,\n(select w.NUMERODOC                       from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.DestProg                             )  as DestNumero,\n(select cast(w.DATADOC as date)           from colfert..TESTEDOCUMENTI w where w.progressivo = cippa.DestProg                             )  as DestData,\n(select cast(w.TOTNETTORIGAEURO as float) from colfert..RIGHEDOCUMENTI w where w.IDTESTA     = cippa.DestProg and w.idriga = cippa.DestRow)  as DestTotale,\n(select cast(w.QTAGEST as float)          from colfert..RIGHEDOCUMENTI w where w.IDTESTA     = cippa.DestProg and w.idriga = cippa.DestRow)  as DestQuantita\n\nfrom cippa\norder by 1,2",
    "amm0009": "select distinct a.CdC as 'Settore',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.AnnoTrasporto = Year(GetDate()) - 0),0)) as float) as 'Anno Corrente',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.AnnoTrasporto = Year(GetDate()) - 1),0)) as float) as 'Anno - 1',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.AnnoTrasporto = Year(GetDate()) - 2),0)) as float) as 'Anno - 2',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.AnnoTrasporto = Year(GetDate()) - 3),0)) as float) as 'Anno - 3',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.CdC = a.CdC and b.AnnoTrasporto = Year(GetDate()) - 4),0)) as float) as 'Anno - 4'\nfrom temp..StatCons a\nunion\nselect 'Z TOTALI' as 'Settore',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.AnnoTrasporto = Year(GetDate()) - 0),0)) as float) as 'Anno Corrente',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.AnnoTrasporto = Year(GetDate()) - 1),0)) as float) as 'Anno - 1',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.AnnoTrasporto = Year(GetDate()) - 2),0)) as float) as 'Anno - 2',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.AnnoTrasporto = Year(GetDate()) - 3),0)) as float) as 'Anno - 3',\ncast((isnull((select sum (NettoRiga) from temp..StatCons b where b.AnnoTrasporto = Year(GetDate()) - 4),0)) as float) as 'Anno - 4'\nfrom temp..StatCons a\norder by 1",
    "amm0010": "with list as (\nselect distinct t.codclifor\nfrom TESTEDOCUMENTI t\n     inner join ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\n\t left outer join TABELLAPERSONALE r on ( t.CODCLIFOR = r.RIFCODCONTO and CODRUOLO = 18)\nwhere Esercizio = year(GetDate())\nand tipodoc in (select codice from PARAMETRIDOC where CLIFOR = 'c' and TIPO in ('f','b','n') )\nand (len(isnull(a.CODDESTINATARIOPA,'')) < 6 or len(isnull(a.CODDESTINATARIOPA,'')) > 8 )\n)\nselect l.CODCLIFOR as Codice, a.DSCCONTO1 as RagioneSociale, a.TELEFONO as Telefono, isnull(p.EMAIL,'') as MailAmministrazione, isnull(a.TELEX,'') as MailGenerica\nfrom list l inner join ANAGRAFICACF a on l.CODCLIFOR = a.CODCONTO\nleft outer join TABELLAPERSONALE p on l.CODCLIFOR = p.RIFCODCONTO and p.CODRUOLO = 11\nwhere a.CODICEISO = 'IT'\norder by 1",
    "amm0011": "with list as (\nselect distinct t.codclifor\nfrom TESTEDOCUMENTI t\n     inner join ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\nwhere Esercizio = year(GetDate())\nand tipodoc in (select codice from PARAMETRIDOC where CLIFOR = 'c' and TIPO in ('f','b','n') )\nand a.FLGPERSFISICA is null\n)\nselect l.CODCLIFOR as Codice, a.DSCCONTO1 as RagioneSociale, a.TELEFONO as Telefono, isnull(p.EMAIL,'') as MailAmministrazione, isnull(a.TELEX,'') as MailGenerica\nfrom list l inner join ANAGRAFICACF a on l.CODCLIFOR = a.CODCONTO\nleft outer join TABELLAPERSONALE p on l.CODCLIFOR = p.RIFCODCONTO and p.CODRUOLO = 11\nwhere a.CODICEISO = 'IT'\norder by 1",
    "amm0012": "select t.ESERCIZIO as Esercizio, t.TIPODOC as TipoDoc, t.NUMERODOC as NumeroDoc, cast(t.DATADOC as date) as DataDoc, t.CODCLIFOR as CodCliente, a.DSCCONTO1 as RagioneSociale, t.FLGBOLLOVIRTUALE as FlagBolloDoc, r.CODIVA As CodiceIVA\nfrom TESTEDOCUMENTI t inner join ANAGRAFICARISERVATICF r on t.CODCLIFOR = r.CODCONTO and r.ESERCIZIO = year(getDate()) inner join ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\nwhere datadoc >= '<fromdate>' and datadoc <= '<todate>'\nand tipodoc in ('fca','fcv','fcc','fcd','fcx','nca')\nand ( (t.FLGBOLLOVIRTUALE = 1 and r.CODIVA != 218) or (t.FLGBOLLOVIRTUALE = 0 and r.CODIVA = 218) )",
    "amm0013": "SELECT\n'1. MESE FATTURAZIONE ERRATO' AS TIPO\n,TBOL.CODCLIFOR\n,TBOL.DATAINIZIOTRASP\n,TBOL.DATADOC\n,RBOL.IDTESTA\n,RBOL.IDRIGA\n,RBOL.TIPODOC\n,RBOL.NUMERODOC\n,RBOL.CODART\n,RBOL.GENCONTROP\n,AG.DSCCONTO1 AS GENCONTROP_DSC\n,TOTNETTORIGAEURO*SEGNO*INCIDENZASCONTI AS BOLLETTATO\n,FAT.TIPODOC\n,FAT.NUMERODOC\n,FAT.DATADOC\n,ISNULL(FATTURATO,0) AS FATTURATO\n,BLOCCATO\n, 0 AS CONT\n--,SUM(CONTABILIZZATO) AS CONTABILIZZATO\n\n\n FROM\n RIGHEDOCUMENTI RBOL\n JOIN TESTEDOCUMENTI TBOL ON TBOL.PROGRESSIVO=RBOL.IDTESTA\nLEFT OUTER JOIN ANAGRAFICAGENERICI AG ON AG.CODCONTO=RBOL.GENCONTROP\n\nLEFT OUTER JOIN\n (SELECT TFAT.DATADOC,RFAT.IDTESTA,RFAT.IDRIGA,RFAT.IDTESTARP,RFAT.IDRIGARP,RFAT.ESERCIZIO,RFAT.TIPODOC,RFAT.NUMERODOC,RFAT.GENCONTROP,RFAT.TOTNETTORIGAEURO*SEGNO*INCIDENZASCONTI AS FATTURATO\nFROM RIGHEDOCUMENTI RFAT\nJOIN TESTEDOCUMENTI TFAT ON TFAT.PROGRESSIVO=RFAT.IDTESTA\n WHERE  RFAT.TIPODOC IN ('FCV','NCA')  --AND TFAT.DATADOC BETWEEN '<fromdate>' AND '<todate>'\n AND TOTNETTORIGAEURO<>0\n--GROUP BY  RFAT.IDTESTA,RFAT.IDRIGA,RFAT.IDTESTARP,RFAT.IDRIGARP,RFAT.ESERCIZIO,RFAT.TIPODOC,RFAT.NUMERODOC,RFAT.GENCONTROP\n) FAT ON FAT.IDTESTARP=RBOL.IDTESTA AND FAT.IDRIGARP=RBOL.IDRIGA\n\n--     LEFT OUTER JOIN (SELECT IDTESTADOC,CONTO,SUM(CASE WHEN SEGNO=0 THEN -IMPORTOEURO ELSE IMPORTOEURO END) AS CONTABILIZZATO FROM RIGHECONTABILITA RC JOIN TESTECONTABILITA TC ON PROGRESSIVO=NRREG GROUP BY IDTESTADOC,CONTO)\n--CONT ON CONT.IDTESTADOC=FAT.IDTESTA AND CONT.IDTESTADOC=FAT.GENCONTROP\n\n\nWHERE TBOL.TIPODOC IN ('DCV','DCB','RCB','DCV','DCD','RCD','RCA')\nAND  TBOL.DATAINIZIOTRASP BETWEEN dateadd(yy,-1,'<fromdate>') AND '<todate>'\nAND RBOL.TOTNETTORIGAEURO<>0\n--AND RBOL.NUMERODOC=17679 AND RBOL.ESERCIZIO=2019\n\nAND ISNULL(FATTURATO,0)=TOTNETTORIGAEURO*SEGNO*INCIDENZASCONTI\nAND MONTH(TBOL.DATAINIZIOTRASP)<>MONTH(FAT.DATADOC)\n\n\n--ORDER BY  RBOL.TIPODOC,RBOL.NUMERODOC,RBOL.POSIZIONE\n\n\nUNION ALL\n-- -- -- -- -- -- -- -- -- -- -- -- -- -- --\n--2) CONTROLLO MESE DI FATTURAZIONE ERRATO\n-- -- -- -- -- -- -- -- -- -- -- -- -- -- --\nSELECT\n'2. BOLLE NON FATTURATE E/O CON IMPORTO DIVERSO' AS TIPO\n,TBOL.CODCLIFOR\n,TBOL.DATAINIZIOTRASP\n,TBOL.DATADOC\n,RBOL.IDTESTA\n,RBOL.IDRIGA\n,RBOL.TIPODOC\n,RBOL.NUMERODOC\n,RBOL.CODART\n,RBOL.GENCONTROP\n,AG.DSCCONTO1 AS GENCONTROP_DSC\n,TOTNETTORIGAEURO*SEGNO*INCIDENZASCONTI AS BOLLETTATO\n,FAT.TIPODOC\n,FAT.NUMERODOC\n,FAT.DATADOC\n,ISNULL(FATTURATO,0) AS FATTURATO\n,BLOCCATO\n, 0 AS CONT\n--,SUM(CONTABILIZZATO) AS CONTABILIZZATO\n\n FROM\n RIGHEDOCUMENTI RBOL\n JOIN TESTEDOCUMENTI TBOL ON TBOL.PROGRESSIVO=RBOL.IDTESTA\nLEFT OUTER JOIN ANAGRAFICAGENERICI AG ON AG.CODCONTO=RBOL.GENCONTROP\n\nLEFT OUTER JOIN\n (SELECT TFAT.DATADOC,RFAT.IDTESTA,RFAT.IDRIGA,RFAT.IDTESTARP,RFAT.IDRIGARP,RFAT.ESERCIZIO,RFAT.TIPODOC,RFAT.NUMERODOC,RFAT.GENCONTROP,RFAT.TOTNETTORIGAEURO*SEGNO*INCIDENZASCONTI AS FATTURATO\nFROM RIGHEDOCUMENTI RFAT\nJOIN TESTEDOCUMENTI TFAT ON TFAT.PROGRESSIVO=RFAT.IDTESTA\n WHERE  RFAT.TIPODOC IN ('FCV','NCA','FCX','FCC','NCX','NCC')  --AND TFAT.DATADOC BETWEEN '<fromdate>' AND '<todate>'\n AND TOTNETTORIGAEURO<>0\n--GROUP BY  RFAT.IDTESTA,RFAT.IDRIGA,RFAT.IDTESTARP,RFAT.IDRIGARP,RFAT.ESERCIZIO,RFAT.TIPODOC,RFAT.NUMERODOC,RFAT.GENCONTROP\n) FAT ON FAT.IDTESTARP=RBOL.IDTESTA AND FAT.IDRIGARP=RBOL.IDRIGA\n\n--     LEFT OUTER JOIN (SELECT IDTESTADOC,CONTO,SUM(CASE WHEN SEGNO=0 THEN -IMPORTOEURO ELSE IMPORTOEURO END) AS CONTABILIZZATO FROM RIGHECONTABILITA RC JOIN TESTECONTABILITA TC ON PROGRESSIVO=NRREG GROUP BY IDTESTADOC,CONTO)\n--CONT ON CONT.IDTESTADOC=FAT.IDTESTA AND CONT.IDTESTADOC=FAT.GENCONTROP\n\n\nWHERE TBOL.TIPODOC IN ('DCV','DCB','RCB','DCV','DCD','RCD','RCA')\nAND  TBOL.DATAINIZIOTRASP BETWEEN dateadd(yy,-1,'<fromdate>') AND '<todate>'\nAND RBOL.TOTNETTORIGAEURO<>0\n\n AND ISNULL(FATTURATO,0)<>TOTNETTORIGAEURO*SEGNO*INCIDENZASCONTI\nAND CODCLIFOR<>'C  3118'\n\n\n--ORDER BY  RBOL.TIPODOC,RBOL.NUMERODOC,RBOL.POSIZIONE\nunion all\nSELECT\n'3. FATTURE DIVERSE DA CONTABILITA' AS TIPO\n,'' AS CODCLIFOR\n,'' AS DATAINIZIOTRASP\n,NULL AS DATADOC\n,0 AS IDTESTA\n,0 AS IDRIGA\n,'' TIPODOC\n,0 AS NUMERODOC\n,'' AS CODART\n,'' AS GENCONTROP\n,AG.DSCCONTO1 AS GENCONTROP_DSC\n,0 AS BOLLETTATO\n,FAT.TIPODOC\n,FAT.NUMERODOC\n,FAT.DATADOC\n,ISNULL(FATTURATO,0) AS FATTURATO\n,FAT.BLOCCATO\n,ISNULL(CONTABILIZZATO,0) AS CONTABILIZZATO\n\n FROM\n\n (SELECT TFAT.BLOCCATO,TFAT.DATADOC,RFAT.IDTESTA,RFAT.GENCONTROP,RFAT.ESERCIZIO,RFAT.TIPODOC,RFAT.NUMERODOC,SUM(RFAT.TOTNETTORIGAEURO*SEGNO*INCIDENZASCONTI) AS FATTURATO\nFROM RIGHEDOCUMENTI RFAT\nJOIN TESTEDOCUMENTI TFAT ON TFAT.PROGRESSIVO=RFAT.IDTESTA\n WHERE  RFAT.TIPODOC IN ('FCA','FCE','FCD')  AND TFAT.DATADOC BETWEEN dateadd(yy,-1,'<fromdate>') AND '<todate>'\n AND TOTNETTORIGAEURO<>0\nGROUP BY   TFAT.BLOCCATO,TFAT.DATADOC,RFAT.IDTESTA,RFAT.GENCONTROP,RFAT.ESERCIZIO,RFAT.TIPODOC,RFAT.NUMERODOC,RFAT.GENCONTROP\n) FAT\n  LEFT OUTER JOIN ANAGRAFICAGENERICI AG ON AG.CODCONTO=FAT.GENCONTROP\nLEFT OUTER JOIN (SELECT IDTESTADOC,CONTO,SUM(CASE WHEN SEGNO=0 THEN -IMPORTOEURO ELSE IMPORTOEURO END) AS CONTABILIZZATO\nFROM RIGHECONTABILITA RC JOIN TESTECONTABILITA TC ON PROGRESSIVO=NRREG AND TC.DATAREG BETWEEN dateadd(yy,-1,'<fromdate>') AND '<todate>'\nGROUP BY IDTESTADOC,CONTO)\nCONT ON CONT.IDTESTADOC=FAT.IDTESTA AND CONT.CONTO=FAT.GENCONTROP\n\n\nWHERE\nISNULL(FATTURATO,0)<>ISNULL(CONTABILIZZATO,0)\n--AND CODCLIFOR<>'C  3118'",
    "amm0014": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct a.CODCONTO as Codice, a.DSCCONTO1 as Descrizione, a.PARTITAIVA as PartitaIVA, a.CODFISCALE as CodiceFiscale, n.DESCRIZIONE as Sede\nfrom testedocumenti t inner join anagraficacf a on t.CODCLIFOR = a.CODCONTO inner join TABNAZIONI n on a.CODNAZIONE = n.CODICE\nwhere t.tipodoc in (select CODICE from PARAMETRIDOC where clifor = 'C' and tipo in ('B','F')) and isnull(a.CODFISCALE,'') = '' and t.DOCCHIUSO != 1 and t.datadoc >= @dadata and t.datadoc <= @adata",
    "amm0015": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nSELECT distinct a.CodiceFornitore, a.NomeFornitore,-- isnull(cast(sum(a.NettoRiga) as float),0) as TotalePeriodo\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata                               ) as Totale,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CdC = 'Alluminio Ferro' ) as AlluminioFerro,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CdC = 'Legno PVC'       ) as LegnoPVC,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CdC = 'Prodotto Finito' ) as ProdottoFinito,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CdC = 'Punto Vendita'   ) as PuntoVendita,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CdC = 'Termag'          ) as Termag,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CdC = 'Utensileria'     ) as Utensileria,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CdC = 'Waterproof'      ) as Waterproof,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from temp..AnaTemp b where a.CodiceFornitore = b.CodiceFornitore and b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CdC = 'Web'             ) as Web\nFROM temp..anatemp a\nwhere a.CodiceFornitore in ('F     4','F   211','F    21','F    55','F   101','F   409','F   492','F    58','F   548','F    94','F   360','F   231','F   774','F   165','F   868','F     3','F   463','F   470','F   450','F   496','F   834','F   242','F   926','F    86','F   383','F   236','F   286','F   103','F   120','F   140','F    51','F   147','F   158','F  8224','F   580','F   950','F   474','F   424','F   282','F   756','F  8673','F  8858','F   774','F   262')\nand a.InizioTrasporto >= @dadata and a.InizioTrasporto <= @adata\norder by 1",
    "amm0016": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct AnnoTrasporto, MeseTrasporto,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from TEMP..StatCons b where b.AnnoTrasporto = a.AnnoTrasporto and b.MeseTrasporto = a.MeseTrasporto and b.CdC = 'waterproof') as Menegazzo_Waterproof,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from TEMP..StatCons b where b.AnnoTrasporto = a.AnnoTrasporto and b.MeseTrasporto = a.MeseTrasporto and b.CdC != 'waterproof' and CodiceFornitore in ('F  8345','F   377','F   658')) as Menegazzo_McSlideNoWP,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from TEMP..StatCons b where b.AnnoTrasporto = a.AnnoTrasporto and b.MeseTrasporto = a.MeseTrasporto and b.CodiceFornitore = 'F   580' and b.CodiceCliente not in ('C  2579','C 12461','C  2594','C 28975','C 20511','C  1164','C   211','C  2738','C 20714','C 28776','C 25573','C  1627','C 21570','C  5221','C  4687','C 17527','C 16469','C  4787','C 20263','C  1237','C 20893','C 19137','C  1869','C 28126')) as Violo_Siegenia,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from TEMP..StatCons b where b.AnnoTrasporto = a.AnnoTrasporto and b.MeseTrasporto = a.MeseTrasporto and b.CodiceFornitore = 'F   695' and b.CodiceCliente not in ('C  2579','C 12461','C  2594','C 28975','C 20511','C  1164','C   211','C  2738','C 20714','C 28776','C 25573','C  1627','C 21570','C  5221','C  4687','C 17527','C 16469','C  4787','C 20263','C  1237','C 20893','C 19137','C  1869','C 28126')) as Violo_KFV,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from TEMP..StatCons b where b.AnnoTrasporto = a.AnnoTrasporto and b.MeseTrasporto = a.MeseTrasporto and b.articolo in (select codart from Stats..accessiautomatici) ) as Taita_AccessiAutomatici,\n(select isnull(cast(sum(b.NettoRiga) as float),0) from TEMP..StatCons b where b.AnnoTrasporto = a.AnnoTrasporto and b.MeseTrasporto = a.MeseTrasporto and b.articolo in (select codart from Stats..porteautomatiche) ) as Taita_PorteAutomatiche\nfrom TEMP..StatCons a\nwhere a.InizioTrasporto >= @dadata and a.InizioTrasporto <= @adata\norder by 1 desc,2",
    "amm0017": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect t.CODAGENTE1 As CodAgente, s.DSCAGENTE as Agente, t.CODCLIFOR as CodCliente, a.DSCCONTO1 as RagioneSociale, g.ABBONAMENTO as Abbonamento, t.TIPODOC as TipoDoc, t.NUMERODOC as NumeroDoc, Cast(t.TOTSPESETRASPEURO as float) as SpeseTrasporto\nfrom TESTEDOCUMENTI t\n     inner join ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\n     inner join NDTabGiorniConsegna g on t.CODCLIFOR = g.CODCLI\n\t inner join ANAGRAFICAAGENTI s on t.CODAGENTE1 = s.CODAGENTE\nwhere DATADOC >= @dadata and DATADOC <= @adata\n      and TIPODOC in ('FCV')\norder by 1,3",
    "amm0018": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect t.TIPODOC as TipoDoc, t.NUMERODOC as NumeroDoc, cast(t.DATAINIZIOTRASP as date) as DataTrasporto, t.CODCLIFOR as CodCliente, a.DSCCONTO1 as RagioneSociale, cast(t.TOTIMPONIBILEEURO as float) as ImponibileDocumento, t.PROVINCIADDM as ProvinciaDestinazione, c.DESCRIZIONE as TrasportoACura\nfrom colfert..TESTEDOCUMENTI t inner join colfert..TABTRASPACURA c on t.TRASPACURA = c.CODICE inner join colfert..ANAGRAFICACF a on t.CODCLIFOR = a.CODCONTO\nwhere DATAINIZIOTRASP >= @dadata and DATAINIZIOTRASP <= @adata and TIPODOC = 'DCB' and c.DESCRIZIONE = 'vettore'",
    "amm0019": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect cdc,\n       isnull([1],0) as GG01, isnull([2],0) as GG02, isnull([3],0) as GG03, isnull([4],0) as GG04, isnull([5],0) as GG05, isnull([6],0) as GG06, isnull([7],0) as GG07, isnull([8],0) as GG08, isnull([9],0) as GG09, isnull([10],0) as GG10,\n       isnull([11],0) as GG11, isnull([12],0) as GG12, isnull([13],0) as GG13, isnull([14],0) as GG14, isnull([15],0) as GG15, isnull([16],0) as GG16, isnull([17],0) as GG17, isnull([18],0) as GG18, isnull([19],0) as GG09, isnull([20],0) as GG20,\n       isnull([21],0) as GG21, isnull([22],0) as GG22, isnull([23],0) as GG23, isnull([24],0) as GG24, isnull([25],0) as GG25, isnull([26],0) as GG26, isnull([27],0) as GG27, isnull([28],0) as GG28, isnull([29],0) as GG09, isnull([30],0) as GG30,\n       isnull([31],0) as GG31\nfrom (\nselect cdc, day(InizioTrasporto) as Giorno, isnull(cast(sum(NettoRiga)as float),0) as Importo\nfrom temp..StatCons s\nwhere s.InizioTrasporto >= dateadd(DAY,-31,GetDate())\n\tand s.DocTipo in ('dcb', 'dcv', 'dcd', 'fca', 'fce','rca','rcb','rcd','dcm')\n    and s.InizioTrasporto >= @dadata\n    and s.InizioTrasporto <= @adata\n    and coge >= 'G570030' and coge <= 'G601035'\ngroup by cdc, InizioTrasporto\nunion\nselect 'x ' + cdc + ' - Altri coge', day(InizioTrasporto) as Giorno, isnull(cast(sum(NettoRiga)as float),0) as Importo\nfrom temp..StatCons s\nwhere s.InizioTrasporto >= dateadd(DAY,-31,GetDate())\n\tand s.DocTipo in ('dcb', 'dcv', 'dcd', 'fca', 'fce','rca','rcb','rcd','dcm')\n    and s.InizioTrasporto >= @dadata\n    and s.InizioTrasporto <= @adata\n    and (coge < 'G570030' or coge > 'G601035')\ngroup by cdc, InizioTrasporto\n) as ground\nPIVOT\n(\n\tsum(Importo)\n\tfor Giorno in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],[30],[31])\n) as outerbox\norder by 1",
    "amm0020": "select t.CODCLIFOR as Codice, t.RagioneSociale, t.Esercizio, t.TipoDoc, t.NumeroDoc, cast(t.DATAINIZIOTRASP as date) as Data, t.NUMRIFDOC as NumeroDoc, t.CODAGENTE1 as Agente, cast(t.TOTIMPONIBILEEURO as float) as Imponibile, t.CODICECIG as CIG, t.CODICECUP as CUP\nfrom col_Teste t\nwhere t.DOCCHIUSO = 0 and t.CODICECIG != '' and t.tipodoc in ('dcb', 'scb', 'srb', 'rcb','dcv','dcd','rca','fce','fcd','dcm')\norder by progressivo",
    "amm0021": "select CODCONTO, RagioneSociale,\n       case STATOORDINI  when 0 then 'Normale' when 1 then 'Segnala' when 2 then 'Blocca' end as StatoOrdini,\n       case STATOBOLLE   when 0 then 'Normale' when 1 then 'Segnala' when 2 then 'Blocca' end as StatoBolle,\n       case STATOFATTURE when 0 then 'Normale' when 1 then 'Segnala' when 2 then 'Blocca' end as StatoFatture\nfrom ANARISERVATICF\nwhere CODCONTO in ('C  1559','C  1565','C 14000','C 21677','C  1329','C  3287','C 18157','C 25300','C   521','C 32647','C 30125','C 25724','C  1489','C 22407','C 28684','C 28784','C 22086','C 20106','C 32277','C  3496','C  6565','C 27841','C  1957','C 32330','C 32768','C  1422','C 23194','C  1710','C  2735','C  3330','C502483','C 32811','C 20769','C 26400','C 17264','C 31138','C 27682','C 26974','C  4331','C 21540','C  1174','C 23006','C 16700','C 26415','C 21437','C 32062','C 20191','C 26036','C 25687','C  2650','C  3138','C  3978','C 20675','C 23517','C  1855','C 11497','C   610','C 32539')",
    "amm0022": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect esercizio, tipodoc, numerodoc, cast(datadoc as date) as DataDoc, codclifor\nfrom testedocumenti\nwhere progressivo in (select idtesta from righedocumenti where codiva = 218)\nand PROGDICHINTENTO = 0\nand tipodoc in (select doc from stats..docs where tipo = 'fattura')\nand datadoc between @dadata and @adata\norder by progressivo desc",
    "amm0023": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect EVIDENZA, NRREG, TIPODOC, NUMEROPROT, NUMERODOC, ANNO_DATA, MESE_DATA, CPARTITA, DSCCONTO1,\n  cast(ltrim(rtrim(replace(TOTCONT           ,',','.'))) as float) as TOTCONT,\n  cast(ltrim(rtrim(replace(TOTDOC            ,',','.'))) as float) as TOTDOC,\n  cast(ltrim(rtrim(replace(TOTALE_DOCUMENTI  ,',','.'))) as float) as TOTALE_DOCUMENTI,\n  cast(ltrim(rtrim(replace(TOTALE_CONTABILITA,',','.'))) as float) as TOTALE_CONTABILITA,\n  cast(ltrim(rtrim(replace(DELTA             ,',','.'))) as float) as DELTA,\n  cast(DATAREG as date) as DATAREG, cast(DATARIF as date) as DATARIF, DADATADOC, ADATADOC, ANUMRIF\nfrom ND_QDocCont_DocumentiDiCarico\nwhere datareg >= @dadata and datareg <= @adata",
    "amm0024": "select c.Codice, c.RagioneSociale, c.Sede, c.CodSettore, c.Settore, c.CodCategoria, c.Categoria, c.CodiceAgente, c.NomeAgente, c.CodiceCapoarea, c.NomeCapoarea, c.Indirizzo, c.Cap, c.Localita, c.Provincia, c.Regione, c.Nazione, c.Telefono, c.Fax, c.Email, c.PartitaIva, a.CODFISCALE as CodiceFiscale, c.BudgetColfert, c.BudgetYco, c.Abbonato, c.HaExtranet, c.HaColfertWindows, c.HaShop, c.ReferenteLegno, c.ReferenteAlluminio, c.ReferenteProdotto, c.CodVettoreCliente, c.VettoreCliente, c.PadroncinoCliente, c.Fido\nfrom stats..clis c inner join colfert..Anagraficacf a on c.codice = a.CODCONTO\nwhere codice like 'f%'",
    "amm0025": "select c.Codice, c.RagioneSociale, c.Sede, c.CodSettore, c.Settore, c.CodCategoria, c.Categoria, c.CodiceAgente, c.NomeAgente, c.CodiceCapoarea, c.NomeCapoarea, c.Indirizzo, c.Cap, c.Localita, c.Provincia, c.Regione, c.Nazione, c.Telefono, c.Fax, c.Email, c.PartitaIva, a.CODFISCALE as CodiceFiscale, c.BudgetColfert, c.BudgetYco, c.Abbonato, c.HaExtranet, c.HaColfertWindows, c.HaShop, c.ReferenteLegno, c.ReferenteAlluminio, c.ReferenteProdotto, c.CodVettoreCliente, c.VettoreCliente, c.PadroncinoCliente, c.Fido, c.CExtra0, c.CExtra1, c.CExtra2, c.CExtra3, c.CExtra4, c.CExtra5, c.CExtra6, c.CExtra7, c.CExtra8, c.CExtra9, r.*\nfrom stats..clis c inner join colfert..Anagraficacf a on c.codice = a.CODCONTO\n  left outer join colfert..ND_CRIBIS r on c.codice = r.Codconto\nwhere codice like 'c%'",
    "amm0026": "select * from BANCAAPPCF where CODICEIBAN like '%<iban>%'",
    "amm0027": "select * from temp..VerificaPunti v where v.codcliente = '<cardcode>'",
    "amm0028": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect codcliente, ragionesociale, round(SUM(TotRigaOrdine),0) as OrdinatoFase2Tot,\n (select round(isnull(SUM(TotRigaOrdine),0),2) from temp..VerificaPunti p where p.codcliente = v.CodCliente and p.datapageff is null) as OrdinatoNonPagato,\n (select round(isnull(SUM(TotRigaOrdine),0),2) from temp..VerificaPunti p where p.codcliente = v.CodCliente and p.datapageff is not null) as OrdinatoPagato,\n (select round(isnull(SUM(TotRigaOrdine),0),2) from temp..VerificaPunti p where p.codcliente = v.CodCliente and p.datapageff is not null and p.datapageff between @dadata and @adata) as PagatoPeriodo\nfrom temp..VerificaPunti v\ngroup by codcliente, ragionesociale\norder by 1",
    "amm0029": "select TipoDoc, NumeroDoc, CodiceCliente, DataDoc, Pagamento, IdRiga, TipoRiga, Articolo, Descrizione, DescExtra, UM, Quantita, QtaResidua, RigaChiusa, PrezzoUnitLordo, ScontoEsteso, PrezzoUnitNetto, TotRiga\nfrom stats..fatturato\nwhere anno = <anno>\nand tipodoc = 'fcv' and codicecliente = '<cardcode>'\norder by progressivo, idriga",
    "amm0030": "declare @anno int = <anno>;\ndeclare @mese int = <mese>;\nselect 'A' as Layer, d.TipoDoc, d.NumeroDoc, d.Anno, d.DataDoc, d.NomeUtente, d.TipoDocOrd, d.NumeroOrd, d.IdRiga, d.TipoRiga, d.Articolo, d.CategoriaArticolo, d.Descrizione, d.DescExtra, d.UM, d.Quantita,\n  d.PrezzoUnitLordo, d.Sconto, d.ScontoEsteso, d.PrezzoUnitNetto, d.TotRiga, d.Codice, d.RagioneSociale, d.Sede, d.NomeFornitore, d.GruppoProvv, d.CodiceAgente, d.NomeAgente,\n  s.CODAGENTE as CodiceSpecialista, s.DSCAGENTE as Nomespecialista,\n  --0.25 as PercProvvigione, d.TotRiga * 0.0025 as Provvigione\n  case when d.Sconto <= 55 then 1\n       when d.Sconto <= 60 then 0.8\n\t   when d.Sconto <= 62 then 0.6\n\t   when d.Sconto <= 64 then 0.4\n\t   else 0 end as PercProvvigione,\n  case when d.Sconto <= 55 then round(0.01  * d.TotRiga, 2)\n       when d.Sconto <= 60 then round(0.008 * d.TotRiga, 2)\n\t   when d.Sconto <= 62 then round(0.006 * d.TotRiga, 2)\n\t   when d.Sconto <= 64 then round(0.004 * d.TotRiga, 2)\n\t   else 0 end as Provvigione\nfrom Stats..consegnato d\n  left outer join colfert..ND_TabSpecialistiClienti x on d.codicecliente = x.codconto and x.tipospecialista = 'YC'\n  left outer join COLFERT..ANAGRAFICAAGENTI s on x.codspecialista = s.CODAGENTE\nwhere d.Anno = @anno and d.Mese = @mese\n\t  and TipoRiga != 'Omaggio'\n      and d.CodGruppoProvv = 616 and CodCategoriaArticolo != 5140\nunion\nselect 'B' as Layer, d.TipoDoc, d.NumeroDoc, d.Anno, d.DataDoc, d.NomeUtente, d.TipoDocOrd, d.NumeroOrd, d.IdRiga, d.TipoRiga, d.Articolo, d.CategoriaArticolo, d.Descrizione, d.DescExtra, d.UM, d.Quantita,\n  d.PrezzoUnitLordo, d.Sconto, d.ScontoEsteso, d.PrezzoUnitNetto, d.TotRiga, d.Codice, d.RagioneSociale, d.Sede, d.NomeFornitore, d.GruppoProvv, d.CodiceAgente, d.NomeAgente,\n  s.CODAGENTE as CodiceSpecialista, s.DSCAGENTE as Nomespecialista,\n  0 as PercProvvigione,\n  0 as Provvigione\nfrom Stats..consegnato d\n  left outer join colfert..ND_TabSpecialistiClienti x on d.codicecliente = x.codconto and x.tipospecialista = 'YC'\n  left outer join COLFERT..ANAGRAFICAAGENTI s on x.codspecialista = s.CODAGENTE\nwhere d.Anno = @anno and d.Mese = @mese\n\t  and TipoRiga != 'Omaggio'\n      and d.CodGruppoProvv = 5110 and CodCategoriaArticolo = 5050",
    "amm0031": "select\n       f.CODCONTO As CodiceCliente, f.DSCCONTO1 as RagioneSociale, cast(f.FIDOACCORDATO as float) as FidoColfert, cast(f.SCADENZEAPERTE as float) as ScadenzeAperte,\n\t   cast(f.BOLLE as float) as Bolle, cast(f.ORDINI as float) as Ordini, cast(f.ALTRO as float) as Altro, cast(f.FIDODISPONIBILE as float) as FidoDisponibile, cast(f.FIDOASSICURATO as float) as FidoAssicurato,\n\t   f.GRADEATTUALE as GradeAttuale, f.GRADEDATE as DataGrade, cast(f.PRCFIDOORDINI as float) as PercFidoOrdini, cast(f.PRCFIDOBOLLE as float) as PercFidoBolle, cast(f.PRCFIDOALTRO as float) as PercFidoAltro,\n\t   cast(f.PRCFIDOSCAD as float) as PercFidoScaduto, cast(f.PRCFIDODISP as float) as PercFidoDisponibile, cast(x.autocopertura as float) as Autocopertura,\n\t   cast(f.FIDOASSICURATO + x.autocopertura as float) as AssicurazioneEffettiva_FidoAssPiuAutocopertura,\n\t   cast(f.FIDOASSICURATO + x.autocopertura - f.FIDOACCORDATO as float) as AssicurazioneEffettiva_FidoAssPiuAutocoperturaMenoFidoColfert\nfrom ND_FIDO_VISTACLIENTIFIDO f\n     inner join colfert..EXTRACLIENTI x on f.codconto = x.codconto\norder by 1",
    "amm0032": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect 'A' as Layer, d.TipoDoc, d.NumeroDoc, d.Anno, d.DataDoc, d.NomeUtente, d.TipoDocOrd, d.NumeroOrd, d.IdRiga, d.TipoRiga, d.Articolo, d.CategoriaArticolo, d.Descrizione, d.DescExtra, d.UM, d.Quantita,\n  d.PrezzoUnitLordo, d.Sconto, d.ScontoEsteso, d.PrezzoUnitNetto, d.TotRiga, d.Codice, d.RagioneSociale, d.Sede, d.NomeFornitore, d.GruppoProvv, d.CodiceAgente, d.NomeAgente,\n  s.CODAGENTE as CodiceSpecialista, s.DSCAGENTE as Nomespecialista,\n  --0.25 as PercProvvigione, d.TotRiga * 0.0025 as Provvigione\n  case when d.Sconto <= 55 then 1\n       when d.Sconto <= 60 then 0.8\n\t   when d.Sconto <= 62 then 0.6\n\t   when d.Sconto <= 64 then 0.4\n\t   else 0 end as PercProvvigione,\n  case when d.Sconto <= 55 then round(0.01  * d.TotRiga, 2)\n       when d.Sconto <= 60 then round(0.008 * d.TotRiga, 2)\n\t   when d.Sconto <= 62 then round(0.006 * d.TotRiga, 2)\n\t   when d.Sconto <= 64 then round(0.004 * d.TotRiga, 2)\n\t   else 0 end as Provvigione\nfrom Stats..consegnato d\n  left outer join colfert..ND_TabSpecialistiClienti x on d.codicecliente = x.codconto and x.tipospecialista = 'YC'\n  left outer join COLFERT..ANAGRAFICAAGENTI s on x.codspecialista = s.CODAGENTE\nwhere d.datadoc between @dadata and @adata\n      and d.TipoDoc = 'DCM'\n--\t  and TipoRiga != 'Omaggio'\n--      and d.CodGruppoProvv = 616 and CodCategoriaArticolo != 5140",
    "amm0201": "select o.CdARt as CodiceFerport, o.Articolo as DescrizioneFerport, o.DescrAgg1, o.DescrAgg2, o.CdTecnico, o.CodiceArtForn, o.Barcode, o.CdFor, o.UM,\nLTRIM(\n        RTRIM(\n            COALESCE(NULLIF(o.ubic1,''), '' ) + CASE WHEN NULLIF(o.ubic1 ,'') IS NOT NULL AND NULLIF(o.ubic2,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic2,''), '' ) + CASE WHEN NULLIF(o.ubic2 ,'') IS NOT NULL AND NULLIF(o.ubic3,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic3,''), '' ) + CASE WHEN NULLIF(o.ubic3 ,'') IS NOT NULL AND NULLIF(o.ubic4,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic4,''), '' ) + CASE WHEN NULLIF(o.ubic4 ,'') IS NOT NULL AND NULLIF(o.ubic5,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic5,''), '' ) + CASE WHEN NULLIF(o.ubic5 ,'') IS NOT NULL AND NULLIF(o.ubic6,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic6,''), '' ) + CASE WHEN NULLIF(o.ubic6 ,'') IS NOT NULL AND NULLIF(o.ubic7,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic7,''), '' ) + CASE WHEN NULLIF(o.ubic7 ,'') IS NOT NULL AND NULLIF(o.ubic8,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic8,''), '' ) + CASE WHEN NULLIF(o.ubic8 ,'') IS NOT NULL AND NULLIF(o.ubic9,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic9,''), '' ) + CASE WHEN NULLIF(o.ubic9 ,'') IS NOT NULL AND NULLIF(o.ubic10,'') IS NOT NULL THEN ',' ELSE '' END +\n            COALESCE(NULLIF(o.ubic10,''), '')\n        )\n    ) AS ubicazioniFerport,\n\to.Qta as QtaFerport, isnull(m.articolo,'') as ArticoloRilevato, isnull(m.Ubicazioni,'') as UbicazioniRilevate, isnull(m.totale_quantita,0) as QuantitaRilevata\nfrom temp..InventarioFerport o\n     left outer join temp..invferport m on o.CdARt = m.articolo\norder by 1",
    "amm0202": "select * from temp..InventarioFerport",
    "amm0203": "select * from dash..kinventory where titolo = 'inventariobrescia' and status = ''",
    "ris0001": "select utente, classe_settore, cast(sum(totnettorigaeuro) as float) as TotaleImponibile, cast(sum(ImponibileProvv) as float) as ImponibileProvvigionabile, cast(sum(totprovvigioni) as float) as TotProvvigioni\nfrom Nd_Stat_VistaConteggioProvvigioniUtente\nwhere esercizio = <anno> and mese = <mese>\ngroup by utente, classe_settore\norder by 1",
    "kpi0000.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith a as(\nselect distinct c.userr,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.inttype = 'external') as TempoChiamateEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.inttype = 'external' and a.type = 'received') as ChiamateRicevuteEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.inttype = 'external' and a.type = 'received' and a.result like 'answered%') as DiCuiRisposte,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.inttype = 'external' and a.type = 'received' and a.result = 'busy'        ) as DiCuiOccupato,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.inttype = 'external' and a.type = 'received' and a.result = 'missed'      ) as DiCuiPerse,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.inttype = 'external' and a.type = 'received' and a.result = 'not answered') as DiCuiNonRisposte,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.inttype = 'external' and a.type = 'placed') as ChiamateFatteEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.inttype = 'user'  ) as ChiamateRicevuteFatteInterne,\n(select sum(a.duration)           from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr ) as TempoTotaleAlTelefono,\n(select sum(a.talktime)           from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr ) as TempoTotaleInParlato\nfrom ced..Centralino c\nwhere c.start >= @dadata and c.start <= @adata --and DATEPART(HOUR, start) = 8\n) select userr as Utente, ced.dbo.ConvertTimeToHHMMSS(TempoChiamateEsterne, 's') as TempoChiamateEsterne, ChiamateRicevuteEsterne, DiCuiRisposte, DiCuiOccupato, DiCuiPerse, DiCuiNonRisposte, ChiamateFatteEsterne, ChiamateRicevuteFatteInterne,\nced.dbo.ConvertTimeToHHMMSS(TempoTotaleAlTelefono,'s') as TempoTotaleAlTelefono, ced.dbo.ConvertTimeToHHMMSS(TempoTotaleInParlato,'s') as TempoTotaleInParlato,\nced.dbo.ConvertTimeToHHMMSS((case when (ChiamateRicevuteEsterne+ChiamateFatteEsterne+ChiamateRicevuteFatteInterne) = 0 then 0 else TempoTotaleAlTelefono / (ChiamateRicevuteEsterne+ChiamateFatteEsterne+ChiamateRicevuteFatteInterne) end),'s') as  DurataMediaChiamata\nfrom a\norder by 1",
    "kpi0000.02": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith tot as (\nselect u.Descrizione as Operatore, t.tipodoc, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe, cast(sum(r.TOTNETTORIGAEURO) as float) as Imponibile,\n(select COUNT(*) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as RigheChiuse,\n(select isnull(cast(sum(x.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as ImpRigheChiuse\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('ocv','ocw','ocd','oce','ocb','ocm') and datadoc >= @dadata and datadoc <= @adata --and tipo = 'M'\ngroup by u.Descrizione, t.tipodoc, w.ND_UTECREAZ\n) select Operatore, TIPODOC, sum(NumeroTeste) as NumeroTeste, sum(NumeroRighe) as NumeroRighe, sum(Imponibile) as Imponibile, sum(RigheChiuse) as RigheChiuse, Round(cast(sum(RigheChiuse*100) as float)/cast(sum(NumeroRighe) as float),2) as PercentualeDiRitorno\n, sum(ImpRigheChiuse) as ImpRigheChiuse\n, case when sum(Imponibile) != 0 then round(sum(ImpRigheChiuse) / sum(Imponibile) * 100,2) else 0 end as PercRitornoImporto\nfrom tot\nGroup by Operatore, TIPODOC\norder by 1,2",
    "kpi0000.03": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith tot as (\nselect u.Descrizione as Operatore, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe, cast(sum(r.TOTNETTORIGAEURO) as float) as Imponibile,\n(select COUNT(*) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as RigheChiuse,\n(select isnull(cast(sum(x.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as ImpRigheChiuse\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('pre','prw') and datadoc >= @dadata and datadoc <= @adata --and tipo = 'M'\ngroup by u.Descrizione, w.ND_UTECREAZ\n) select Operatore, sum(NumeroTeste) as NumeroTeste, sum(NumeroRighe) as NumeroRighe, sum(Imponibile) as Imponibile, sum(RigheChiuse) as RigheChiuse, Round(cast(sum(RigheChiuse*100) as float)/cast(sum(NumeroRighe) as float),2) as PercentualeDiRitorno\n, sum(ImpRigheChiuse) as ImpRigheChiuse\n, round(sum(ImpRigheChiuse) / sum(Imponibile) * 100,2) as PercRitornoImporto\nfrom tot\nGroup by Operatore\norder by 1,2",
    "kpi0000.04": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct c.userr,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'received') as NumeroChiamateRicevuteEsterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'received') as DurataChiamateRicevuteEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'placed'  ) as NumeroChiamateFatteEsterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'placed'  ) as DurataChiamateFatteEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'int' and a.type = 'received') as NumeroChiamateRicevuteInterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'int' and a.type = 'received') as DurataChiamateRicevuteInterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'int' and a.type = 'placed'  ) as NumeroChiamateFatteInterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'int' and a.type = 'placed'  ) as DurataChiamateFatteInterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed in ('ext','int') and a.type in ('received','placed') ) as NumeroTotaleChiamate,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed in ('ext','int') and a.type in ('received','placed') ) as DurataTotaleChiamate\nfrom ced..Centralino c\nwhere c.start >= @dadata and c.start <= @adata --and DATEPART(HOUR, start) = 8",
    "kpi0000.05": "select year(t.datadoc) as Anno, month(t.datadoc) as Mese, count(distinct t.progressivo) as NrOrdiniPeR, count(*) as NrRighe\nfrom TESTEDOCUMENTI t inner join EXTRATESTEDOC x on t.progressivo = x.idtesta inner join righedocumenti r on t.progressivo = r.IDTESTA\nwhere t.esercizio >= 2015 and t.tipodoc like 'o%' and t.codclifor like 'c%' and x.tipoordine = 12\ngroup by year(t.datadoc), month(t.datadoc)\norder by 1,2",
    "kpi0000.06": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct a.CodiceAgente + ' - ' + a.NomeAgente as Agente, a.CodiceCliente, a.NomeCliente as Cliente,\n(select isnull(cast(sum(b.NettoRiga) as float) ,0) from temp..StatCons b where b.InizioTrasporto >= @dadata and b.InizioTrasporto <= @adata and b.CodiceAgente = a.CodiceAgente and b.CodiceCliente = a.CodiceCliente) as TotaleConsPeriodo,\n(select count(distinct t.PROGRESSIVO) from colfert..TESTEDOCUMENTI t where t.DATADOC >= @dadata and t.datadoc <= @adata and t.CODCLIFOR = a.CodiceCliente and t.TIPODOC in ('fca','fcv','fcx','fcc','fcd','fc1','fce') )\nfrom temp..StatCons a\nwhere a.InizioTrasporto >= @dadata and a.InizioTrasporto <= @adata\norder by 1,2,3",
    "kpi0000.07": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith start as(\nselect t.PROGRESSIVO, r.IDRIGA, r.RIGACHIUSA,isnull(u.Descrizione,'') as Operatore, t.TIPODOC as TipoDoc, s.DESCRIZIONE as Settore, r.TOTNETTORIGAEURO as Imponibile\n--count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe, cast(sum(r.TOTNETTORIGAEURO) as float) as Imponibile\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nleft outer join ANAGRAFICARISERVATICF x on t.CODCLIFOR = x.CODCONTO and x.ESERCIZIO = year(Getdate())\nleft outer join COLFERT..TABSETTORI s on x.CODSETTORE = s.CODICE\nwhere t.tipodoc in ('ocv','ocw','ocd','oce','pre','prw') and datadoc >= @dadata and datadoc <= @adata --and tipo = 'M'\n--group by u.Descrizione, t.TIPODOC, s.DESCRIZIONE\n), more as(\nselect distinct a.Operatore, a.TipoDoc, a.Settore,\n(select count(distinct b.PROGRESSIVO) from start b where a.operatore = b.operatore and a.tipodoc = b.tipodoc and a.settore = b.settore) as ContoTeste,\n(select count(*) from start b where a.operatore = b.operatore and a.tipodoc = b.tipodoc and a.settore = b.settore) as ContoRighe,\n(select count(*) from start b where a.operatore = b.operatore and a.tipodoc = b.tipodoc and a.settore = b.settore and RIGACHIUSA = 1) as ContoRigheChiuse,\n--(select count(*) from start b where a.operatore = b.operatore and a.tipodoc = b.tipodoc and a.settore = b.settore) /\n--(select count(*) from start b where a.operatore = b.operatore and a.tipodoc = b.tipodoc and a.settore = b.settore and RIGACHIUSA = 1) as PercentualeRitorno,\n(select isnull(cast(sum(Imponibile) as float),0) from start b where a.operatore = b.operatore and a.tipodoc = b.tipodoc and a.settore = b.settore) as Imponibile,\n(select isnull(cast(sum(Imponibile) as float),0) from start b where a.operatore = b.operatore and a.tipodoc = b.tipodoc and a.settore = b.settore and RIGACHIUSA = 1) as ImpRigheChiuse\nfrom start a\n) select Operatore, TipoDoc, Settore, ContoTeste, ContoRighe, ContoRigheChiuse,\ncase when ContoRighe = 0 then 0 else round(cast(ContoRigheChiuse as float)/cast(ContoRighe as float) * 100,2) end as PercRitornoRighe,\nImponibile, ImpRigheChiuse,\ncase when imponibile = 0 then 0 else round(ImpRigheChiuse / Imponibile * 100,2) end as PercRitornoImporto\nfrom more\norder by 1,2,3",
    "kpi0000.08": "with start as (\nselect distinct year(datadoc) as Anno, month(datadoc) as Mese, u.Descrizione as Operatore, t.Tipodoc as tipodoc, Count(distinct t.progressivo) as Teste, Count(*) as Righe,\ncase when t.Tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce') then 'Picking' when t.Tipodoc in ('tra') then 'Acema' else 'Resi' end as Tipo, isnull(l.logistica,'') as Classe\nfrom TESTEDOCUMENTI t\n     left outer join EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\n     left outer join NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\n     inner join RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\n     left outer join STORICOMAG s on s.IDTESTA = t.PROGRESSIVO and r.IDRIGA = s.RIGADOC\n\t left outer join ced..Ubicazioni l on s.CODUBICAZIONE = l.ubicazione\nwhere t.tipodoc in ('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rcd','rca','fce','TRA','RCA','RCB','RCD','RCN','RCS','RCV','RFD','RFL') and year(datadoc) = <anno>  and (u.Tipo = 'M' or u.CodUtente = 'cil')\ngroup by u.Descrizione, year(datadoc), month(datadoc), t.Tipodoc, l.logistica\n)\nselect distinct a.Anno, a.Mese, a.Operatore, a.Classe,\n(select isnull(sum(Teste),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and b.Classe = a.Classe and tipo = 'Picking') as TestePicking,\n(select isnull(sum(Righe),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and b.Classe = a.Classe and tipo = 'Picking') as RighePicking,\n(select isnull(sum(Teste),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and b.Classe = a.Classe and tipo = 'Acema') as TesteAcema,\n(select isnull(sum(Righe),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and b.Classe = a.Classe and tipo = 'Acema') as RigheAcema,\n(select isnull(sum(Teste),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and b.Classe = a.Classe and tipo = 'Resi') as TesteResi,\n(select isnull(sum(Righe),0) from start b where a.anno = b.anno and a.mese = b.mese and a.operatore = b.operatore and b.Classe = a.Classe and tipo = 'Resi') as RigheResi\nfrom start a\norder by 1,2,3",
    "kpi0000.09": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct a.descrizione as Agente, i.descrizione as Utente, i.category as Ufficio,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'received') as NumeroChiamateRicevuteEsterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'received') as DurataChiamateRicevuteEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'placed'  ) as NumeroChiamateFatteEsterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'placed'  ) as DurataChiamateFatteEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed = 'int' and a.type = 'received') as NumeroChiamateRicevuteInterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed = 'int' and a.type = 'received') as DurataChiamateRicevuteInterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed = 'int' and a.type = 'placed'  ) as NumeroChiamateFatteInterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed = 'int' and a.type = 'placed'  ) as DurataChiamateFatteInterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed in ('ext','int') and a.type in ('received','placed') ) as NumeroTotaleChiamate,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.intname = c.intname and a.userr = c.userr and a.intspeed in ('ext','int') and a.type in ('received','placed') ) as DurataTotaleChiamate\nfrom ced..Centralino c\n     inner join ced..CentUsers a on (c.intname = a.intname and a.category = 'agente')\n\t inner join ced..CentUsers i on (c.userr   = i.intname)\nwhere c.start >= @dadata and c.start <= @adata",
    "kpi0000.10": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect a.codconto, a.DSCCONTO1,\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t where  t.DATADOC >= @dadata and t.DATADOC <= @adata and t.tipodoc = 'OFA' and t.CODCLIFOR = a.CODCONTO) as nrOFA,\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t where  t.DATADOC >= @dadata and t.DATADOC <= @adata and t.tipodoc = 'OFT' and t.CODCLIFOR = a.CODCONTO) as nrOFT,\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t where  t.DATADOC >= @dadata and t.DATADOC <= @adata and t.tipodoc = 'OFD' and t.CODCLIFOR = a.CODCONTO) as nrOFD,\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join ANAGRAFICAARTICOLIPROD p on r.CODART = p.CODICEART and p.ESERCIZIO = year(GetDate()) where  t.DATADOC >= @dadata and t.DATADOC <= @adata and p.FORNPREFACQ = a.CODCONTO and t.tipodoc = 'OCV') as nrOCV,\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join ANAGRAFICAARTICOLIPROD p on r.CODART = p.CODICEART and p.ESERCIZIO = year(GetDate()) where  t.DATADOC >= @dadata and t.DATADOC <= @adata and p.FORNPREFACQ = a.CODCONTO and t.tipodoc = 'OCW') as nrOCW,\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join ANAGRAFICAARTICOLIPROD p on r.CODART = p.CODICEART and p.ESERCIZIO = year(GetDate()) where  t.DATADOC >= @dadata and t.DATADOC <= @adata and p.FORNPREFACQ = a.CODCONTO and t.tipodoc = 'OCB') as nrOCB,\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join ANAGRAFICAARTICOLIPROD p on r.CODART = p.CODICEART and p.ESERCIZIO = year(GetDate()) where  t.DATADOC >= @dadata and t.DATADOC <= @adata and p.FORNPREFACQ = a.CODCONTO and t.tipodoc = 'OCE') as nrOCE,\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join ANAGRAFICAARTICOLIPROD p on r.CODART = p.CODICEART and p.ESERCIZIO = year(GetDate()) where  t.DATADOC >= @dadata and t.DATADOC <= @adata and p.FORNPREFACQ = a.CODCONTO and t.tipodoc = 'OCD') as nrOCD\nfrom colfert..ANAGRAFICACF a\nwhere a.TIPOCONTO = 'F'\nand\n(\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t where  t.DATADOC >= @dadata and t.DATADOC <= @adata and t.tipodoc in ('OFD','OFT','OFD') and t.CODCLIFOR = a.CODCONTO) != 0 or\n(select count(distinct progressivo) from colfert..TESTEDOCUMENTI t inner join RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join ANAGRAFICAARTICOLIPROD p on r.CODART = p.CODICEART and p.ESERCIZIO = year(GetDate()) where  t.DATADOC >= @dadata and t.DATADOC <= @adata and p.FORNPREFACQ = a.CODCONTO and t.tipodoc in ('OCD','OCV','OCW','OCB','OCE') ) <> 0\n)\norder by 1",
    "kpi0000.11": "declare @dadata DateTime = datefromparts(year((dateadd(year,-1,getdate()))),month((dateadd(year,-1,getdate()))),1);\ndeclare @adata  DateTime = dateadd(day,-1,(datefromparts(year(getdate()),month(getdate()),1)));\nselect CategoriaAgente,\n       isnull([1],0) as Gennaio,isnull([2],0) as Febbraio,isnull([3],0) as Marzo,isnull([4],0) as Aprile,isnull([5],0) as Maggio,isnull([6],0) as Giugno,\n\t   isnull([7],0) as Luglio,isnull([8],0) as Agosto,isnull([9],0) as Settembre,isnull([10],0) as Ottobre,isnull([11],0) as Novembre,isnull([12],0) as Dicembre\nfrom (\nselect CategoriaAgente, Mese, Clienti from(\nselect distinct x.categoria as CategoriaAgente, mese as Mese, count(distinct a.CodiceCliente) as Clienti, sum(a.totRiga) as Importo\nfrom stats..consegnato a inner join colfert..EXTRAAGENTI x on a.CodiceAgente = x.CODAGENTE\nwhere a.datadoc >= @dadata and a.datadoc <= @adata --and a.TotaleDocumento > 500\ngroup by x.categoria, mese\nhaving count(distinct a.CodiceCliente) > 1 and sum(a.totRiga) >= 500\n) as pluto\n) as pippa\nPIVOT (\nsum(Clienti)\nfor Mese in ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])\n) as Pippo\norder by 1",
    "kpi0001.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nIF OBJECT_ID('tempdb.dbo.#catart', 'U') IS NOT NULL DROP TABLE #catart;\nselect p.CODICEART as Articolo\ninto #catart\nfrom ANAGRAFICAARTICOLIPROD p\n     inner join anagraficacf a on p.fornprefacq = a.codconto\n\t inner join ANAGRAFICARISERVATICF r on a.CODCONTO = r.CODCONTO and r.ESERCIZIO = YEAR(getDate())\nwhere p.ESERCIZIO = YEAR(getDate()) and r.codsettore = 202 -- prodotto\n\nselect distinct c.NomeUtente as utente,\n       isnull(( select cast(sum(d.NettoRiga) as float) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = 'Prodotto Finito'),0) as SpeditoPeriodo,\n       isnull(( select count(distinct d.CodiceCliente) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata ),0) as NrCliPeriodo,\n       isnull(( select count(distinct d.CodiceFornitore) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = 'Prodotto Finito'),0) as NrForPeriodo,\n       (select count(*) from colfert..Testedoc t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente and t.TIPODOC in ('pre','prw') ) as NrRighePreventivo,\n       (select COUNT(*) from colfert..TESTEDOC t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente and t.TIPODOC in ('OCB','OCD','OCE','OCL','OCN','OCS','OCV','OCW')) as NrRigheOrdini ,\n       (select COUNT(*) from colfert..Testedoc t inner join colfert..EXTRATESTEDOC y on t.progressivo = y.idtesta inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('OFA','OFB','OFD','OFL','OFT') and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente ) as NrRigheOrdiniFornitore ,\n       (select count(*) from ced..centralino a left outer join ced..codeconv n on a.userr = n.codice where a.start >= @dadata and a.start <= @adata and a.intspeed in ('ext','int') and a.type in ('received','placed') and n.conversion = c.NomeUtente) as NumeroTotaleChiamate,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.userr = n.codice where a.start >= @dadata and a.start <= @adata and a.intspeed in ('ext','int') and a.type in ('received','placed') and n.conversion = c.NomeUtente) as DurataTotaleChiamate\nfrom TEMP..StatCons c\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata\norder by 1",
    "kpi0001.02": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nIF OBJECT_ID('tempdb.dbo.#catart', 'U') IS NOT NULL DROP TABLE #catart;\nselect p.CODICEART as Articolo\ninto #catart\nfrom ANAGRAFICAARTICOLIPROD p\n     inner join anagraficacf a on p.fornprefacq = a.codconto\n\t inner join ANAGRAFICARISERVATICF r on a.CODCONTO = r.CODCONTO and r.ESERCIZIO = YEAR(getDate())\nwhere p.ESERCIZIO = YEAR(getDate()) and r.codsettore = 201 -- alluminio\n\nselect distinct c.NomeUtente as utente,\n       isnull(( select cast(sum(d.NettoRiga) as float) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = 'Alluminio Ferro'),0) as SpeditoPeriodo,\n       isnull(( select count(distinct d.CodiceCliente) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata ),0) as NrCliPeriodo,\n       isnull(( select count(distinct d.CodiceFornitore) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = 'Alluminio Ferro'),0) as NrForPeriodo,\n       (select count(*) from colfert..Testedoc t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente and t.TIPODOC in ('pre','prw') ) as NrRighePreventivo,\n       (select COUNT(*) from colfert..TESTEDOC t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente and t.TIPODOC in ('OCB','OCD','OCE','OCL','OCN','OCS','OCV','OCW')) as NrRigheOrdini ,\n       (select COUNT(*) from colfert..Testedoc t inner join colfert..EXTRATESTEDOC y on t.progressivo = y.idtesta inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('OFA','OFB','OFD','OFL','OFT') and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente ) as NrRigheOrdiniFornitore ,\n       (select count(*) from ced..centralino a left outer join ced..codeconv n on a.userr = n.codice where a.start >= @dadata and a.start <= @adata and a.intspeed in ('ext','int') and a.type in ('received','placed') and n.conversion = c.NomeUtente) as NumeroTotaleChiamate,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.userr = n.codice where a.start >= @dadata and a.start <= @adata and a.intspeed in ('ext','int') and a.type in ('received','placed') and n.conversion = c.NomeUtente) as DurataTotaleChiamate\nfrom TEMP..StatCons c\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata\norder by 1",
    "kpi0001.03": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nIF OBJECT_ID('tempdb.dbo.#catart', 'U') IS NOT NULL DROP TABLE #catart;\nselect p.CODICEART as Articolo\ninto #catart\nfrom ANAGRAFICAARTICOLIPROD p\n     inner join anagraficacf a on p.fornprefacq = a.codconto\n\t inner join ANAGRAFICARISERVATICF r on a.CODCONTO = r.CODCONTO and r.ESERCIZIO = YEAR(getDate())\nwhere p.ESERCIZIO = YEAR(getDate()) and r.codsettore = 200 -- legno\n\nselect distinct c.NomeUtente as utente,\n       isnull(( select cast(sum(d.NettoRiga) as float) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = 'Legno PVC'),0) as SpeditoPeriodo,\n       isnull(( select count(distinct d.CodiceCliente) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata ),0) as NrCliPeriodo,\n       isnull(( select count(distinct d.CodiceFornitore) from temp..StatCons d where d.NomeUtente = c.NomeUtente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = 'Legno PVC'),0) as NrForPeriodo,\n       (select count(*) from colfert..Testedoc t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente and t.TIPODOC in ('pre','prw') ) as NrRighePreventivo,\n       (select COUNT(*) from colfert..TESTEDOC t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente and t.TIPODOC in ('OCB','OCD','OCE','OCL','OCN','OCS','OCV','OCW')) as NrRigheOrdini ,\n       (select COUNT(*) from colfert..Testedoc t inner join colfert..EXTRATESTEDOC y on t.progressivo = y.idtesta inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('OFA','OFB','OFD','OFL','OFT') and r.CODART in (select Articolo from #catart) and t.Utente = c.NomeUtente ) as NrRigheOrdiniFornitore ,\n       (select count(*) from ced..centralino a left outer join ced..codeconv n on a.userr = n.codice where a.start >= @dadata and a.start <= @adata and a.intspeed in ('ext','int') and a.type in ('received','placed') and n.conversion = c.NomeUtente) as NumeroTotaleChiamate,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.userr = n.codice where a.start >= @dadata and a.start <= @adata and a.intspeed in ('ext','int') and a.type in ('received','placed') and n.conversion = c.NomeUtente) as DurataTotaleChiamate\nfrom TEMP..StatCons c\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata\norder by 1",
    "kpi0001.04": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @cdc nvarchar(64) = 'Prodotto Finito';\ndeclare @cat nvarchar(64) = '';\nselect  @cat = max(codice) from CED..codeconv where conversion = @cdc;\n\ndelete from TEMP..ClientCount;\n\nwith start as(\nselect CodiceAgente,CodiceCliente, sum(NettoRiga) as imponibile\nfrom TEMP..statcons\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata and CdC = 'Prodotto Finito'\ngroup by CodiceAgente,CodiceCliente\n)\ninsert into temp..ClientCount\nselect distinct a.CodiceAgente,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente) as NRCliPer,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente and b.imponibile >= 5000 and b.imponibile < 10000) as NRCliPer5k,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente and b.imponibile >= 10000 )  as NRCliPer10k\nfrom start a\n\n\nselect distinct c.CodiceAgente, c.NomeAgente,\n       (isnull(( select cast(sum(d.NettoRiga) as float) from temp..StatCons d where d.CodiceAgente = c.CodiceAgente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = @cdc ),0)) as SpeditoPer,\n       (isnull(( select count(distinct d.CodiceFornitore) from temp..StatCons d where d.CodiceAgente = c.CodiceAgente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = @cdc ),0)) as NrForPer,\n\t   isnull((select n.NRCliPer from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as NRClitOT,\n\t   isnull((select n.NRCliPer5k from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as asNRCli5k10k,\n\t   isnull((select n.NRCliPer10k from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as NrCli10k,\n       (select count(distinct t.PROGRESSIVO) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('pre','prw') and y.CODAGENTE1 = c.CodiceAgente and (x.Categoria4 in ('AUTOM','VETRO') or q.DESCRIZIONE = @cat) ) as NrPreventivi,\n       (select COUNT(distinct cast(t.progressivo as nvarchar) + '|' + cast(r.IDRIGA as nvarchar)) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('pre','prw') and y.CODAGENTE1 = c.CodiceAgente and (x.Categoria4 in ('AUTOM','VETRO') or q.DESCRIZIONE = @cat) ) as NrRighePreventivi,\n       (select count(distinct t.PROGRESSIVO) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in (select CODICE from colfert..parametridoc where tipo = 'o' and clifor = 'c') and y.CODAGENTE1 = c.CodiceAgente and (x.Categoria4 in ('AUTOM','VETRO') or q.DESCRIZIONE = @cat) ) as NrOrdini,\n       (select COUNT(distinct cast(t.progressivo as nvarchar) + '|' + cast(r.IDRIGA as nvarchar)) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in (select CODICE from colfert..parametridoc where tipo = 'o' and clifor = 'c') and y.CODAGENTE1 = c.CodiceAgente and (x.Categoria4 in ('AUTOM','VETRO') or q.DESCRIZIONE = @cat) ) as NrRigheOrdini,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'received'             and n.conversion = c.CodiceAgente and a.userr in ('Borsato Andrea <552>','Busatto Irene <557>','De Cassan Enrico <554>','Gasparini Eleonora <549>','Socci Moreno <553>')) as NumeroChiamateRicevute,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'received'             and n.conversion = c.CodiceAgente and a.userr in ('Borsato Andrea <552>','Busatto Irene <557>','De Cassan Enrico <554>','Gasparini Eleonora <549>','Socci Moreno <553>')) as DurataChiamateRicevute,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'placed'               and n.conversion = c.CodiceAgente and a.userr in ('Borsato Andrea <552>','Busatto Irene <557>','De Cassan Enrico <554>','Gasparini Eleonora <549>','Socci Moreno <553>')) as NumeroChiamateFatte,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'placed'               and n.conversion = c.CodiceAgente and a.userr in ('Borsato Andrea <552>','Busatto Irene <557>','De Cassan Enrico <554>','Gasparini Eleonora <549>','Socci Moreno <553>')) as DurataChiamateFatte,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type in ('received','placed') and n.conversion = c.CodiceAgente and a.userr in ('Borsato Andrea <552>','Busatto Irene <557>','De Cassan Enrico <554>','Gasparini Eleonora <549>','Socci Moreno <553>')) as NumeroTotaleChiamate,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type in ('received','placed') and n.conversion = c.CodiceAgente and a.userr in ('Borsato Andrea <552>','Busatto Irene <557>','De Cassan Enrico <554>','Gasparini Eleonora <549>','Socci Moreno <553>')) as DurataTotaleChiamate\n\nfrom TEMP..StatCons c\n\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata\norder by 1",
    "kpi0001.05": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @cdc nvarchar(64) = 'Alluminio Ferro';\ndeclare @cat nvarchar(64) = '';\nselect  @cat = max(codice) from CED..codeconv where conversion = @cdc;\n\ndelete from TEMP..ClientCount;\n\nwith start as(\nselect CodiceAgente,CodiceCliente, sum(NettoRiga) as imponibile\nfrom TEMP..statcons\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata and CdC = @cdc\ngroup by CodiceAgente,CodiceCliente\n)\ninsert into temp..ClientCount\nselect distinct a.CodiceAgente,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente) as NRCliPer,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente and b.imponibile >= 5000 and b.imponibile < 10000) as NRCliPer5k,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente and b.imponibile >= 10000 )  as NRCliPer10k\nfrom start a\n\n\n-- alluminio ferro\nselect distinct c.CodiceAgente, c.NomeAgente,\n       (isnull(( select cast(sum(d.NettoRiga) as float) from temp..StatCons d where d.CodiceAgente = c.CodiceAgente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = @cdc ),0)) as SpeditoPer,\n       (isnull(( select count(distinct d.CodiceFornitore) from temp..StatCons d where d.CodiceAgente = c.CodiceAgente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = @cdc ),0)) as NrForPer,\n\t   isnull((select n.NRCliPer from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as NRClitOT,\n\t   isnull((select n.NRCliPer5k from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as asNRCli5k10k,\n\t   isnull((select n.NRCliPer10k from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as NrCli10k,\n       (select count(distinct t.PROGRESSIVO) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('pre','prw') and y.CODAGENTE1 = c.CodiceAgente and (q.DESCRIZIONE in ('ALLUM/FERRO','ALLUMINIO - FERRO')) ) as NrPreventivi,\n       (select COUNT(distinct cast(t.progressivo as nvarchar) + '|' + cast(r.IDRIGA as nvarchar)) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('pre','prw') and y.CODAGENTE1 = c.CodiceAgente and (q.DESCRIZIONE in ('ALLUM/FERRO','ALLUMINIO - FERRO')) ) as NrRighePreventivi,\n       (select count(distinct t.PROGRESSIVO) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in (select CODICE from colfert..parametridoc where tipo = 'o' and clifor = 'c') and y.CODAGENTE1 = c.CodiceAgente and (q.DESCRIZIONE in ('ALLUM/FERRO','ALLUMINIO - FERRO')) ) as NrOrdini,\n       (select COUNT(distinct cast(t.progressivo as nvarchar) + '|' + cast(r.IDRIGA as nvarchar)) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in (select CODICE from colfert..parametridoc where tipo = 'o' and clifor = 'c') and y.CODAGENTE1 = c.CodiceAgente and (q.DESCRIZIONE in ('ALLUM/FERRO','ALLUMINIO - FERRO')) ) as NrRigheOrdini,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'received'             and n.conversion = c.CodiceAgente and a.userr in ('Berna Alberto <521>','Zara Luca <525>')) as NumeroChiamateRicevute,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'received'             and n.conversion = c.CodiceAgente and a.userr in ('Berna Alberto <521>','Zara Luca <525>')) as DurataChiamateRicevute,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'placed'               and n.conversion = c.CodiceAgente and a.userr in ('Berna Alberto <521>','Zara Luca <525>')) as NumeroChiamateFatte,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'placed'               and n.conversion = c.CodiceAgente and a.userr in ('Berna Alberto <521>','Zara Luca <525>')) as DurataChiamateFatte,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type in ('received','placed') and n.conversion = c.CodiceAgente and a.userr in ('Berna Alberto <521>','Zara Luca <525>')) as NumeroTotaleChiamate,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type in ('received','placed') and n.conversion = c.CodiceAgente and a.userr in ('Berna Alberto <521>','Zara Luca <525>')) as DurataTotaleChiamate\nfrom TEMP..StatCons c\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata\norder by 1",
    "kpi0001.06": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\ndeclare @cdc nvarchar(64) = 'Legno PVC';\ndeclare @cat nvarchar(64) = '';\nselect  @cat = max(codice) from CED..codeconv where conversion = @cdc;\n\ndelete from TEMP..ClientCount;\n\nwith start as(\nselect CodiceAgente,CodiceCliente, sum(NettoRiga) as imponibile\nfrom TEMP..statcons\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata and CdC = @cdc\ngroup by CodiceAgente,CodiceCliente\n)\ninsert into temp..ClientCount\nselect distinct a.CodiceAgente,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente) as NRCliPer,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente and b.imponibile >= 5000 and b.imponibile < 10000) as NRCliPer5k,\n(select COUNT(distinct b.CodiceCliente) from start b where a.CodiceAgente = b.CodiceAgente and b.imponibile >= 10000 )  as NRCliPer10k\nfrom start a\n\n-- legno pvc\nselect distinct c.CodiceAgente, c.NomeAgente,\n       (isnull(( select cast(sum(d.NettoRiga) as float) from temp..StatCons d where d.CodiceAgente = c.CodiceAgente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = @cdc ),0)) as SpeditoPer,\n       (isnull(( select count(distinct d.CodiceFornitore) from temp..StatCons d where d.CodiceAgente = c.CodiceAgente and d.InizioTrasporto >= @dadata and d.InizioTrasporto <= @adata and d.CdC = @cdc ),0)) as NrForPer,\n\t   isnull((select n.NRCliPer from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as NRClitOT,\n\t   isnull((select n.NRCliPer5k from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as asNRCli5k10k,\n\t   isnull((select n.NRCliPer10k from TEMP..ClientCount n where n.CodiceAgente = c.CodiceAgente),0) as NrCli10k,\n       (select count(distinct t.PROGRESSIVO) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('pre','prw') and y.CODAGENTE1 = c.CodiceAgente and (q.DESCRIZIONE = @cat) ) as NrPreventivi,\n       (select COUNT(distinct cast(t.progressivo as nvarchar) + '|' + cast(r.IDRIGA as nvarchar)) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in ('pre','prw') and y.CODAGENTE1 = c.CodiceAgente and (q.DESCRIZIONE = @cat) ) as NrRighePreventivi,\n       (select count(distinct t.PROGRESSIVO) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in (select CODICE from colfert..parametridoc where tipo = 'o' and clifor = 'c') and y.CODAGENTE1 = c.CodiceAgente and (q.DESCRIZIONE = @cat) ) as NrOrdini,\n       (select COUNT(distinct cast(t.progressivo as nvarchar) + '|' + cast(r.IDRIGA as nvarchar)) from colfert..TESTEDOCUMENTI t inner join COLFERT..RIGHEDOCUMENTI r on t.PROGRESSIVO = r.IDTESTA inner join COLFERT..ANAGRAFICAARTICOLIPROD s on (r.CODART = s.CODICEART and s.ESERCIZIO = YEAR(Getdate()) ) inner join COLFERT..EXTRAMAG x on r.CODART = x.CODART inner join COLFERT..ANAGRAFICARISERVATICF y on (t.CODCLIFOR = y.CODCONTO and y.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..ANAGRAFICARISERVATICF f on (s.FORNPREFACQ = f.CODCONTO and f.ESERCIZIO  = YEAR(Getdate()) ) inner join COLFERT..TABSETTORI q on f.CODSETTORE = q.CODICE where t.DATADOC >= @dadata and t.DATADOC <= @adata and r.TIPORIGA = 'n' and t.TIPODOC in (select CODICE from colfert..parametridoc where tipo = 'o' and clifor = 'c') and y.CODAGENTE1 = c.CodiceAgente and (q.DESCRIZIONE = @cat) ) as NrRigheOrdini,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'received'             and n.conversion = c.CodiceAgente and a.userr in ('Zanatta Giovanni <537>','Cescon Jessica <542>','Morello Massimo <535>','Zugno Daniele <539>')) as NumeroChiamateRicevute,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'received'             and n.conversion = c.CodiceAgente and a.userr in ('Zanatta Giovanni <537>','Cescon Jessica <542>','Morello Massimo <535>','Zugno Daniele <539>')) as DurataChiamateRicevute,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'placed'               and n.conversion = c.CodiceAgente and a.userr in ('Zanatta Giovanni <537>','Cescon Jessica <542>','Morello Massimo <535>','Zugno Daniele <539>')) as NumeroChiamateFatte,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type = 'placed'               and n.conversion = c.CodiceAgente and a.userr in ('Zanatta Giovanni <537>','Cescon Jessica <542>','Morello Massimo <535>','Zugno Daniele <539>')) as DurataChiamateFatte,\n       (select count(*)                                               from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type in ('received','placed') and n.conversion = c.CodiceAgente and a.userr in ('Zanatta Giovanni <537>','Cescon Jessica <542>','Morello Massimo <535>','Zugno Daniele <539>')) as NumeroTotaleChiamate,\n       (select colfert.dbo.piSecondsToTime(isnull(sum(a.duration),0)) from ced..centralino a left outer join ced..codeconv n on a.intname = n.codice where a.start >= @dadata and a.start <= @adata and a.type in ('received','placed') and n.conversion = c.CodiceAgente and a.userr in ('Zanatta Giovanni <537>','Cescon Jessica <542>','Morello Massimo <535>','Zugno Daniele <539>')) as DurataTotaleChiamate\nfrom TEMP..StatCons c\nwhere InizioTrasporto >= @dadata and InizioTrasporto <= @adata\norder by 1",
    "kpi0002.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith tot as (\nselect u.Descrizione as Operatore, t.tipodoc, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe, cast(sum(r.TOTNETTORIGAEURO) as float) as Imponibile,\n(select COUNT(*) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as RigheChiuse,\n(select isnull(cast(sum(x.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as ImpRigheChiuse\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('ocb','ocd','ocw') and datadoc >= @dadata and datadoc <= @adata --and tipo = 'M'\ngroup by u.Descrizione, t.tipodoc, w.ND_UTECREAZ\nunion\nselect u.Descrizione as Operatore, 'PENNA', count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe, cast(sum(r.TOTNETTORIGAEURO) as float) as Imponibile,\n(select COUNT(*) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as RigheChiuse,\n(select isnull(cast(sum(x.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as ImpRigheChiuse\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('pcb','pca','scb','dcb') and datadoc >= @dadata and datadoc <= @adata and isnull(r.IDTESTARP,0) != 0\ngroup by u.Descrizione, t.tipodoc, w.ND_UTECREAZ\n) select Operatore, TIPODOC, sum(NumeroTeste) as NumeroTeste, sum(NumeroRighe) as NumeroRighe, sum(Imponibile) as Imponibile, sum(RigheChiuse) as RigheChiuse, Round(cast(sum(RigheChiuse*100) as float)/cast(sum(NumeroRighe) as float),2) as PercentualeDiRitorno\n, sum(ImpRigheChiuse) as ImpRigheChiuse\n, round(sum(ImpRigheChiuse) / sum(Imponibile) * 100,2) as PercRitornoImporto\nfrom tot\nwhere Operatore in ('Giancarlo Lubiato','Claudio Bassanello','Fabio Feltrin','Nicola Moretto','Valentino Vedelago','Cristiano Bet','Claudio Borghese','Luca Zara')\nGroup by Operatore, TIPODOC\norder by 1,2",
    "kpi0002.02": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith tot as (\nselect u.Descrizione as Operatore, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe, cast(sum(r.TOTNETTORIGAEURO) as float) as Imponibile,\n(select COUNT(*) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as RigheChiuse,\n(select isnull(cast(sum(x.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as ImpRigheChiuse\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('pre','prw') and datadoc >= @dadata and datadoc <= @adata --and tipo = 'M'\ngroup by u.Descrizione, w.ND_UTECREAZ\n) select Operatore, sum(NumeroTeste) as NumeroTeste, sum(NumeroRighe) as NumeroRighe, sum(Imponibile) as Imponibile, sum(RigheChiuse) as RigheChiuse, Round(cast(sum(RigheChiuse*100) as float)/cast(sum(NumeroRighe) as float),2) as PercentualeDiRitorno\n, sum(ImpRigheChiuse) as ImpRigheChiuse\n, round(sum(ImpRigheChiuse) / sum(Imponibile) * 100,2) as PercRitornoImporto\nfrom tot\nwhere Operatore in ('Giancarlo Lubiato','Claudio Bassanello','Fabio Feltrin','Nicola Moretto','Valentino Vedelago','Cristiano Bet','Claudio Borghese','Luca Zara')\nGroup by Operatore\norder by 1,2",
    "kpi0002.03": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect distinct c.userr,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'received') as NumeroChiamateRicevuteEsterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'received') as DurataChiamateRicevuteEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'placed'  ) as NumeroChiamateFatteEsterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'ext' and a.type = 'placed'  ) as DurataChiamateFatteEsterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'int' and a.type = 'received') as NumeroChiamateRicevuteInterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'int' and a.type = 'received') as DurataChiamateRicevuteInterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'int' and a.type = 'placed'  ) as NumeroChiamateFatteInterne,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed = 'int' and a.type = 'placed'  ) as DurataChiamateFatteInterne,\n(select count(*)                  from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed in ('ext','int') and a.type in ('received','placed') ) as NumeroTotaleChiamate,\n(select isnull(sum(a.duration),0) from ced..centralino a where a.start >= @dadata and a.start <= @adata and a.userr = c.userr and a.intspeed in ('ext','int') and a.type in ('received','placed') ) as DurataTotaleChiamate\nfrom ced..Centralino c\nwhere c.start >= @dadata and c.start <= @adata --and DATEPART(HOUR, start) = 8\nand userr in ('Lubiato Giancarlo <585>','Bassanello Claudio <583>','Feltrin Fabio <584>','Moretto Nicola <586>','Vedelago Valentino <523>','Bet Cristiano <582>')\norder by 1",
    "kpi0003.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nwith tot as (\nselect u.Descrizione as Operatore, t.tipodoc, count(distinct t.numerodoc) as NumeroTeste, count (*) as NumeroRighe, cast(sum(r.TOTNETTORIGAEURO) as float) as Imponibile,year(t.datadoc) as Anno, month(t.datadoc) as Mese\n--(select COUNT(*) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as RigheChiuse,\n--(select isnull(cast(sum(x.TOTNETTORIGAEURO) as float),0) from colfert..TESTEDOCUMENTI z left outer join RIGHEDOCUMENTI x on z.PROGRESSIVO = x.IDTESTA left outer join colfert..EXTRATESTEDOC y on x.IDTESTA =  y.IDTESTA where y.ND_UTECREAZ = w.ND_UTECREAZ and z.tipodoc in ('pre','prw') and z.datadoc >= @dadata and z.datadoc <= @adata and x.tiporiga = 'n' and x.RIGACHIUSA = 1) as ImpRigheChiuse\nfrom colfert..TESTEDOCUMENTI t left outer join colfert..EXTRATESTEDOC w on t.progressivo =  w.IDTESTA\nleft outer join colfert..NDTabTecnici u on w.ND_UTECREAZ = u.CodUtente\ninner join colfert..RIGHEDOCUMENTI r on (t.progressivo = r.idtesta and r.tiporiga = 'n')\nwhere t.tipodoc in ('ocv','ocw','ocd','oce','pre','prw','ofa','ofd','oft','acr') and datadoc >= @dadata and datadoc <= @adata --and tipo = 'M'\ngroup by u.Descrizione, t.tipodoc, w.ND_UTECREAZ, t.DataDoc\n) select Operatore, TIPODOC, Anno, Mese, sum(NumeroTeste) as NumeroTeste, sum(NumeroRighe) as NumeroRighe, sum(Imponibile) as Imponibile\n--, sum(RigheChiuse) as RigheChiuse\n--, Round(cast(sum(RigheChiuse*100) as float)/cast(sum(NumeroRighe) as float),2) as PercentualeDiRitorno\n--, sum(ImpRigheChiuse) as ImpRigheChiuse\n--, round(sum(ImpRigheChiuse) / sum(Imponibile) * 100,2) as PercRitornoImporto\nfrom tot\nwhere Operatore in ('Andrea Borsato','Eleonora Gasparini','Enrico De Cassan','Irene Busatto','Moreno Socci')\nGroup by Operatore, TIPODOC, Anno, Mese\norder by 1,2,3,4",
    "kpi0004.01": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect 'Inizio periodo' as 'Tipo' , (select CONVERT(nvarchar, @dadata, 103)) as Valore\nunion\nselect 'Fine periodo', (select CONVERT(nvarchar, @adata, 103))\nunion\nselect 'Clienti non abbonati nel periodo', cast(count(*) as nvarchar) from NDTabGiorniConsegna where codcli in (select codclifor from TesteDocumenti where datadoc >= @dadata and datadoc <= @adata and tipodoc in('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rca','fce','fcd','dcm') ) and abbonamento = 0\nunion\nselect 'Clienti abbonati nel periodo', cast(count(*) as nvarchar) from NDTabGiorniConsegna where codcli in (select codclifor from TesteDocumenti where datadoc >= @dadata and datadoc <= @adata and tipodoc in('dcb', 'scb', 'fca', 'srb', 'rcb','dcv','dcd','rca','fce','fcd','dcm') ) and abbonamento = 1\nunion\nselect 'Nr trasporti Logisticando nel periodo', cast( (select count(distinct codicecliente + cast(DataDoc as nvarchar))  from stats..consegnato where DataDoc >= @dadata and DataDoc <= @adata and (vettore like '%fahr%' or vettore like '%logisticando%')) as nvarchar)\nunion\nselect 'Nr trasporti Bartolini nel periodo', cast( (select count(distinct codicecliente + cast(DataDoc as nvarchar)) from stats..consegnato where DataDoc >= @dadata and DataDoc <= @adata and (vettore like '%brt%')) as nvarchar)\nunion\nselect 'Nr trasporti BT Solutions nel periodo', cast( (select count(distinct codicecliente + cast(DataDoc as nvarchar)) from stats..consegnato where DataDoc >= @dadata and DataDoc <= @adata and (vettore like '%bt sol%')) as nvarchar)\nunion\nselect 'Nr trasporti altri vettori nel periodo', cast( (select count(distinct codicecliente + cast(DataDoc as nvarchar)) from stats..consegnato where DataDoc >= @dadata and DataDoc <= @adata and (vettore != '' and vettore not like '%bt sol%' and vettore not like '%fahren%' and vettore not like '%brt%' ) ) as nvarchar)\nunion\nselect 'Venduto nel periodo' , format( cast ( (select sum(totriga) from stats..consegnato where DataDoc >= @dadata and DataDoc <= @adata) as decimal(18,2)) ,'#,0.00')\nunion\nselect 'Ordinato nel periodo', format( cast ( (select cast(sum(TOTIMPONIBILEEURO) as float) from TESTEDOCUMENTI where DATADOC >= @dadata and DATADOC <= @adata and TIPODOC like 'oc%' and BLOCCATO = 0) as decimal(18,2))  ,'#,0.00')\nunion\nselect 'Numero di bolle nel periodo', cast( cast ( (select count(distinct progressivo) from stats..consegnato where DataDoc >= @dadata and DataDoc <= @adata) as decimal(18,2) ) as nvarchar)\nunion\nselect 'Numero di ordini nel periodo', cast ( (select count(distinct progressivo) from TESTEDOCUMENTI where DATADOC >= @dadata and DATADOC <= @adata and TIPODOC like 'oc%' and BLOCCATO = 0) as nvarchar)\nunion\nselect 'Spese di trasporto in testa documento' , cast ( (select cast(sum(TOTSPESETRASPEURO * SEGNO) as float) from COLFERT..TESTEDOCUMENTI where (tipodoc like 'fc%' or tipodoc like 'nc%') and DATADOC >= @dadata and DATADOC <= @adata) as nvarchar)\nunion\nselect 'Spese di trasporto in riga documento' , cast ( (select cast(sum(r.TOTNETTORIGAEURO) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.progressivo = r.idtesta where (t.tipodoc like 'fc%' or t.tipodoc like 'nc%') and t.DATADOC >= @dadata and t.DATADOC <= @adata and r.CODART in ('0015', 'ZZZTRASP','434T') and r.GENCONTROP in ('G601070')) as nvarchar)\nunion\nselect 'Spese di imballo in testa documento', cast ( (select cast(sum(TOTSPESEIMBALLOEURO * SEGNO) as float) from COLFERT..TESTEDOCUMENTI where (tipodoc like 'fc%' or tipodoc like 'nc%') and DATADOC >= @dadata and DATADOC <= @adata) as nvarchar)\nunion\nselect 'Spese di imballo in riga documento', cast ( (select cast(sum(r.TOTNETTORIGAEURO) as float) from colfert..TESTEDOCUMENTI t inner join colfert..RIGHEDOCUMENTI r on t.progressivo = r.idtesta where (t.tipodoc like 'fc%' or t.tipodoc like 'nc%') and t.DATADOC >= @dadata and t.DATADOC <= @adata and r.CODART in ('0011','0012','0013','0014') and r.GENCONTROP in ('G601080')) as nvarchar)",
    "kpi0004.02": "declare @dadata DateTime = '<fromdate>';\ndeclare @adata  DateTime = '<todate>';\nselect Utente, Agente, isnull([N],0) as SenzaEvTot, isnull([S],0) as ConEvTot, isnull([N],0) + isnull([S],0) as Totale\nfrom (\nselect isnull(u.Descrizione,'') as Utente, isnull(t.CODAGENTE1 + ' - ' + g.DSCAGENTE,'') as Agente, upper(x.ND_EVASIONETOTALE) as EvTotale, count(*) as Conto\nfrom colfert..TESTEDOCUMENTI t\n  inner join colfert..EXTRATESTEDOC x on t.progressivo = x.IDTESTA\n  left outer join colfert..NDTabTecnici u on x.ND_UTECREAZ = u.CodUtente\n  left outer join colfert..ANAGRAFICAAGENTI g on t.CODAGENTE1 = g.CODAGENTE\nwhere t.tipodoc like 'oc%' and t.datadoc >= @dadata and t.datadoc <= @adata\ngroup by t.CODAGENTE1 + ' - ' + g.DSCAGENTE, u.Descrizione, x.ND_EVASIONETOTALE\n) as layer1\nPIVOT (\nsum(Conto)\nfor Evtotale in ([S],[N])\n) as layer2\norder by 1,2"
}